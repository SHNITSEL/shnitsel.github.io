{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "76d6872f",
   "metadata": {},
   "outputs": [],
   "source": [
    "import shnitsel as st\n",
    "# import shnitsel.xarray"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e823d655",
   "metadata": {},
   "outputs": [],
   "source": [
    "from shnitsel.data.tree import ShnitselDB\n",
    "\n",
    "dt = st.io.read('tut_data/traj_I02.nc', kind='shnitsel')\n",
    "assert isinstance(dt, ShnitselDB)\n",
    "ds = dt['I02'].as_stacked"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "71a465c9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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",
      "text/plain": [
       "<rdkit.Chem.rdchem.Mol at 0x74b433ce95d0>"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mol = st.bridges.to_mol(ds.atXYZ.isel(frame=0), charge=1)\n",
    "mol"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "7c22fa49",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:rdkit=\"http://www.rdkit.org/xml\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" baseProfile=\"full\" xml:space=\"preserve\" width=\"300px\" height=\"300px\" viewBox=\"0 0 300 300\">\n",
       "<!-- END OF HEADER -->\n",
       "<path class=\"bond-4 atom-3 atom-5\" d=\"M 97.9,122.5 L 142.8,126.4 L 136.8,135.0 L 97.1,131.6 Z\" style=\"fill:#7E5273;fill-rule:evenodd;fill-opacity:1;stroke:#7E5273;stroke-width:0.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;\"/>\n",
       "<path class=\"bond-6 atom-5 atom-7\" d=\"M 142.8,126.4 L 160.8,164.9 L 154.8,173.5 L 136.8,135.0 Z\" style=\"fill:#7E5273;fill-rule:evenodd;fill-opacity:1;stroke:#7E5273;stroke-width:0.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;\"/>\n",
       "<path class=\"bond-8 atom-7 atom-9\" d=\"M 160.8,164.9 L 200.5,168.3 L 199.7,177.4 L 154.8,173.5 Z\" style=\"fill:#7E5273;fill-rule:evenodd;fill-opacity:1;stroke:#7E5273;stroke-width:0.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;\"/>\n",
       "<ellipse cx=\"97.5\" cy=\"127.0\" rx=\"8.5\" ry=\"8.5\" class=\"atom-3\" style=\"fill:#7E5273;fill-rule:evenodd;stroke:#7E5273;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<ellipse cx=\"139.8\" cy=\"130.7\" rx=\"8.5\" ry=\"8.5\" class=\"atom-5\" style=\"fill:#7E5273;fill-rule:evenodd;stroke:#7E5273;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<ellipse cx=\"157.8\" cy=\"169.2\" rx=\"8.5\" ry=\"8.5\" class=\"atom-7\" style=\"fill:#7E5273;fill-rule:evenodd;stroke:#7E5273;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<ellipse cx=\"200.1\" cy=\"172.9\" rx=\"8.5\" ry=\"8.5\" class=\"atom-9\" style=\"fill:#7E5273;fill-rule:evenodd;stroke:#7E5273;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-0 atom-0 atom-1\" d=\"M 73.2,161.8 L 37.0,158.7\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-1 atom-0 atom-2\" d=\"M 73.2,161.8 L 87.7,192.9\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-2 atom-0 atom-3\" d=\"M 73.2,161.8 L 97.5,127.0\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-2 atom-0 atom-3\" d=\"M 70.1,155.2 L 90.2,126.4\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-3 atom-3 atom-4\" d=\"M 97.5,127.0 L 83.0,96.0\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-4 atom-3 atom-5\" d=\"M 97.5,127.0 L 139.8,130.7\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-5 atom-5 atom-6\" d=\"M 139.8,130.7 L 159.0,103.3\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-6 atom-5 atom-7\" d=\"M 139.8,130.7 L 157.8,169.2\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-6 atom-5 atom-7\" d=\"M 135.6,136.7 L 150.5,168.5\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-7 atom-7 atom-8\" d=\"M 157.8,169.2 L 138.6,196.6\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-8 atom-7 atom-9\" d=\"M 157.8,169.2 L 200.1,172.9\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-9 atom-9 atom-10\" d=\"M 200.1,172.9 L 214.6,203.9\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-10 atom-9 atom-11\" d=\"M 200.1,172.9 L 209.6,159.2\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-10 atom-9 atom-11\" d=\"M 209.6,159.2 L 219.2,145.5\" style=\"fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-10 atom-9 atom-11\" d=\"M 197.0,166.2 L 205.5,154.0\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-10 atom-9 atom-11\" d=\"M 205.5,154.0 L 214.0,141.8\" style=\"fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-11 atom-11 atom-12\" d=\"M 231.4,138.7 L 246.0,139.9\" style=\"fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-11 atom-11 atom-12\" d=\"M 246.0,139.9 L 260.6,141.2\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-12 atom-11 atom-13\" d=\"M 220.9,130.7 L 215.4,118.8\" style=\"fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-12 atom-11 atom-13\" d=\"M 215.4,118.8 L 209.9,107.0\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"atom-1\" d=\"M 26.2 152.1 L 27.8 152.1 L 27.8 157.3 L 34.0 157.3 L 34.0 152.1 L 35.6 152.1 L 35.6 164.2 L 34.0 164.2 L 34.0 158.6 L 27.8 158.6 L 27.8 164.2 L 26.2 164.2 L 26.2 152.1 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-2\" d=\"M 86.5 194.3 L 88.1 194.3 L 88.1 199.4 L 94.2 199.4 L 94.2 194.3 L 95.9 194.3 L 95.9 206.3 L 94.2 206.3 L 94.2 200.8 L 88.1 200.8 L 88.1 206.3 L 86.5 206.3 L 86.5 194.3 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-4\" d=\"M 74.9 82.6 L 76.5 82.6 L 76.5 87.7 L 82.6 87.7 L 82.6 82.6 L 84.3 82.6 L 84.3 94.6 L 82.6 94.6 L 82.6 89.0 L 76.5 89.0 L 76.5 94.6 L 74.9 94.6 L 74.9 82.6 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-6\" d=\"M 159.4 89.9 L 161.1 89.9 L 161.1 95.0 L 167.2 95.0 L 167.2 89.9 L 168.9 89.9 L 168.9 101.9 L 167.2 101.9 L 167.2 96.4 L 161.1 96.4 L 161.1 101.9 L 159.4 101.9 L 159.4 89.9 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-8\" d=\"M 128.8 198.0 L 130.4 198.0 L 130.4 203.1 L 136.5 203.1 L 136.5 198.0 L 138.2 198.0 L 138.2 210.0 L 136.5 210.0 L 136.5 204.4 L 130.4 204.4 L 130.4 210.0 L 128.8 210.0 L 128.8 198.0 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-10\" d=\"M 213.3 205.3 L 215.0 205.3 L 215.0 210.4 L 221.1 210.4 L 221.1 205.3 L 222.7 205.3 L 222.7 217.3 L 221.1 217.3 L 221.1 211.8 L 215.0 211.8 L 215.0 217.3 L 213.3 217.3 L 213.3 205.3 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-11\" d=\"M 221.7 132.1 L 225.7 138.4 Q 226.1 139.1, 226.7 140.2 Q 227.3 141.3, 227.4 141.4 L 227.4 132.1 L 229.0 132.1 L 229.0 144.1 L 227.3 144.1 L 223.1 137.1 Q 222.6 136.3, 222.1 135.4 Q 221.6 134.4, 221.4 134.1 L 221.4 144.1 L 219.8 144.1 L 219.8 132.1 L 221.7 132.1 \" fill=\"#0000FF\"/>\n",
       "<path class=\"atom-11\" d=\"M 231.2 134.2 L 233.3 134.2 L 233.3 132.0 L 234.3 132.0 L 234.3 134.2 L 236.5 134.2 L 236.5 135.0 L 234.3 135.0 L 234.3 137.3 L 233.3 137.3 L 233.3 135.0 L 231.2 135.0 L 231.2 134.2 \" fill=\"#0000FF\"/>\n",
       "<path class=\"atom-12\" d=\"M 262.0 135.7 L 263.6 135.7 L 263.6 140.8 L 269.8 140.8 L 269.8 135.7 L 271.4 135.7 L 271.4 147.8 L 269.8 147.8 L 269.8 142.2 L 263.6 142.2 L 263.6 147.8 L 262.0 147.8 L 262.0 135.7 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-13\" d=\"M 201.7 93.6 L 203.4 93.6 L 203.4 98.7 L 209.5 98.7 L 209.5 93.6 L 211.1 93.6 L 211.1 105.6 L 209.5 105.6 L 209.5 100.1 L 203.4 100.1 L 203.4 105.6 L 201.7 105.6 L 201.7 93.6 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 69.1 170.7 Q 68.0 170.7, 67.5 169.9 Q 66.9 169.1, 66.9 167.7 Q 66.9 166.2, 67.5 165.4 Q 68.0 164.6, 69.1 164.6 Q 70.3 164.6, 70.8 165.4 Q 71.3 166.2, 71.3 167.7 Q 71.3 169.1, 70.8 169.9 Q 70.2 170.7, 69.1 170.7 M 69.1 170.1 Q 69.8 170.1, 70.1 169.5 Q 70.5 168.8, 70.5 167.7 Q 70.5 166.5, 70.1 165.9 Q 69.8 165.3, 69.1 165.3 Q 68.5 165.3, 68.1 165.9 Q 67.8 166.5, 67.8 167.7 Q 67.8 168.8, 68.1 169.5 Q 68.5 170.1, 69.1 170.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 15.3 159.3 L 16.6 159.3 L 16.6 154.8 L 15.2 155.2 L 15.0 154.7 L 16.8 153.9 L 17.4 154.0 L 17.4 159.3 L 18.6 159.3 L 18.6 160.0 L 15.3 160.0 L 15.3 159.3 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 95.1 211.3 Q 95.4 210.7, 95.9 210.4 Q 96.4 210.1, 97.1 210.1 Q 98.1 210.1, 98.6 210.6 Q 99.1 211.1, 99.1 211.9 Q 99.1 212.8, 98.4 213.7 Q 97.8 214.5, 96.4 215.5 L 99.2 215.5 L 99.2 216.2 L 95.1 216.2 L 95.1 215.6 Q 96.2 214.8, 96.9 214.2 Q 97.6 213.6, 97.9 213.1 Q 98.2 212.5, 98.2 212.0 Q 98.2 211.4, 97.9 211.1 Q 97.6 210.8, 97.1 210.8 Q 96.7 210.8, 96.3 210.9 Q 96.0 211.1, 95.8 211.6 L 95.1 211.3 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 102.5 121.1 Q 103.0 121.3, 103.3 121.7 Q 103.6 122.0, 103.6 122.6 Q 103.6 123.1, 103.4 123.5 Q 103.1 123.9, 102.6 124.2 Q 102.2 124.4, 101.6 124.4 Q 100.9 124.4, 100.4 124.1 Q 99.9 123.9, 99.6 123.5 L 100.0 123.0 Q 100.4 123.4, 100.7 123.5 Q 101.0 123.7, 101.6 123.7 Q 102.1 123.7, 102.4 123.4 Q 102.8 123.1, 102.8 122.6 Q 102.8 122.0, 102.4 121.7 Q 102.1 121.5, 101.3 121.5 L 100.9 121.5 L 100.9 120.9 L 101.3 120.9 Q 101.9 120.8, 102.3 120.6 Q 102.6 120.3, 102.6 119.7 Q 102.6 119.4, 102.3 119.1 Q 102.1 118.9, 101.6 118.9 Q 101.1 118.9, 100.7 119.1 Q 100.4 119.2, 100.2 119.7 L 99.6 119.4 Q 99.8 118.9, 100.3 118.5 Q 100.8 118.2, 101.6 118.2 Q 102.4 118.2, 103.0 118.6 Q 103.5 119.0, 103.5 119.7 Q 103.5 120.2, 103.2 120.6 Q 103.0 120.9, 102.5 121.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 75.2 76.7 L 75.9 76.7 L 75.9 77.4 L 75.2 77.4 L 75.2 78.8 L 74.4 78.8 L 74.4 77.4 L 71.3 77.4 L 71.3 76.8 L 73.9 72.8 L 75.2 72.8 L 75.2 76.7 M 72.3 76.7 L 74.4 76.7 L 74.4 73.3 L 72.3 76.7 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 137.0 123.6 Q 137.5 123.6, 137.9 123.8 Q 138.4 124.0, 138.6 124.4 Q 138.9 124.8, 138.9 125.4 Q 138.9 126.0, 138.6 126.5 Q 138.3 126.9, 137.8 127.2 Q 137.3 127.4, 136.7 127.4 Q 136.2 127.4, 135.7 127.2 Q 135.1 127.0, 134.8 126.6 L 135.3 126.1 Q 135.6 126.4, 136.0 126.5 Q 136.3 126.7, 136.7 126.7 Q 137.3 126.7, 137.6 126.4 Q 138.0 126.0, 138.0 125.4 Q 138.0 124.8, 137.6 124.5 Q 137.3 124.2, 136.7 124.2 Q 136.2 124.2, 135.6 124.4 L 135.1 124.2 L 135.4 121.3 L 138.5 121.3 L 138.4 122.0 L 136.1 122.0 L 135.9 123.8 Q 136.4 123.6, 137.0 123.6 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 172.5 83.6 Q 173.1 83.6, 173.5 83.9 Q 173.9 84.1, 174.1 84.5 Q 174.3 84.9, 174.3 85.4 Q 174.3 86.0, 174.1 86.5 Q 173.8 86.9, 173.4 87.2 Q 172.9 87.4, 172.3 87.4 Q 171.3 87.4, 170.7 86.7 Q 170.2 86.0, 170.2 84.5 Q 170.2 83.0, 170.8 82.1 Q 171.5 81.3, 172.8 81.3 Q 173.2 81.3, 173.5 81.4 Q 173.8 81.5, 174.1 81.6 L 173.8 82.2 Q 173.3 82.0, 172.8 82.0 Q 171.9 82.0, 171.5 82.5 Q 171.1 83.1, 171.0 84.2 Q 171.3 83.9, 171.7 83.8 Q 172.1 83.6, 172.5 83.6 M 172.3 86.7 Q 172.7 86.7, 172.9 86.6 Q 173.2 86.4, 173.3 86.1 Q 173.5 85.8, 173.5 85.4 Q 173.5 84.9, 173.2 84.6 Q 172.9 84.3, 172.4 84.3 Q 172.0 84.3, 171.6 84.5 Q 171.3 84.6, 171.0 84.9 Q 171.1 85.8, 171.4 86.3 Q 171.7 86.7, 172.3 86.7 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 163.0 161.1 L 159.8 161.1 L 159.8 160.4 L 163.8 160.4 L 163.8 161.0 L 161.4 166.4 L 160.6 166.4 L 163.0 161.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 126.3 215.4 Q 126.8 215.7, 127.2 216.0 Q 127.5 216.4, 127.5 217.0 Q 127.5 217.5, 127.2 217.9 Q 126.9 218.3, 126.5 218.5 Q 126.0 218.7, 125.4 218.7 Q 124.4 218.7, 123.8 218.2 Q 123.2 217.8, 123.2 217.0 Q 123.2 216.5, 123.5 216.1 Q 123.7 215.7, 124.3 215.4 Q 123.9 215.2, 123.7 214.9 Q 123.4 214.6, 123.4 214.1 Q 123.4 213.4, 124.0 212.9 Q 124.5 212.5, 125.3 212.5 Q 126.2 212.5, 126.7 212.9 Q 127.2 213.4, 127.2 214.1 Q 127.2 214.5, 127.0 214.8 Q 126.8 215.2, 126.3 215.4 M 125.3 213.2 Q 124.8 213.2, 124.6 213.4 Q 124.3 213.6, 124.3 214.1 Q 124.3 214.4, 124.5 214.6 Q 124.7 214.8, 124.9 214.9 Q 125.2 215.0, 125.7 215.2 Q 126.1 215.0, 126.2 214.7 Q 126.4 214.4, 126.4 214.1 Q 126.4 213.6, 126.1 213.4 Q 125.8 213.2, 125.3 213.2 M 125.4 218.1 Q 125.9 218.1, 126.3 217.8 Q 126.6 217.4, 126.6 216.9 Q 126.6 216.6, 126.4 216.4 Q 126.3 216.2, 126.0 216.1 Q 125.7 216.0, 125.3 215.8 L 124.9 215.7 Q 124.4 216.0, 124.3 216.3 Q 124.1 216.6, 124.1 216.9 Q 124.1 217.4, 124.4 217.8 Q 124.8 218.1, 125.4 218.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 196.0 175.6 Q 197.0 175.6, 197.6 176.3 Q 198.1 177.1, 198.1 178.5 Q 198.1 180.1, 197.4 180.9 Q 196.8 181.8, 195.5 181.8 Q 195.1 181.8, 194.8 181.7 Q 194.5 181.6, 194.2 181.4 L 194.5 180.8 Q 194.9 181.1, 195.5 181.1 Q 196.3 181.1, 196.8 180.5 Q 197.2 180.0, 197.2 178.9 Q 196.9 179.1, 196.6 179.3 Q 196.2 179.4, 195.8 179.4 Q 195.2 179.4, 194.8 179.2 Q 194.4 179.0, 194.2 178.6 Q 193.9 178.1, 193.9 177.6 Q 193.9 177.0, 194.2 176.6 Q 194.5 176.1, 194.9 175.9 Q 195.4 175.6, 196.0 175.6 M 194.8 177.6 Q 194.8 178.1, 195.1 178.5 Q 195.4 178.8, 195.9 178.8 Q 196.3 178.8, 196.6 178.6 Q 197.0 178.5, 197.2 178.2 Q 197.2 177.2, 196.9 176.8 Q 196.6 176.3, 195.9 176.3 Q 195.6 176.3, 195.4 176.5 Q 195.1 176.7, 194.9 176.9 Q 194.8 177.2, 194.8 177.6 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 220.0 226.5 L 221.3 226.5 L 221.3 222.0 L 219.8 222.5 L 219.6 222.0 L 221.5 221.1 L 222.1 221.2 L 222.1 226.5 L 223.3 226.5 L 223.3 227.2 L 220.0 227.2 L 220.0 226.5 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 226.2 227.2 Q 225.1 227.2, 224.6 226.4 Q 224.0 225.6, 224.0 224.2 Q 224.0 222.7, 224.6 221.9 Q 225.1 221.1, 226.2 221.1 Q 227.3 221.1, 227.9 221.9 Q 228.4 222.7, 228.4 224.2 Q 228.4 225.6, 227.9 226.4 Q 227.3 227.2, 226.2 227.2 M 226.2 226.6 Q 226.9 226.6, 227.2 226.0 Q 227.6 225.4, 227.6 224.2 Q 227.6 223.0, 227.2 222.4 Q 226.9 221.8, 226.2 221.8 Q 225.6 221.8, 225.2 222.4 Q 224.9 223.0, 224.9 224.2 Q 224.9 225.4, 225.2 226.0 Q 225.6 226.6, 226.2 226.6 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 226.7 153.2 L 228.1 153.2 L 228.1 148.7 L 226.6 149.2 L 226.4 148.7 L 228.2 147.9 L 228.9 148.0 L 228.9 153.2 L 230.0 153.2 L 230.0 153.9 L 226.7 153.9 L 226.7 153.2 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 231.1 153.2 L 232.4 153.2 L 232.4 148.7 L 230.9 149.2 L 230.8 148.7 L 232.6 147.9 L 233.2 148.0 L 233.2 153.2 L 234.4 153.2 L 234.4 153.9 L 231.1 153.9 L 231.1 153.2 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 276.9 145.3 L 278.2 145.3 L 278.2 140.8 L 276.8 141.3 L 276.6 140.8 L 278.4 140.0 L 279.0 140.1 L 279.0 145.3 L 280.2 145.3 L 280.2 146.0 L 276.9 146.0 L 276.9 145.3 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 281.0 141.1 Q 281.2 140.6, 281.7 140.3 Q 282.2 139.9, 283.0 139.9 Q 283.9 139.9, 284.4 140.4 Q 284.9 140.9, 284.9 141.8 Q 284.9 142.7, 284.2 143.5 Q 283.6 144.3, 282.2 145.3 L 285.0 145.3 L 285.0 146.0 L 281.0 146.0 L 281.0 145.4 Q 282.1 144.6, 282.7 144.0 Q 283.4 143.5, 283.7 142.9 Q 284.0 142.4, 284.0 141.8 Q 284.0 141.3, 283.8 140.9 Q 283.5 140.6, 283.0 140.6 Q 282.5 140.6, 282.2 140.8 Q 281.8 141.0, 281.6 141.4 L 281.0 141.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 196.6 89.1 L 197.9 89.1 L 197.9 84.7 L 196.4 85.1 L 196.3 84.6 L 198.1 83.8 L 198.7 83.9 L 198.7 89.1 L 199.9 89.1 L 199.9 89.8 L 196.6 89.8 L 196.6 89.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 203.5 86.7 Q 204.1 86.8, 204.4 87.2 Q 204.7 87.6, 204.7 88.2 Q 204.7 88.7, 204.4 89.1 Q 204.1 89.5, 203.7 89.7 Q 203.2 89.9, 202.6 89.9 Q 202.0 89.9, 201.5 89.7 Q 201.0 89.5, 200.6 89.0 L 201.1 88.5 Q 201.5 88.9, 201.8 89.1 Q 202.1 89.2, 202.6 89.2 Q 203.1 89.2, 203.5 88.9 Q 203.8 88.6, 203.8 88.2 Q 203.8 87.6, 203.5 87.3 Q 203.1 87.0, 202.4 87.0 L 201.9 87.0 L 201.9 86.4 L 202.3 86.4 Q 203.0 86.4, 203.3 86.1 Q 203.7 85.8, 203.7 85.3 Q 203.7 84.9, 203.4 84.7 Q 203.1 84.4, 202.6 84.4 Q 202.1 84.4, 201.8 84.6 Q 201.5 84.8, 201.3 85.2 L 200.7 84.9 Q 200.9 84.4, 201.4 84.1 Q 201.9 83.7, 202.6 83.7 Q 203.5 83.7, 204.0 84.2 Q 204.5 84.6, 204.5 85.3 Q 204.5 85.8, 204.3 86.1 Q 204.0 86.5, 203.5 86.7 \" fill=\"#000000\"/>\n",
       "</svg>"
      ],
      "text/plain": [
       "<IPython.core.display.SVG object>"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from shnitsel.filtering.structure_selection import StructureSelection\n",
    "\n",
    "# mol = ds.st.default_mol()  # Check whether default_mol returns a copy of mol attr\n",
    "# d_flag, img = st.geo.geomatch.flag_bonds(mol, smarts=, draw=True)\n",
    "structure_selection = StructureSelection.init_from_mol(\n",
    "    mol=mol, default_selection=['atoms', 'bonds', 'dihedrals']\n",
    ")\n",
    "\n",
    "# Restrict all bonds, atoms and dihedrals to the relevant subset\n",
    "dihedral_selection = structure_selection.select_bats('CC=CC')\n",
    "dihedral_selection.draw(flag_level=4)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "b09f3424",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.3125"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from shnitsel.geo.geocalc import get_dihedrals\n",
    "\n",
    "# Calculate dihedrals at the end of the trajectories\n",
    "dih_end = (\n",
    "    get_dihedrals(ds.atXYZ, structure_selection=dihedral_selection, deg=True)\n",
    "    .groupby('atrajectory')\n",
    "    .last()\n",
    ")\n",
    "# Get proportion\n",
    "proportion = (dih_end > 100).sum() / dih_end.sizes['atrajectory']\n",
    "proportion = proportion.item()\n",
    "proportion"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "0a16950c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/svg+xml": [
       "<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:rdkit=\"http://www.rdkit.org/xml\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\" baseProfile=\"full\" xml:space=\"preserve\" width=\"300px\" height=\"300px\" viewBox=\"0 0 300 300\">\n",
       "<!-- END OF HEADER -->\n",
       "<path class=\"bond-4 atom-3 atom-5\" d=\"M 97.9,122.5 L 142.8,126.4 L 136.8,135.0 L 97.1,131.6 Z\" style=\"fill:#C4A000;fill-rule:evenodd;fill-opacity:1;stroke:#C4A000;stroke-width:0.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;\"/>\n",
       "<path class=\"bond-6 atom-5 atom-7\" d=\"M 142.8,126.4 L 160.8,164.9 L 154.8,173.5 L 136.8,135.0 Z\" style=\"fill:#C4A000;fill-rule:evenodd;fill-opacity:1;stroke:#C4A000;stroke-width:0.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;\"/>\n",
       "<path class=\"bond-8 atom-7 atom-9\" d=\"M 160.8,164.9 L 200.5,168.3 L 199.7,177.4 L 154.8,173.5 Z\" style=\"fill:#C4A000;fill-rule:evenodd;fill-opacity:1;stroke:#C4A000;stroke-width:0.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:10;stroke-opacity:1;\"/>\n",
       "<ellipse cx=\"97.5\" cy=\"127.0\" rx=\"8.5\" ry=\"8.5\" class=\"atom-3\" style=\"fill:#C4A000;fill-rule:evenodd;stroke:#C4A000;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<ellipse cx=\"139.8\" cy=\"130.7\" rx=\"8.5\" ry=\"8.5\" class=\"atom-5\" style=\"fill:#C4A000;fill-rule:evenodd;stroke:#C4A000;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<ellipse cx=\"157.8\" cy=\"169.2\" rx=\"8.5\" ry=\"8.5\" class=\"atom-7\" style=\"fill:#C4A000;fill-rule:evenodd;stroke:#C4A000;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<ellipse cx=\"200.1\" cy=\"172.9\" rx=\"8.5\" ry=\"8.5\" class=\"atom-9\" style=\"fill:#C4A000;fill-rule:evenodd;stroke:#C4A000;stroke-width:1.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-0 atom-0 atom-1\" d=\"M 73.2,161.8 L 37.0,158.7\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-1 atom-0 atom-2\" d=\"M 73.2,161.8 L 87.7,192.9\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-2 atom-0 atom-3\" d=\"M 73.2,161.8 L 97.5,127.0\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-2 atom-0 atom-3\" d=\"M 70.1,155.2 L 90.2,126.4\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-3 atom-3 atom-4\" d=\"M 97.5,127.0 L 83.0,96.0\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-4 atom-3 atom-5\" d=\"M 97.5,127.0 L 139.8,130.7\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-5 atom-5 atom-6\" d=\"M 139.8,130.7 L 159.0,103.3\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-6 atom-5 atom-7\" d=\"M 139.8,130.7 L 157.8,169.2\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-6 atom-5 atom-7\" d=\"M 135.6,136.7 L 150.5,168.5\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-7 atom-7 atom-8\" d=\"M 157.8,169.2 L 138.6,196.6\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-8 atom-7 atom-9\" d=\"M 157.8,169.2 L 200.1,172.9\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-9 atom-9 atom-10\" d=\"M 200.1,172.9 L 214.6,203.9\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-10 atom-9 atom-11\" d=\"M 200.1,172.9 L 209.6,159.2\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-10 atom-9 atom-11\" d=\"M 209.6,159.2 L 219.2,145.5\" style=\"fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-10 atom-9 atom-11\" d=\"M 197.0,166.2 L 205.5,154.0\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-10 atom-9 atom-11\" d=\"M 205.5,154.0 L 214.0,141.8\" style=\"fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-11 atom-11 atom-12\" d=\"M 231.4,138.7 L 246.0,139.9\" style=\"fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-11 atom-11 atom-12\" d=\"M 246.0,139.9 L 260.6,141.2\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-12 atom-11 atom-13\" d=\"M 220.9,130.7 L 215.4,118.8\" style=\"fill:none;fill-rule:evenodd;stroke:#0000FF;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"bond-12 atom-11 atom-13\" d=\"M 215.4,118.8 L 209.9,107.0\" style=\"fill:none;fill-rule:evenodd;stroke:#000000;stroke-width:2.0px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\"/>\n",
       "<path class=\"atom-1\" d=\"M 26.2 152.1 L 27.8 152.1 L 27.8 157.3 L 34.0 157.3 L 34.0 152.1 L 35.6 152.1 L 35.6 164.2 L 34.0 164.2 L 34.0 158.6 L 27.8 158.6 L 27.8 164.2 L 26.2 164.2 L 26.2 152.1 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-2\" d=\"M 86.5 194.3 L 88.1 194.3 L 88.1 199.4 L 94.2 199.4 L 94.2 194.3 L 95.9 194.3 L 95.9 206.3 L 94.2 206.3 L 94.2 200.8 L 88.1 200.8 L 88.1 206.3 L 86.5 206.3 L 86.5 194.3 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-4\" d=\"M 74.9 82.6 L 76.5 82.6 L 76.5 87.7 L 82.6 87.7 L 82.6 82.6 L 84.3 82.6 L 84.3 94.6 L 82.6 94.6 L 82.6 89.0 L 76.5 89.0 L 76.5 94.6 L 74.9 94.6 L 74.9 82.6 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-6\" d=\"M 159.4 89.9 L 161.1 89.9 L 161.1 95.0 L 167.2 95.0 L 167.2 89.9 L 168.9 89.9 L 168.9 101.9 L 167.2 101.9 L 167.2 96.4 L 161.1 96.4 L 161.1 101.9 L 159.4 101.9 L 159.4 89.9 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-8\" d=\"M 128.8 198.0 L 130.4 198.0 L 130.4 203.1 L 136.5 203.1 L 136.5 198.0 L 138.2 198.0 L 138.2 210.0 L 136.5 210.0 L 136.5 204.4 L 130.4 204.4 L 130.4 210.0 L 128.8 210.0 L 128.8 198.0 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-10\" d=\"M 213.3 205.3 L 215.0 205.3 L 215.0 210.4 L 221.1 210.4 L 221.1 205.3 L 222.7 205.3 L 222.7 217.3 L 221.1 217.3 L 221.1 211.8 L 215.0 211.8 L 215.0 217.3 L 213.3 217.3 L 213.3 205.3 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-11\" d=\"M 221.7 132.1 L 225.7 138.4 Q 226.1 139.1, 226.7 140.2 Q 227.3 141.3, 227.4 141.4 L 227.4 132.1 L 229.0 132.1 L 229.0 144.1 L 227.3 144.1 L 223.1 137.1 Q 222.6 136.3, 222.1 135.4 Q 221.6 134.4, 221.4 134.1 L 221.4 144.1 L 219.8 144.1 L 219.8 132.1 L 221.7 132.1 \" fill=\"#0000FF\"/>\n",
       "<path class=\"atom-11\" d=\"M 231.2 134.2 L 233.3 134.2 L 233.3 132.0 L 234.3 132.0 L 234.3 134.2 L 236.5 134.2 L 236.5 135.0 L 234.3 135.0 L 234.3 137.3 L 233.3 137.3 L 233.3 135.0 L 231.2 135.0 L 231.2 134.2 \" fill=\"#0000FF\"/>\n",
       "<path class=\"atom-12\" d=\"M 262.0 135.7 L 263.6 135.7 L 263.6 140.8 L 269.8 140.8 L 269.8 135.7 L 271.4 135.7 L 271.4 147.8 L 269.8 147.8 L 269.8 142.2 L 263.6 142.2 L 263.6 147.8 L 262.0 147.8 L 262.0 135.7 \" fill=\"#000000\"/>\n",
       "<path class=\"atom-13\" d=\"M 201.7 93.6 L 203.4 93.6 L 203.4 98.7 L 209.5 98.7 L 209.5 93.6 L 211.1 93.6 L 211.1 105.6 L 209.5 105.6 L 209.5 100.1 L 203.4 100.1 L 203.4 105.6 L 201.7 105.6 L 201.7 93.6 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 69.1 170.7 Q 68.0 170.7, 67.5 169.9 Q 66.9 169.1, 66.9 167.7 Q 66.9 166.2, 67.5 165.4 Q 68.0 164.6, 69.1 164.6 Q 70.3 164.6, 70.8 165.4 Q 71.3 166.2, 71.3 167.7 Q 71.3 169.1, 70.8 169.9 Q 70.2 170.7, 69.1 170.7 M 69.1 170.1 Q 69.8 170.1, 70.1 169.5 Q 70.5 168.8, 70.5 167.7 Q 70.5 166.5, 70.1 165.9 Q 69.8 165.3, 69.1 165.3 Q 68.5 165.3, 68.1 165.9 Q 67.8 166.5, 67.8 167.7 Q 67.8 168.8, 68.1 169.5 Q 68.5 170.1, 69.1 170.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 15.3 159.3 L 16.6 159.3 L 16.6 154.8 L 15.2 155.2 L 15.0 154.7 L 16.8 153.9 L 17.4 154.0 L 17.4 159.3 L 18.6 159.3 L 18.6 160.0 L 15.3 160.0 L 15.3 159.3 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 95.1 211.3 Q 95.4 210.7, 95.9 210.4 Q 96.4 210.1, 97.1 210.1 Q 98.1 210.1, 98.6 210.6 Q 99.1 211.1, 99.1 211.9 Q 99.1 212.8, 98.4 213.7 Q 97.8 214.5, 96.4 215.5 L 99.2 215.5 L 99.2 216.2 L 95.1 216.2 L 95.1 215.6 Q 96.2 214.8, 96.9 214.2 Q 97.6 213.6, 97.9 213.1 Q 98.2 212.5, 98.2 212.0 Q 98.2 211.4, 97.9 211.1 Q 97.6 210.8, 97.1 210.8 Q 96.7 210.8, 96.3 210.9 Q 96.0 211.1, 95.8 211.6 L 95.1 211.3 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 102.5 121.1 Q 103.0 121.3, 103.3 121.7 Q 103.6 122.0, 103.6 122.6 Q 103.6 123.1, 103.4 123.5 Q 103.1 123.9, 102.6 124.2 Q 102.2 124.4, 101.6 124.4 Q 100.9 124.4, 100.4 124.1 Q 99.9 123.9, 99.6 123.5 L 100.0 123.0 Q 100.4 123.4, 100.7 123.5 Q 101.0 123.7, 101.6 123.7 Q 102.1 123.7, 102.4 123.4 Q 102.8 123.1, 102.8 122.6 Q 102.8 122.0, 102.4 121.7 Q 102.1 121.5, 101.3 121.5 L 100.9 121.5 L 100.9 120.9 L 101.3 120.9 Q 101.9 120.8, 102.3 120.6 Q 102.6 120.3, 102.6 119.7 Q 102.6 119.4, 102.3 119.1 Q 102.1 118.9, 101.6 118.9 Q 101.1 118.9, 100.7 119.1 Q 100.4 119.2, 100.2 119.7 L 99.6 119.4 Q 99.8 118.9, 100.3 118.5 Q 100.8 118.2, 101.6 118.2 Q 102.4 118.2, 103.0 118.6 Q 103.5 119.0, 103.5 119.7 Q 103.5 120.2, 103.2 120.6 Q 103.0 120.9, 102.5 121.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 75.2 76.7 L 75.9 76.7 L 75.9 77.4 L 75.2 77.4 L 75.2 78.8 L 74.4 78.8 L 74.4 77.4 L 71.3 77.4 L 71.3 76.8 L 73.9 72.8 L 75.2 72.8 L 75.2 76.7 M 72.3 76.7 L 74.4 76.7 L 74.4 73.3 L 72.3 76.7 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 137.0 123.6 Q 137.5 123.6, 137.9 123.8 Q 138.4 124.0, 138.6 124.4 Q 138.9 124.8, 138.9 125.4 Q 138.9 126.0, 138.6 126.5 Q 138.3 126.9, 137.8 127.2 Q 137.3 127.4, 136.7 127.4 Q 136.2 127.4, 135.7 127.2 Q 135.1 127.0, 134.8 126.6 L 135.3 126.1 Q 135.6 126.4, 136.0 126.5 Q 136.3 126.7, 136.7 126.7 Q 137.3 126.7, 137.6 126.4 Q 138.0 126.0, 138.0 125.4 Q 138.0 124.8, 137.6 124.5 Q 137.3 124.2, 136.7 124.2 Q 136.2 124.2, 135.6 124.4 L 135.1 124.2 L 135.4 121.3 L 138.5 121.3 L 138.4 122.0 L 136.1 122.0 L 135.9 123.8 Q 136.4 123.6, 137.0 123.6 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 172.5 83.6 Q 173.1 83.6, 173.5 83.9 Q 173.9 84.1, 174.1 84.5 Q 174.3 84.9, 174.3 85.4 Q 174.3 86.0, 174.1 86.5 Q 173.8 86.9, 173.4 87.2 Q 172.9 87.4, 172.3 87.4 Q 171.3 87.4, 170.7 86.7 Q 170.2 86.0, 170.2 84.5 Q 170.2 83.0, 170.8 82.1 Q 171.5 81.3, 172.8 81.3 Q 173.2 81.3, 173.5 81.4 Q 173.8 81.5, 174.1 81.6 L 173.8 82.2 Q 173.3 82.0, 172.8 82.0 Q 171.9 82.0, 171.5 82.5 Q 171.1 83.1, 171.0 84.2 Q 171.3 83.9, 171.7 83.8 Q 172.1 83.6, 172.5 83.6 M 172.3 86.7 Q 172.7 86.7, 172.9 86.6 Q 173.2 86.4, 173.3 86.1 Q 173.5 85.8, 173.5 85.4 Q 173.5 84.9, 173.2 84.6 Q 172.9 84.3, 172.4 84.3 Q 172.0 84.3, 171.6 84.5 Q 171.3 84.6, 171.0 84.9 Q 171.1 85.8, 171.4 86.3 Q 171.7 86.7, 172.3 86.7 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 163.0 161.1 L 159.8 161.1 L 159.8 160.4 L 163.8 160.4 L 163.8 161.0 L 161.4 166.4 L 160.6 166.4 L 163.0 161.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 126.3 215.4 Q 126.8 215.7, 127.2 216.0 Q 127.5 216.4, 127.5 217.0 Q 127.5 217.5, 127.2 217.9 Q 126.9 218.3, 126.5 218.5 Q 126.0 218.7, 125.4 218.7 Q 124.4 218.7, 123.8 218.2 Q 123.2 217.8, 123.2 217.0 Q 123.2 216.5, 123.5 216.1 Q 123.7 215.7, 124.3 215.4 Q 123.9 215.2, 123.7 214.9 Q 123.4 214.6, 123.4 214.1 Q 123.4 213.4, 124.0 212.9 Q 124.5 212.5, 125.3 212.5 Q 126.2 212.5, 126.7 212.9 Q 127.2 213.4, 127.2 214.1 Q 127.2 214.5, 127.0 214.8 Q 126.8 215.2, 126.3 215.4 M 125.3 213.2 Q 124.8 213.2, 124.6 213.4 Q 124.3 213.6, 124.3 214.1 Q 124.3 214.4, 124.5 214.6 Q 124.7 214.8, 124.9 214.9 Q 125.2 215.0, 125.7 215.2 Q 126.1 215.0, 126.2 214.7 Q 126.4 214.4, 126.4 214.1 Q 126.4 213.6, 126.1 213.4 Q 125.8 213.2, 125.3 213.2 M 125.4 218.1 Q 125.9 218.1, 126.3 217.8 Q 126.6 217.4, 126.6 216.9 Q 126.6 216.6, 126.4 216.4 Q 126.3 216.2, 126.0 216.1 Q 125.7 216.0, 125.3 215.8 L 124.9 215.7 Q 124.4 216.0, 124.3 216.3 Q 124.1 216.6, 124.1 216.9 Q 124.1 217.4, 124.4 217.8 Q 124.8 218.1, 125.4 218.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 196.0 175.6 Q 197.0 175.6, 197.6 176.3 Q 198.1 177.1, 198.1 178.5 Q 198.1 180.1, 197.4 180.9 Q 196.8 181.8, 195.5 181.8 Q 195.1 181.8, 194.8 181.7 Q 194.5 181.6, 194.2 181.4 L 194.5 180.8 Q 194.9 181.1, 195.5 181.1 Q 196.3 181.1, 196.8 180.5 Q 197.2 180.0, 197.2 178.9 Q 196.9 179.1, 196.6 179.3 Q 196.2 179.4, 195.8 179.4 Q 195.2 179.4, 194.8 179.2 Q 194.4 179.0, 194.2 178.6 Q 193.9 178.1, 193.9 177.6 Q 193.9 177.0, 194.2 176.6 Q 194.5 176.1, 194.9 175.9 Q 195.4 175.6, 196.0 175.6 M 194.8 177.6 Q 194.8 178.1, 195.1 178.5 Q 195.4 178.8, 195.9 178.8 Q 196.3 178.8, 196.6 178.6 Q 197.0 178.5, 197.2 178.2 Q 197.2 177.2, 196.9 176.8 Q 196.6 176.3, 195.9 176.3 Q 195.6 176.3, 195.4 176.5 Q 195.1 176.7, 194.9 176.9 Q 194.8 177.2, 194.8 177.6 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 220.0 226.5 L 221.3 226.5 L 221.3 222.0 L 219.8 222.5 L 219.6 222.0 L 221.5 221.1 L 222.1 221.2 L 222.1 226.5 L 223.3 226.5 L 223.3 227.2 L 220.0 227.2 L 220.0 226.5 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 226.2 227.2 Q 225.1 227.2, 224.6 226.4 Q 224.0 225.6, 224.0 224.2 Q 224.0 222.7, 224.6 221.9 Q 225.1 221.1, 226.2 221.1 Q 227.3 221.1, 227.9 221.9 Q 228.4 222.7, 228.4 224.2 Q 228.4 225.6, 227.9 226.4 Q 227.3 227.2, 226.2 227.2 M 226.2 226.6 Q 226.9 226.6, 227.2 226.0 Q 227.6 225.4, 227.6 224.2 Q 227.6 223.0, 227.2 222.4 Q 226.9 221.8, 226.2 221.8 Q 225.6 221.8, 225.2 222.4 Q 224.9 223.0, 224.9 224.2 Q 224.9 225.4, 225.2 226.0 Q 225.6 226.6, 226.2 226.6 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 226.7 153.2 L 228.1 153.2 L 228.1 148.7 L 226.6 149.2 L 226.4 148.7 L 228.2 147.9 L 228.9 148.0 L 228.9 153.2 L 230.0 153.2 L 230.0 153.9 L 226.7 153.9 L 226.7 153.2 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 231.1 153.2 L 232.4 153.2 L 232.4 148.7 L 230.9 149.2 L 230.8 148.7 L 232.6 147.9 L 233.2 148.0 L 233.2 153.2 L 234.4 153.2 L 234.4 153.9 L 231.1 153.9 L 231.1 153.2 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 276.9 145.3 L 278.2 145.3 L 278.2 140.8 L 276.8 141.3 L 276.6 140.8 L 278.4 140.0 L 279.0 140.1 L 279.0 145.3 L 280.2 145.3 L 280.2 146.0 L 276.9 146.0 L 276.9 145.3 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 281.0 141.1 Q 281.2 140.6, 281.7 140.3 Q 282.2 139.9, 283.0 139.9 Q 283.9 139.9, 284.4 140.4 Q 284.9 140.9, 284.9 141.8 Q 284.9 142.7, 284.2 143.5 Q 283.6 144.3, 282.2 145.3 L 285.0 145.3 L 285.0 146.0 L 281.0 146.0 L 281.0 145.4 Q 282.1 144.6, 282.7 144.0 Q 283.4 143.5, 283.7 142.9 Q 284.0 142.4, 284.0 141.8 Q 284.0 141.3, 283.8 140.9 Q 283.5 140.6, 283.0 140.6 Q 282.5 140.6, 282.2 140.8 Q 281.8 141.0, 281.6 141.4 L 281.0 141.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 196.6 89.1 L 197.9 89.1 L 197.9 84.7 L 196.4 85.1 L 196.3 84.6 L 198.1 83.8 L 198.7 83.9 L 198.7 89.1 L 199.9 89.1 L 199.9 89.8 L 196.6 89.8 L 196.6 89.1 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 203.5 86.7 Q 204.1 86.8, 204.4 87.2 Q 204.7 87.6, 204.7 88.2 Q 204.7 88.7, 204.4 89.1 Q 204.1 89.5, 203.7 89.7 Q 203.2 89.9, 202.6 89.9 Q 202.0 89.9, 201.5 89.7 Q 201.0 89.5, 200.6 89.0 L 201.1 88.5 Q 201.5 88.9, 201.8 89.1 Q 202.1 89.2, 202.6 89.2 Q 203.1 89.2, 203.5 88.9 Q 203.8 88.6, 203.8 88.2 Q 203.8 87.6, 203.5 87.3 Q 203.1 87.0, 202.4 87.0 L 201.9 87.0 L 201.9 86.4 L 202.3 86.4 Q 203.0 86.4, 203.3 86.1 Q 203.7 85.8, 203.7 85.3 Q 203.7 84.9, 203.4 84.7 Q 203.1 84.4, 202.6 84.4 Q 202.1 84.4, 201.8 84.6 Q 201.5 84.8, 201.3 85.2 L 200.7 84.9 Q 200.9 84.4, 201.4 84.1 Q 201.9 83.7, 202.6 83.7 Q 203.5 83.7, 204.0 84.2 Q 204.5 84.6, 204.5 85.3 Q 204.5 85.8, 204.3 86.1 Q 204.0 86.5, 203.5 86.7 \" fill=\"#000000\"/>\n",
       "<path class=\"note\" d=\"M 155.3 144.5 Q 155.9 144.7, 156.1 145.1 Q 156.4 145.5, 156.4 146.1 Q 156.4 146.6, 156.2 147.0 Q 155.9 147.4, 155.5 147.6 Q 155.0 147.8, 154.4 147.8 Q 153.7 147.8, 153.2 147.6 Q 152.8 147.3, 152.4 146.9 L 152.9 146.4 Q 153.2 146.8, 153.6 147.0 Q 153.9 147.1, 154.4 147.1 Q 154.9 147.1, 155.2 146.8 Q 155.6 146.5, 155.6 146.1 Q 155.6 145.4, 155.2 145.2 Q 154.9 144.9, 154.2 144.9 L 153.7 144.9 L 153.7 144.3 L 154.1 144.3 Q 154.8 144.3, 155.1 144.0 Q 155.5 143.7, 155.5 143.2 Q 155.5 142.8, 155.2 142.5 Q 154.9 142.3, 154.4 142.3 Q 153.9 142.3, 153.6 142.5 Q 153.3 142.7, 153.0 143.1 L 152.4 142.8 Q 152.7 142.3, 153.2 142.0 Q 153.7 141.6, 154.4 141.6 Q 155.3 141.6, 155.8 142.0 Q 156.3 142.5, 156.3 143.2 Q 156.3 143.6, 156.0 144.0 Q 155.8 144.3, 155.3 144.5 \" fill=\"#7F7FFF\"/>\n",
       "<path class=\"note\" d=\"M 157.7 147.0 L 159.0 147.0 L 159.0 142.5 L 157.6 143.0 L 157.4 142.5 L 159.2 141.7 L 159.8 141.8 L 159.8 147.0 L 161.0 147.0 L 161.0 147.7 L 157.7 147.7 L 157.7 147.0 \" fill=\"#7F7FFF\"/>\n",
       "<path class=\"note\" d=\"M 162.9 147.7 L 166.5 141.4 L 167.1 141.8 L 163.5 148.0 L 162.9 147.7 M 163.2 145.1 Q 162.5 145.1, 162.2 144.7 Q 161.9 144.2, 161.9 143.4 Q 161.9 142.5, 162.2 142.1 Q 162.5 141.6, 163.2 141.6 Q 163.9 141.6, 164.2 142.1 Q 164.5 142.5, 164.5 143.4 Q 164.5 144.2, 164.2 144.7 Q 163.9 145.1, 163.2 145.1 M 163.2 144.5 Q 163.5 144.5, 163.7 144.2 Q 163.8 143.9, 163.8 143.4 Q 163.8 142.8, 163.7 142.5 Q 163.5 142.2, 163.2 142.2 Q 162.9 142.2, 162.7 142.5 Q 162.5 142.8, 162.5 143.4 Q 162.5 143.9, 162.7 144.2 Q 162.9 144.5, 163.2 144.5 M 167.0 147.8 Q 166.3 147.8, 166.0 147.3 Q 165.6 146.8, 165.6 146.0 Q 165.6 145.2, 166.0 144.7 Q 166.3 144.3, 167.0 144.3 Q 167.6 144.3, 168.0 144.7 Q 168.3 145.2, 168.3 146.0 Q 168.3 146.8, 168.0 147.3 Q 167.6 147.8, 167.0 147.8 M 167.0 147.2 Q 167.3 147.2, 167.4 146.9 Q 167.6 146.6, 167.6 146.0 Q 167.6 145.4, 167.4 145.2 Q 167.3 144.9, 167.0 144.9 Q 166.6 144.9, 166.5 145.2 Q 166.3 145.5, 166.3 146.0 Q 166.3 146.6, 166.5 146.9 Q 166.6 147.2, 167.0 147.2 \" fill=\"#7F7FFF\"/>\n",
       "</svg>"
      ],
      "text/plain": [
       "<IPython.core.display.SVG object>"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Find only the central double bond in dihedral\n",
    "double_bond_selection = dihedral_selection.select_bonds('C=C')\n",
    "\n",
    "# Make sure the bond is unique\n",
    "assert len(double_bond_selection.bonds_selected) == 1, \"Found more than 1 relevant bond\"\n",
    "# Get bond index in mol\n",
    "bond_index = double_bond_selection.bond_descriptor_to_mol_index(\n",
    "    list(double_bond_selection.bonds_selected)\n",
    ")[0]\n",
    "# Assign the label to the bond\n",
    "dihedral_selection.mol.GetBondWithIdx(bond_index).SetProp(\n",
    "    'bondNote', f\"{proportion * 100:.0f}%\"\n",
    ")\n",
    "# Visualize selection\n",
    "dihedral_selection.draw()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "shnitsel-tools-official (3.12.3)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
