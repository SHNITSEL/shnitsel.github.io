shnitsel.data.helpers
=====================

.. py:module:: shnitsel.data.helpers


Attributes
----------

.. autoapisummary::

   shnitsel.data.helpers.T
   shnitsel.data.helpers.DataType
   shnitsel.data.helpers.ActualDataType


Functions
---------

.. autoapisummary::

   shnitsel.data.helpers.dataclass_from_dict
   shnitsel.data.helpers.is_assignable_to
   shnitsel.data.helpers.setup_frames
   shnitsel.data.helpers.validate
   shnitsel.data.helpers.split_for_saving
   shnitsel.data.helpers.save_split


Module Contents
---------------

.. py:data:: T

.. py:data:: DataType

.. py:data:: ActualDataType

.. py:function:: dataclass_from_dict(datatype, d)

   Helper function to restore a Dataclass object from its dict representation.

   Mainly used for serialization or storage of data in the DataTree db structure.

   :param datatype: The dataclass type to restore
   :type datatype: Type[T]
   :param d: The datasource to convert back into the Dataclass instance.
   :type d: List|Dict|T

   :raises ValueError: If value decoding fails during reconstruction
   :raises TypeError: If some type mismatch occurs between the provided dict and the target type

   :returns: A resonstructed `datatype` instance.
   :rtype: T


.. py:function:: is_assignable_to(actual_type, expected_dtype)

   Helper function to check whether a certain type can be considered assignable to
   another type, effectively a more general `is_subclass` function.


   :param actual_type: The exact type that an object has or that is declared as the type of an object
   :type actual_type: type[ActualDataType] | TypeForm[ActualDataType]
   :param expected_dtype: The expected type that we would want to assign to.
                          The `actual_type` should be some combination of subclasses of the target types in `expected_dtype`.
                          If this parameter is None, the result will be True.
   :type expected_dtype: type[DataType] | TypeForm[DataType] | None

   :returns: True if `actual_type` can be considered some form of subtype to `expected_dtype` or if the
             expected target type is None. Otherwise False.
   :rtype: bool


.. py:function:: setup_frames(ds, *, to_time = None, convert_to_eV = None, convert_e_kin_to_eV = None, relativize_energy = None, relativize_selector=None)

   Performs several frequent setup tasks.
   Each task can be skipped (by setting the corresponding parameter to False),
   carried out if appropriate (None), or forced in the sense that an error is
   thrown if the task is redundant (True).


   :param ds: The frames-like xr.Dataset to setup.
   :param to_time: Whether to convert a 'ts' (timestep) coordinate to a 'time' coordinate, by default None
   :param optional: Whether to convert a 'ts' (timestep) coordinate to a 'time' coordinate, by default None
   :param convert_to_eV: Whether to convert the 'energy' variable to eV, by default None
   :param optional: Whether to convert the 'energy' variable to eV, by default None
   :param convert_e_kin_to_eV: Whether to convert the 'e_kin' (kinetic energy) variable to eV, by default None
   :param optional: Whether to convert the 'e_kin' (kinetic energy) variable to eV, by default None
   :param relativize_energy: Whether to relativize energies, by default None
   :param optional: Whether to relativize energies, by default None
   :param relativize_selector: This argument is passed to relativize, by default None
   :param optional: This argument is passed to relativize, by default None

   :rtype: A modified frames-like xr.Dataset

   :raises ValueError: If a task should be forced (i.e. the corresponding parameter is set to True)
       but cannot be carried out (e.g. because the dataset was already processed previously)


.. py:function:: validate(frames)

.. py:function:: split_for_saving(frames, bytes_per_chunk=50000000.0)

.. py:function:: save_split(frames, path_template, bytes_per_chunk=50000000.0, complevel=9, ignore_errors=False)

