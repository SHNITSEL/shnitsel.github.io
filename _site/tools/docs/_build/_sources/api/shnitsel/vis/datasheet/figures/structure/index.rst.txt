shnitsel.vis.datasheet.figures.structure
========================================

.. py:module:: shnitsel.vis.datasheet.figures.structure


Functions
---------

.. autoapisummary::

   shnitsel.vis.datasheet.figures.structure.mol_to_png
   shnitsel.vis.datasheet.figures.structure.mol_to_svg
   shnitsel.vis.datasheet.figures.structure.format_inchi
   shnitsel.vis.datasheet.figures.structure.plot_structure
   shnitsel.vis.datasheet.figures.structure.plot_pca_structure


Module Contents
---------------

.. py:function:: mol_to_png(mol, width = 320, height = 240)

   Helper function to plot an rdkit.Mol object as a 2D structural representation

   :param mol: RDKit representation of the molecule to plot
   :type mol: rdChem.Mol
   :param width: Width of the canvas to plot to. Defaults to 320.
   :type width: int, optional
   :param height: Height of the canvas to plot to. Defaults to 240.
   :type height: int, optional

   :returns: The drawn structure of the `mol` molecule in 2D as a sequence of bytes.
   :rtype: bytes


.. py:function:: mol_to_svg(mol, width = 320, height = 240)

   Helper function to plot an rdkit.Mol object as a 2D structural representation using vector graphics

   :param mol: RDKit representation of the molecule to plot
   :type mol: rdChem.Mol
   :param width: Width of the canvas to plot to. Defaults to 320.
   :type width: int, optional
   :param height: Height of the canvas to plot to. Defaults to 240.
   :type height: int, optional

   :returns: The drawn structure of the `mol` molecule in 2D as a sequence of bytes.
   :rtype: bytes


.. py:function:: format_inchi(inchi, max_line_length = 30)

   Helper function to split an inchi string across
   multiple lines to not overlap other plots in the DataSheet pages.

   :param inchi: InChi string as generated by RDKit
   :type inchi: str
   :param max_line_length: Maximum line length. Defaults to 30 characters
   :type max_line_length: int, optional

   :returns: The string broken into multiple lines with inserted \n characters.
   :rtype: str


.. py:function:: plot_structure(mol, name = '', smiles = None, inchi = None, fig = None, ax = None)

   Plot function to create a 2d structure representation of a molecule `mol` using rdkit and create a graph with
   a 2d image representation into `fig` or `ax` with at least one of the two needing to be provided.

   :param mol: The RDKit molecule object to visualize.
   :type mol: rdChem.Mol
   :param name: The name of the structure. Would be used as a plot title if not empty. Defaults to ''.
   :type name: str, optional
   :param smiles: Smiles strings to include in the x-axis label. Defaults to None.
   :type smiles: str | None, optional
   :param inchi: InChI strings to include in the x-axis label. Defaults to None.
   :type inchi: str | None, optional
   :param fig: Figure to plot the graphic into if `ax` not provided. Defaults to None.
   :type fig: Figure | SubFigure | None, optional
   :param ax: Axis to plot the graphic into. Defaults to None, meaning they will be created from `fig`.
   :type ax: Axes | None, optional

   :returns: The axes the graphic was plotted to.
   :rtype: Axes


.. py:function:: plot_pca_structure(frames, pca_data, fig = None, axs = None)

   Function to plot the most extreme pca combinations as structure plots.

   :param frames: The raw input data to use for extracting the positional data and structure.
   :type frames: Frames | xr.Dataset
   :param pca_data: PCA decomposition data.
   :type pca_data: xr.DataArray
   :param fig: Figure to create axes into. If `axs` are provided, this can be left empty.
   :type fig: Figure | SubFigure, optional
   :param axs: Axes to plot the extrema to. One row per pca, one column for 'min' or 'max'. Defaults to None.
   :type axs: dict[tuple[int,str],Axes] | None, optional

   :returns: The axes the extrema have been plotted to.
   :rtype: dict[tuple[int,str],Axes]


