<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>shnitsel.analyze.stats &#8212; shnitsel-tools 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
    <script src="../../../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="shnitsel.bridges" href="../../bridges/index.html" />
    <link rel="prev" title="shnitsel.analyze.spectra" href="../spectra/index.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-shnitsel.analyze.stats">
<span id="shnitsel-analyze-stats"></span><h1>shnitsel.analyze.stats<a class="headerlink" href="#module-shnitsel.analyze.stats" title="Link to this heading">¶</a></h1>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.analyze.stats.calc_confidence_interval" title="shnitsel.analyze.stats.calc_confidence_interval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_confidence_interval</span></code></a>(data_array[, confidence])</p></td>
<td><p>Function to calculate the confidence interval for a variable array <cite>a</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.analyze.stats.confidence_interval_aggregate_last_dim" title="shnitsel.analyze.stats.confidence_interval_aggregate_last_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">confidence_interval_aggregate_last_dim</span></code></a>(data_array[, ...])</p></td>
<td><p>Calculate the confidence interval from statistics aggregated across the last dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.analyze.stats.calc_confidence_interval_in_array_dimensions" title="shnitsel.analyze.stats.calc_confidence_interval_in_array_dimensions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_confidence_interval_in_array_dimensions</span></code></a>(...[, ...])</p></td>
<td><p>Function to calculate confidence interval data for the input data_array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.analyze.stats.time_grouped_confidence_interval" title="shnitsel.analyze.stats.time_grouped_confidence_interval"><code class="xref py py-obj docutils literal notranslate"><span class="pre">time_grouped_confidence_interval</span></code></a>(data_array[, confidence])</p></td>
<td><p>Function to calculate the per-time confidence interval of a DataArray that is groupable by the <cite>time</cite> coordinate.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.analyze.stats.get_per_state" title="shnitsel.analyze.stats.get_per_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_per_state</span></code></a>(frames)</p></td>
<td><p>Isolate the standard per-state properties (energy, forces, permanent dipoles)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.analyze.stats.get_inter_state" title="shnitsel.analyze.stats.get_inter_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_inter_state</span></code></a>(frames)</p></td>
<td><p>Calculate inter-state properties of a dataset for certain observables.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.stats.calc_confidence_interval">
<span class="sig-name descname"><span class="pre">calc_confidence_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.stats.calc_confidence_interval" title="Link to this definition">¶</a></dt>
<dd><p>Function to calculate the confidence interval for a variable array <cite>a</cite>.</p>
<p>The result is a numpy array with stacked entries with the lower and upper limits of the confidence interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>npt.NDArray</em>) – The Numpy array to calculate the confidence interval for.</p></li>
<li><p><strong>confidence</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – The confidence level to get the confidence interval for. Defaults to 0.95.</p></li>
<li><p><strong>data_array</strong> (<em>numpy.typing.NDArray</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – Raised if the provided <cite>data_array</cite> is not one-dimensional</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Numpy array with lower and upper bounds of the confidence interval</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.stats.confidence_interval_aggregate_last_dim">
<span class="sig-name descname"><span class="pre">confidence_interval_aggregate_last_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.stats.confidence_interval_aggregate_last_dim" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the confidence interval from statistics aggregated across the last dimension.</p>
<p>For our purposes, this should amount to the trajectory being averaged over.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_array</strong> (<em>npt.NDArray</em>) – The numpy data array to calculate the confidence interval for.</p></li>
<li><p><strong>confidence</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – The confidence level to use for calculations. Defaults to 0.95.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A numpy array with (lower_bound,upper_bound,mean) of the confidence interval in the last dimension. Otherwise same shape as data_array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.NDArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.stats.calc_confidence_interval_in_array_dimensions">
<span class="sig-name descname"><span class="pre">calc_confidence_interval_in_array_dimensions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.stats.calc_confidence_interval_in_array_dimensions" title="Link to this definition">¶</a></dt>
<dd><p>Function to calculate confidence interval data for the input data_array.
Results are then repackaged back into an xr.DataArray, where the dimension <cite>bound</cite> allows to choose between confidence interval limits and the mean of the distribution.</p>
<p>The dimension denoted by <cite>dim</cite> will be aggregated across.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_array</strong> (<em>xr.DataArray</em>) – Input data to have confidence intervals calculated for.</p></li>
<li><p><strong>dim</strong> (<em>DimName</em>) – Dimension to calculate the confidence interval data from.</p></li>
<li><p><strong>confidence</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Confidence level for Confidence interval calculation. Defaults to 0.95.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataArray with coordinate <cite>bound</cite> with values ‘lower’, ‘upper’, and ‘mean’, which refer to the lower and the upper bound of the confidence interval of this and</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.stats.time_grouped_confidence_interval">
<span class="sig-name descname"><span class="pre">time_grouped_confidence_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.stats.time_grouped_confidence_interval" title="Link to this definition">¶</a></dt>
<dd><p>Function to calculate the per-time confidence interval of a DataArray that is groupable by the <cite>time</cite> coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_array</strong> (<em>xr.DataArray</em>) – Data Array for whose data the confidence intervals should be calculated</p></li>
<li><p><strong>confidence</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – The confidence level to calculate the interval bounds for. Defaults to 0.9.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new Dataset, where variables ‘lower’, ‘upper’ and ‘mean’ contain the lower and upper bounds of the confidence interval in each time step and mean is the mean at each point in time.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.stats.get_per_state">
<span class="sig-name descname"><span class="pre">get_per_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.stats.get_per_state" title="Link to this definition">¶</a></dt>
<dd><p>Isolate the standard per-state properties (energy, forces, permanent dipoles)
from an xr.Dataset, and take their norm over all array dimensions other than ‘state’
so that the resulting variables can be easily plotted against another.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>shnitsel.core.typedefs.Frames</em>) – An xr.Dataset object containing at least ‘energy’, ‘forces’ and ‘dip_perm’ variables</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An xr.Dataset object containing only ‘energy’, ‘forces’ and ‘dip_perm’ variables</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PerState</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.stats.get_inter_state">
<span class="sig-name descname"><span class="pre">get_inter_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.stats.get_inter_state" title="Link to this definition">¶</a></dt>
<dd><p>Calculate inter-state properties of a dataset for certain observables.</p>
<p>Currently calculates inter-state levels of energy differences.
Will calculate Differences between the values of these observables indexed by state.
If no <cite>statecomb</cite> dimension exists, will create one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>Frames</em>) – The basis Dataset to calculate the interstate properties for</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Dataset containing interstate properties</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>InterState</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">shnitsel-tools</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../top-level.html">Top-level functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../accessors/ds_accessors.html">Dataset accessor methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../accessors/da_accessors.html">DataArray accessor methods</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">API Reference</a><ul>
  <li><a href="../../index.html">shnitsel</a><ul>
  <li><a href="../index.html">shnitsel.analyze</a><ul>
      <li>Previous: <a href="../spectra/index.html" title="previous chapter">shnitsel.analyze.spectra</a></li>
      <li>Next: <a href="../../bridges/index.html" title="next chapter">shnitsel.bridges</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Theodor Everley Röhrkasten, Carolin Müller.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../../_sources/api/shnitsel/analyze/stats/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>