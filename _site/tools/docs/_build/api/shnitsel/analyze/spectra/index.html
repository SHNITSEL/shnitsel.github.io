
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>shnitsel.analyze.spectra &#8212; shnitsel-tools 2026.01.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../_static/documentation_options.js?v=06dcdba1"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/shnitsel/analyze/spectra/index';</script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="shnitsel.analyze.stats" href="../stats/index.html" />
    <link rel="prev" title="shnitsel.analyze.populations" href="../populations/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">shnitsel-tools 2026.01.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../top-level.html">
    Top-level functions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../accessors/ds_accessors.html">
    Dataset accessor methods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../accessors/da_accessors.html">
    DataArray accessor methods
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../../index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../tutorials.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../top-level.html">
    Top-level functions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../accessors/ds_accessors.html">
    Dataset accessor methods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../accessors/da_accessors.html">
    DataArray accessor methods
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../../index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../tutorials.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../angles/index.html">angles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../algebra/index.html">algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../helpers/index.html">helpers</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../index.html">shnitsel</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../_accessors/index.html">shnitsel._accessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_contracts/index.html">shnitsel._contracts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_generated_accessors/index.html">shnitsel._generated_accessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_state/index.html">shnitsel._state</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../index.html">shnitsel.analyze</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../generic/index.html">shnitsel.analyze.generic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hops/index.html">shnitsel.analyze.hops</a></li>
<li class="toctree-l3"><a class="reference internal" href="../lda/index.html">shnitsel.analyze.lda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pca/index.html">shnitsel.analyze.pca</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pls/index.html">shnitsel.analyze.pls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../populations/index.html">shnitsel.analyze.populations</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">shnitsel.analyze.spectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats/index.html">shnitsel.analyze.stats</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../bridges/index.html">shnitsel.bridges</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../clean/index.html">shnitsel.clean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../clean/common/index.html">shnitsel.clean.common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../clean/dispatch_plots/index.html">shnitsel.clean.dispatch_plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../clean/filter_energy/index.html">shnitsel.clean.filter_energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../clean/filter_geo/index.html">shnitsel.clean.filter_geo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../clean/filtration_class/index.html">shnitsel.clean.filtration_class</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../core/index.html">shnitsel.core</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../core/_api_info/index.html">shnitsel.core._api_info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/feature_detection/index.html">shnitsel.core.feature_detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../core/typedefs/index.html">shnitsel.core.typedefs</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../data/index.html">shnitsel.data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../data/atom_helpers/index.html">shnitsel.data.atom_helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/charge_helpers/index.html">shnitsel.data.charge_helpers</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../data/dataset_containers/index.html">shnitsel.data.dataset_containers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/data_series/index.html">shnitsel.data.dataset_containers.data_series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/dataset_vis/index.html">shnitsel.data.dataset_containers.dataset_vis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/frames/index.html">shnitsel.data.dataset_containers.frames</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html">shnitsel.data.dataset_containers.inter_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/multi_layered/index.html">shnitsel.data.dataset_containers.multi_layered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/multi_series/index.html">shnitsel.data.dataset_containers.multi_series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/multi_stacked/index.html">shnitsel.data.dataset_containers.multi_stacked</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/per_state/index.html">shnitsel.data.dataset_containers.per_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/shared/index.html">shnitsel.data.dataset_containers.shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/trajectory/index.html">shnitsel.data.dataset_containers.trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/trajectory_collection/index.html">shnitsel.data.dataset_containers.trajectory_collection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/dataset_containers/xr_conversion/index.html">shnitsel.data.dataset_containers.xr_conversion</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/helpers/index.html">shnitsel.data.helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/multi_indices/index.html">shnitsel.data.multi_indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/proxy_class/index.html">shnitsel.data.proxy_class</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../data/shnitsel_db/index.html">shnitsel.data.shnitsel_db</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../data/shnitsel_db/db_function_decorator/index.html">shnitsel.data.shnitsel_db.db_function_decorator</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/shnitsel_db_helpers/index.html">shnitsel.data.shnitsel_db_helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/state_helpers/index.html">shnitsel.data.state_helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/traj_combiner_methods/index.html">shnitsel.data.traj_combiner_methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/trajectory_grouping_params/index.html">shnitsel.data.trajectory_grouping_params</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/trajectory_variable_description/index.html">shnitsel.data.trajectory_variable_description</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../data/tree/index.html">shnitsel.data.tree</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/child_support_functions/index.html">shnitsel.data.tree.child_support_functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/compound/index.html">shnitsel.data.tree.compound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/data_group/index.html">shnitsel.data.tree.data_group</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/data_leaf/index.html">shnitsel.data.tree.data_leaf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/datatree_level/index.html">shnitsel.data.tree.datatree_level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/node/index.html">shnitsel.data.tree.node</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/selection/index.html">shnitsel.data.tree.selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/support_functions/index.html">shnitsel.data.tree.support_functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/tree/index.html">shnitsel.data.tree.tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/tree_completion/index.html">shnitsel.data.tree.tree_completion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/tree_vis/index.html">shnitsel.data.tree.tree_vis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../data/tree/xr_conversion/index.html">shnitsel.data.tree.xr_conversion</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/xr_io_compatibility/index.html">shnitsel.data.xr_io_compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../data/xr_io_registry/index.html">shnitsel.data.xr_io_registry</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../filtering/index.html">shnitsel.filtering</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../filtering/helpers/index.html">shnitsel.filtering.helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../filtering/state_selection/index.html">shnitsel.filtering.state_selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../filtering/structure_selection/index.html">shnitsel.filtering.structure_selection</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../geo/index.html">shnitsel.geo</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../geo/alignment/index.html">shnitsel.geo.alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geo/analogs/index.html">shnitsel.geo.analogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../geo/geocalc/index.html">shnitsel.geo.geocalc</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../io/index.html">shnitsel.io</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../io/ase/index.html">shnitsel.io.ase</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../io/ase/format_reader/index.html">shnitsel.io.ase.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/ase/parse/index.html">shnitsel.io.ase.parse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/ase/write/index.html">shnitsel.io.ase.write</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../io/format_reader_base/index.html">shnitsel.io.format_reader_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../io/format_registry/index.html">shnitsel.io.format_registry</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../io/newtonx/index.html">shnitsel.io.newtonx</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../io/newtonx/format_reader/index.html">shnitsel.io.newtonx.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/newtonx/parse/index.html">shnitsel.io.newtonx.parse</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../io/pyrai2md/index.html">shnitsel.io.pyrai2md</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../io/pyrai2md/format_reader/index.html">shnitsel.io.pyrai2md.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/pyrai2md/parse/index.html">shnitsel.io.pyrai2md.parse</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../io/read/index.html">shnitsel.io.read</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../io/sharc/index.html">shnitsel.io.sharc</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../io/sharc/format_reader/index.html">shnitsel.io.sharc.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/sharc/parse_initial_conditions/index.html">shnitsel.io.sharc.parse_initial_conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/sharc/parse_trajectory/index.html">shnitsel.io.sharc.parse_trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/sharc/qm_helpers/index.html">shnitsel.io.sharc.qm_helpers</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../io/shnitsel/index.html">shnitsel.io.shnitsel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../io/shnitsel/format_reader/index.html">shnitsel.io.shnitsel.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/shnitsel/parse/index.html">shnitsel.io.shnitsel.parse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../io/shnitsel/write/index.html">shnitsel.io.shnitsel.write</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../io/xyz/index.html">shnitsel.io.xyz</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../io/xyz/parse/index.html">shnitsel.io.xyz.parse</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../rd/index.html">shnitsel.rd</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../units/index.html">shnitsel.units</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../units/conversion/index.html">shnitsel.units.conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../units/defaults/index.html">shnitsel.units.defaults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../units/definitions/index.html">shnitsel.units.definitions</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../vis/index.html">shnitsel.vis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../vis/colormaps/index.html">shnitsel.vis.colormaps</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../vis/datasheet/index.html">shnitsel.vis.datasheet</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../vis/datasheet/datasheet/index.html">shnitsel.vis.datasheet.datasheet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/datasheet/datasheet_page/index.html">shnitsel.vis.datasheet.datasheet_page</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/datasheet/figures/index.html">shnitsel.vis.datasheet.figures</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../vis/plot/index.html">shnitsel.vis.plot</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../vis/plot/common/index.html">shnitsel.vis.plot.common</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/plot/filtration/index.html">shnitsel.vis.plot.filtration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/plot/kde/index.html">shnitsel.vis.plot.kde</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/plot/p3mhelpers/index.html">shnitsel.vis.plot.p3mhelpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/plot/pca_biplot/index.html">shnitsel.vis.plot.pca_biplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/plot/polychrom/index.html">shnitsel.vis.plot.polychrom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/plot/select/index.html">shnitsel.vis.plot.select</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/plot/spectra3d/index.html">shnitsel.vis.plot.spectra3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/plot/time/index.html">shnitsel.vis.plot.time</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../vis/static/index.html">shnitsel.vis.static</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../vis/static/css/index.html">shnitsel.vis.static.css</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/static/html/index.html">shnitsel.vis.static.html</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../vis/support/index.html">shnitsel.vis.support</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../vis/support/ipython_visualization/index.html">shnitsel.vis.support.ipython_visualization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/support/multi_plot/index.html">shnitsel.vis.support.multi_plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../vis/support/visualizeable/index.html">shnitsel.vis.support.visualizeable</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../vis/vmd/index.html">shnitsel.vis.vmd</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../xarray/index.html">shnitsel.xarray</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pyramids/index.html">pyramids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../messages/index.html">messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../positions/index.html">positions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../distances/index.html">distances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dihedrals/index.html">dihedrals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../molcas_opt/index.html">molcas_opt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../bla_chromophor/index.html">bla_chromophor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectory_setup/index.html">trajectory_setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../variable_flagging/index.html">variable_flagging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../generate_datasheet/index.html">generate_datasheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../convert_to_shnitsel/index.html">convert_to_shnitsel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../merge_shnitsel_files/index.html">merge_shnitsel_files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectory_verification/index.html">trajectory_verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../trajectory_finalization/index.html">trajectory_finalization</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../../index.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">shnitsel</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">shnitsel.analyze</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">shnitsel.analyze.spectra</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-shnitsel.analyze.spectra">
<span id="shnitsel-analyze-spectra"></span><h1>shnitsel.analyze.spectra<a class="headerlink" href="#module-shnitsel.analyze.spectra" title="Link to this heading">#</a></h1>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.analyze.spectra._calculate_fosc" title="shnitsel.analyze.spectra._calculate_fosc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_calculate_fosc</span></code></a>(energy_interstate, dip_trans_norm)</p></td>
<td><p>Internal function to actually calculate the oscillator frequency for energies and transition dipoles.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.analyze.spectra.calculate_fosc" title="shnitsel.analyze.spectra.calculate_fosc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_fosc</span></code></a>(energy_interstate, dip_trans_norm)</p></td>
<td><p>Function to obtain a dataarray containing the oscillator strength as a dataarray.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.analyze.spectra.get_fosc" title="shnitsel.analyze.spectra.get_fosc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fosc</span></code></a>(…)</p></td>
<td><p>Function to calculate the strength of the oscillator for state-to-state transitions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.analyze.spectra.apply_gauss_broadening" title="shnitsel.analyze.spectra.apply_gauss_broadening"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_gauss_broadening</span></code></a>(delta_E, fosc[, agg_dim, ...])</p></td>
<td><p>Applies a gaussian smoothing kernel to the fosc data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.analyze.spectra.get_fosc_gauss_broadened" title="shnitsel.analyze.spectra.get_fosc_gauss_broadened"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_fosc_gauss_broadened</span></code></a>(…)</p></td>
<td><p>Function to get the broadened spectrum of the interstate energy and oscillator strength data to plot</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.analyze.spectra.get_spectrum_at_time" title="shnitsel.analyze.spectra.get_spectrum_at_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_spectrum_at_time</span></code></a>(…)</p></td>
<td><p>Function to calculate a gaussian-smoothed spectrum of an interstate dataset at one specific point in time and for one specific state transition</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.analyze.spectra.get_spectra" title="shnitsel.analyze.spectra.get_spectra"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_spectra</span></code></a>(…)</p></td>
<td><p>Function to calculate (gauss-broadened) spectra at multiple (or all) points in time</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.analyze.spectra.get_spectra_groups" title="shnitsel.analyze.spectra.get_spectra_groups"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_spectra_groups</span></code></a>(spectra[, state_selection])</p></td>
<td><p>Group spectra results into spectra involving the ground state or only excited states.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.spectra._calculate_fosc">
<span class="sig-name descname"><span class="pre">_calculate_fosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_interstate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip_trans_norm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.spectra._calculate_fosc" title="Link to this definition">#</a></dt>
<dd><p>Internal function to actually calculate the oscillator frequency for energies and transition dipoles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy_interstate</strong> (<em>DataArray</em>) – The Array of Energies in the system.</p></li>
<li><p><strong>dip_trans_norm</strong> (<em>DataArray</em>) – The array of associated norm of transition dipoles in the system.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting oscillation frequency (f_osc) array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataArray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>We use the following unitless form of f_osc:
$$f_{osc} = frac{2}{3} frac{m_e}{hbar^2} cdot Delta E cdot frac{mu^2}{e^2}$$</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.spectra.calculate_fosc">
<span class="sig-name descname"><span class="pre">calculate_fosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy_interstate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dip_trans_norm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.spectra.calculate_fosc" title="Link to this definition">#</a></dt>
<dd><p>Function to obtain a dataarray containing the oscillator strength as a dataarray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>energy_interstate</strong> (<em>DataArray</em>) – The array of inter-state energies (delta_E) in the system.</p></li>
<li><p><strong>dip_trans_norm</strong> (<em>DataArray</em>) – The array of associated transition dipoles in the system with their norm calculated across the direction dimension.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting datarray of oscillator strength f_osc</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.spectra.get_fosc">
<span class="sig-name descname"><span class="pre">get_fosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../data/dataset_containers/trajectory/index.html#shnitsel.data.dataset_containers.trajectory.Trajectory" title="shnitsel.data.dataset_containers.trajectory.Trajectory"><span class="pre">shnitsel.data.dataset_containers.trajectory.Trajectory</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../data/dataset_containers/frames/index.html#shnitsel.data.dataset_containers.frames.Frames" title="shnitsel.data.dataset_containers.frames.Frames"><span class="pre">shnitsel.data.dataset_containers.frames.Frames</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#shnitsel.analyze.spectra.get_fosc" title="Link to this definition">#</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_fosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">shnitsel.data.tree.tree.ShnitselDB</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../data/dataset_containers/trajectory/index.html#shnitsel.data.dataset_containers.trajectory.Trajectory" title="shnitsel.data.dataset_containers.trajectory.Trajectory"><span class="pre">shnitsel.data.dataset_containers.trajectory.Trajectory</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../data/dataset_containers/frames/index.html#shnitsel.data.dataset_containers.frames.Frames" title="shnitsel.data.dataset_containers.frames.Frames"><span class="pre">shnitsel.data.dataset_containers.frames.Frames</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">shnitsel.data.tree.tree.ShnitselDB</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Function to calculate the strength of the oscillator for state-to-state transitions.</p>
<p>If provided a simple data type like a Trajectory of Frames, will extract InterState information from it.
If provided a hierarchical tree structure, will map calculation over data entries.
Uses energy delta and <cite>dip_trans_norm</cite>, i.e. the norm of the transition dipole for calculation and will only yield results if those are available.
Otherwise, the function call will fail.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.Trajectory" title="shnitsel.data.dataset_containers.Trajectory"><em>Trajectory</em></a>) – <div class="line-block">
<div class="line">Frames
| InterState
<a href="#id1"><span class="problematic" id="id2">|</span></a>TreeNode[Any, Trajectory | Frames | InterState]</div>
</div>
<p>The data from which interstate information can be deduced (transition dipoles and energy deltas).
Alternatively, the interstate information can be provided directly.
The data can also be supplied in a hierarchical tree format. In that case, the operation will be applied to data entries
in the tree structure.</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either the array of fosc values for simple input structures or the tree structure with the fosc results for individual data entries after mapping
over the tree.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray | <a class="reference internal" href="../../data/tree/index.html#shnitsel.data.tree.TreeNode" title="shnitsel.data.tree.TreeNode">TreeNode</a>[Any, <a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.Trajectory" title="shnitsel.data.dataset_containers.Trajectory">Trajectory</a> | <a class="reference internal" href="../../data/dataset_containers/frames/index.html#shnitsel.data.dataset_containers.frames.Frames" title="shnitsel.data.dataset_containers.frames.Frames">Frames</a> | <a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.InterState" title="shnitsel.data.dataset_containers.InterState">InterState</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.spectra.apply_gauss_broadening">
<span class="sig-name descname"><span class="pre">apply_gauss_broadening</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta_E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fosc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_in_eV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_energy_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.spectra.apply_gauss_broadening" title="Link to this definition">#</a></dt>
<dd><p>Applies a gaussian smoothing kernel to the fosc data.</p>
<p>Aggregation is performed along the <cite>agg_dim</cite> dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta_E</strong> (<em>xr.DataArray</em>) – Values used for the x-axis, presumably $E_i$</p></li>
<li><p><strong>fosc</strong> (<em>xr.DataArray</em>) – Values used for the y-axis, presumably $f_mathrm{osc}$</p></li>
<li><p><strong>agg_dim</strong> (<em>DimName</em><em>, </em><em>optional</em>) – Dimension along which to aggregate the many Gaussian distributions,
by default None, which means, no automatic mean calculation is applied.</p></li>
<li><p><strong>width_in_eV</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – the width of the Gaussian distributions used, by default 0.5 eV</p></li>
<li><p><strong>nsamples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – number of evenly spaced x-values over which to sample the distribution,
by default 1000</p></li>
<li><p><strong>max_energy_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – The minimum x-value used for the energy-spectrum, by default 0.0</p></li>
<li><p><strong>max_energy_range</strong> – the maximum x-value, by default 3 standard deviations
beyond the pre-broadened maximum</p></li>
<li><p><strong>min_energy_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)">xarray.DataArray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.spectra.get_fosc_gauss_broadened">
<span class="sig-name descname"><span class="pre">get_fosc_gauss_broadened</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interstate_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../data/dataset_containers/trajectory/index.html#shnitsel.data.dataset_containers.trajectory.Trajectory" title="shnitsel.data.dataset_containers.trajectory.Trajectory"><span class="pre">shnitsel.data.dataset_containers.trajectory.Trajectory</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../data/dataset_containers/frames/index.html#shnitsel.data.dataset_containers.frames.Frames" title="shnitsel.data.dataset_containers.frames.Frames"><span class="pre">shnitsel.data.dataset_containers.frames.Frames</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_in_eV</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_energy_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a></span></span><a class="headerlink" href="#shnitsel.analyze.spectra.get_fosc_gauss_broadened" title="Link to this definition">#</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_fosc_gauss_broadened</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interstate_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">shnitsel.data.tree.tree.ShnitselDB</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../data/dataset_containers/trajectory/index.html#shnitsel.data.dataset_containers.trajectory.Trajectory" title="shnitsel.data.dataset_containers.trajectory.Trajectory"><span class="pre">shnitsel.data.dataset_containers.trajectory.Trajectory</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference internal" href="../../data/dataset_containers/frames/index.html#shnitsel.data.dataset_containers.frames.Frames" title="shnitsel.data.dataset_containers.frames.Frames"><span class="pre">shnitsel.data.dataset_containers.frames.Frames</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width_in_eV</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_energy_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">shnitsel.data.tree.tree.ShnitselDB</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Function to get the broadened spectrum of the interstate energy and oscillator strength data to plot
a nice and smooth spectrum.</p>
<p>Width of the smoothing kernel is given in eV and the energy is assumed to be in eV or will be converted to eV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interstate_data_source</strong> (<a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.InterState" title="shnitsel.data.dataset_containers.InterState"><em>InterState</em></a><em> | </em><a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.Trajectory" title="shnitsel.data.dataset_containers.Trajectory"><em>Trajectory</em></a><em> | </em><a class="reference internal" href="../../data/dataset_containers/frames/index.html#shnitsel.data.dataset_containers.frames.Frames" title="shnitsel.data.dataset_containers.frames.Frames"><em>Frames</em></a><em> | </em><em>xr.Dataset</em><em> | </em><a class="reference internal" href="../../data/tree/index.html#shnitsel.data.tree.TreeNode" title="shnitsel.data.tree.TreeNode"><em>TreeNode</em></a><em>[</em><em>Any</em><em>, </em><a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.InterState" title="shnitsel.data.dataset_containers.InterState"><em>InterState</em></a><em>  |  </em><a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.Trajectory" title="shnitsel.data.dataset_containers.Trajectory"><em>Trajectory</em></a><em>  |  </em><a class="reference internal" href="../../data/dataset_containers/frames/index.html#shnitsel.data.dataset_containers.frames.Frames" title="shnitsel.data.dataset_containers.frames.Frames"><em>Frames</em></a><em>  |  </em><em>xr.Dataset</em><em>]</em>) – <dl class="simple">
<dt>Interstate dataset or source for such data with <cite>energy_interstate</cite> and <cite>fosc</cite> information.</dt><dd><p>If provided as Frames or Trajectory, must provide <cite>energy</cite> and <cite>dip_trans</cite> data.
If provided as tree, operation will be mapped over data.</p>
</dd>
</dl>
</p></li>
<li><p><strong>width_in_eV</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Width of the gaussian smoothing kernel in eV, by default 0.5</p></li>
<li><p><strong>nsamples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>) – Number of samples/steps in the range of the energy spectrum, by default 1000</p></li>
<li><p><strong>max_energy_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>) – Maximum of the energy range to consider for the spectrum, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting broadened spectrum statistics either of the dataset input or mapped over the entire input tree</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray | <a class="reference internal" href="../../data/tree/index.html#shnitsel.data.tree.TreeNode" title="shnitsel.data.tree.TreeNode">TreeNode</a>[Any, xr.DataArray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.spectra.get_spectrum_at_time">
<span class="sig-name descname"><span class="pre">get_spectrum_at_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interstate_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">shnitsel.data.tree.tree.ShnitselDB</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">shnitsel.core.typedefs.StateCombination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">shnitsel.data.tree.tree.ShnitselDB</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#shnitsel.analyze.spectra.get_spectrum_at_time" title="Link to this definition">#</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_spectrum_at_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interstate_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">shnitsel.core.typedefs.StateCombination</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2026.1.0)"><span class="pre">xarray.DataArray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span></dt>
<dd><p>Function to calculate a gaussian-smoothed spectrum of an interstate dataset at one specific point in time and for one specific state transition</p>
<p>_extended_summary_</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interstate_data</strong> (<a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.InterState" title="shnitsel.data.dataset_containers.InterState"><em>InterState</em></a><em> | </em><em>xr.Dataset</em><em> | </em><em>Sequence</em><em>[</em><a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.InterState" title="shnitsel.data.dataset_containers.InterState"><em>InterState</em></a><em> | </em><em>xr.Dataset</em><em> ] </em><em>| </em><a class="reference internal" href="../../data/tree/index.html#shnitsel.data.tree.TreeNode" title="shnitsel.data.tree.TreeNode"><em>TreeNode</em></a><em>[</em><em>Any</em><em>, </em><a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.InterState" title="shnitsel.data.dataset_containers.InterState"><em>InterState</em></a><em> | </em><em>xr.Dataset</em><em>]</em>) – An InterState dataset with fosc and energy data.
Alternatively, a sequence of Interstate data or a hierarchical set of interstate data.</p></li>
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The time at which to evaluate the spectrum</p></li>
<li><p><strong>sc</strong> (<em>StateCombination</em>) – State combination identifier. Provided as a tuple <code class="docutils literal notranslate"><span class="pre">(from,</span> <span class="pre">to)</span></code> of state indices.</p></li>
<li><p><strong>rel_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Relative cutoff threshold. Values below the max of the resulting spectrum times this scale will be ignored, by default 0.01</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>xr.DataArray</em> – The Gauss-broadened spectrum of the provided <cite>data</cite> system.
If broadening across trajectories could not be performed, just returns the fosc array.
If a sequence of interstate data was provided, aggregation will be performed across
the spectra of the different datasets.</p></li>
<li><p><em>TreeNode[Any, xr.DataArray]</em> – Hierarchically mapped data, where spectrum calculation was performed across flat groups.
If a hierarchical tree set was provided, the data will be grouped and aggregation performed across the spectra of data within the same group</p></li>
<li><p><em>None</em> – If the spectrum could not be calculated for whatever reason. Most likely due to missing data for the spectrum calculation.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – Unsupported type provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.spectra.get_spectra">
<span class="sig-name descname"><span class="pre">get_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interstate_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../filtering/state_selection/index.html#shnitsel.filtering.state_selection.StateSelection" title="shnitsel.filtering.state_selection.StateSelection"><span class="pre">shnitsel.filtering.state_selection.StateSelection</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">shnitsel.core.typedefs.SpectraDictType</span></span></span><a class="headerlink" href="#shnitsel.analyze.spectra.get_spectra" title="Link to this definition">#</a></dt>
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">get_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interstate_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">shnitsel.data.tree.tree.ShnitselDB</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../data/dataset_containers/inter_state/index.html#shnitsel.data.dataset_containers.inter_state.InterState" title="shnitsel.data.dataset_containers.inter_state.InterState"><span class="pre">shnitsel.data.dataset_containers.inter_state.InterState</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2026.1.0)"><span class="pre">xarray.Dataset</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../../filtering/state_selection/index.html#shnitsel.filtering.state_selection.StateSelection" title="shnitsel.filtering.state_selection.StateSelection"><span class="pre">shnitsel.filtering.state_selection.StateSelection</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'all'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rel_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">shnitsel.data.tree.tree.ShnitselDB</span><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.SpectraDictType</span><span class="p"><span class="pre">]</span></span></span></span></dt>
<dd><p>Function to calculate (gauss-broadened) spectra at multiple (or all) points in time</p>
<p>Uses strength of oscillator (<cite>fosc</cite>) and energy deltas (<cite>energy_interstate</cite>) to calculate
a smoothened spectrum across the energy phase space.
The times at which the spectrum is calculated and the list of state transitions to consider
can be controlled via the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>interstate</strong> (<a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.InterState" title="shnitsel.data.dataset_containers.InterState"><em>InterState</em></a><em> | </em><em>xr.Dataset</em><em> | </em><em>Sequence</em><em>[</em><a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.InterState" title="shnitsel.data.dataset_containers.InterState"><em>InterState</em></a><em> | </em><em>xr.Dataset</em><em>] </em><em>| </em><a class="reference internal" href="../../data/tree/index.html#shnitsel.data.tree.TreeNode" title="shnitsel.data.tree.TreeNode"><em>TreeNode</em></a><em>[</em><em>Any</em><em>, </em><a class="reference internal" href="../../data/dataset_containers/index.html#shnitsel.data.dataset_containers.InterState" title="shnitsel.data.dataset_containers.InterState"><em>InterState</em></a><em> | </em><em>xr.Dataset</em><em>]</em>) – The data source for interstate data that needs to provide interstate energy differenses and fosc data,
which can be derived from <cite>energy_interstate</cite> and <cite>dip_trans</cite>.
If the necessary data is not provided, an error will be raised.
If a sequence is provided, state selection defaults will be generated from the first data set in the selection.
If a hierarchical tree is provided, data will be grouped and the spectra calculation will be mapped over
the data within each group.</p></li>
<li><p><strong>state_selection</strong> (<a class="reference internal" href="../../filtering/index.html#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection"><em>StateSelection</em></a><em>, </em><em>optional</em>) – State combination selection provided either as a <cite>StateSelection</cite> instance or, by default will consider all state combinations.</p></li>
<li><p><strong>times</strong> (<em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>] </em><em>| </em><em>Literal</em><em>[</em><em>'all'</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – Specific times at which the spectrum should be calculated or <cite>all</cite> if the spectrum should be extracted at all times, by default None, which means that
a set of times will be chosen automatically. (Note: will currently be initialized as [0,10,20,30] in arbitrary time units)</p></li>
<li><p><strong>rel_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Factor for the cutoff of broadened/smoothened spectrum relative to maximum to be considered, by default 0.01</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – Unsupported type provided.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>SpectraDictType</em> – The resulting spectrum as a mapping from <cite>(t,sc)</cite> pairs to the resulting, broadened spectrum.
The first item in the key is the time at which the spectrum was extracted.
The second item is the state combination descriptor for which it was calculated.</p></li>
<li><p><em>TreeNode[Any, SpectraDictType]</em> – If a hierarchical input is provided, the spectra results will be provided in hierarchical structure with one result for every grouped set of data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.analyze.spectra.get_spectra_groups">
<span class="sig-name descname"><span class="pre">get_spectra_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.analyze.spectra.get_spectra_groups" title="Link to this definition">#</a></dt>
<dd><p>Group spectra results into spectra involving the ground state or only excited states.</p>
<p>_extended_summary_</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spectra</strong> (<em>SpectraDictType</em>) – The Spectral calculation results, e.g. from <cite>calc_spectra()</cite>. Indexed by (timestep, state_combination) and yielding the associated spectrum.</p></li>
<li><p><strong>state_selection</strong> (<a class="reference internal" href="../../filtering/index.html#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection"><em>StateSelection</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>) – The selection of states to consider as ground and active states, by default None.
If not provided, all state transitions with state ids above 1 will be considered <cite>excited</cite> all others <cite>ground</cite> state transitions.
If provided, the excited state combinations will be extracted using <cite>state_selection.excited_state_transitions()</cite> with default parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>First the spectra involving the ground state
Second the spectra involving only excited states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a>[ SpectraDictType, SpectraDictType]</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../populations/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">shnitsel.analyze.populations</p>
      </div>
    </a>
    <a class="right-next"
       href="../stats/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">shnitsel.analyze.stats</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.analyze.spectra._calculate_fosc"><code class="docutils literal notranslate"><span class="pre">_calculate_fosc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.analyze.spectra.calculate_fosc"><code class="docutils literal notranslate"><span class="pre">calculate_fosc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.analyze.spectra.get_fosc"><code class="docutils literal notranslate"><span class="pre">get_fosc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.analyze.spectra.apply_gauss_broadening"><code class="docutils literal notranslate"><span class="pre">apply_gauss_broadening()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.analyze.spectra.get_fosc_gauss_broadened"><code class="docutils literal notranslate"><span class="pre">get_fosc_gauss_broadened()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.analyze.spectra.get_spectrum_at_time"><code class="docutils literal notranslate"><span class="pre">get_spectrum_at_time()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.analyze.spectra.get_spectra"><code class="docutils literal notranslate"><span class="pre">get_spectra()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.analyze.spectra.get_spectra_groups"><code class="docutils literal notranslate"><span class="pre">get_spectra_groups()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/api/shnitsel/analyze/spectra/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2026, Kevin Höllring, Theodor Everley Röhrkasten, Carolin Müller.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>