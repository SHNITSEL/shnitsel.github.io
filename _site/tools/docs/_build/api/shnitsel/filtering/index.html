
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>shnitsel.filtering &#8212; shnitsel-tools 2026.01.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=06dcdba1"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/shnitsel/filtering/index';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="shnitsel.filtering.helpers" href="helpers/index.html" />
    <link rel="prev" title="shnitsel.data.xr_io_registry" href="../data/xr_io_registry/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">shnitsel-tools 2026.01.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../top-level.html">
    Top-level functions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../accessors/ds_accessors.html">
    Dataset accessor methods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../accessors/da_accessors.html">
    DataArray accessor methods
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../tutorials.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../top-level.html">
    Top-level functions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../accessors/ds_accessors.html">
    Dataset accessor methods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../accessors/da_accessors.html">
    DataArray accessor methods
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../tutorials.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../angles/index.html">angles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algebra/index.html">algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../helpers/index.html">helpers</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">shnitsel</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../_accessors/index.html">shnitsel._accessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_contracts/index.html">shnitsel._contracts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_generated_accessors/index.html">shnitsel._generated_accessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_state/index.html">shnitsel._state</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../analyze/index.html">shnitsel.analyze</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../analyze/generic/index.html">shnitsel.analyze.generic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analyze/hops/index.html">shnitsel.analyze.hops</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analyze/lda/index.html">shnitsel.analyze.lda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analyze/pca/index.html">shnitsel.analyze.pca</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analyze/pls/index.html">shnitsel.analyze.pls</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analyze/populations/index.html">shnitsel.analyze.populations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analyze/spectra/index.html">shnitsel.analyze.spectra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../analyze/stats/index.html">shnitsel.analyze.stats</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../bridges/index.html">shnitsel.bridges</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../clean/index.html">shnitsel.clean</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../clean/common/index.html">shnitsel.clean.common</a></li>
<li class="toctree-l3"><a class="reference internal" href="../clean/dispatch_plots/index.html">shnitsel.clean.dispatch_plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../clean/filter_energy/index.html">shnitsel.clean.filter_energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../clean/filter_geo/index.html">shnitsel.clean.filter_geo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../clean/filtration_class/index.html">shnitsel.clean.filtration_class</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../core/index.html">shnitsel.core</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../core/_api_info/index.html">shnitsel.core._api_info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/feature_detection/index.html">shnitsel.core.feature_detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core/typedefs/index.html">shnitsel.core.typedefs</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../data/index.html">shnitsel.data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../data/atom_helpers/index.html">shnitsel.data.atom_helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/charge_helpers/index.html">shnitsel.data.charge_helpers</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../data/dataset_containers/index.html">shnitsel.data.dataset_containers</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/data_series/index.html">shnitsel.data.dataset_containers.data_series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/dataset_vis/index.html">shnitsel.data.dataset_containers.dataset_vis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/frames/index.html">shnitsel.data.dataset_containers.frames</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/inter_state/index.html">shnitsel.data.dataset_containers.inter_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/multi_layered/index.html">shnitsel.data.dataset_containers.multi_layered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/multi_series/index.html">shnitsel.data.dataset_containers.multi_series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/multi_stacked/index.html">shnitsel.data.dataset_containers.multi_stacked</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/per_state/index.html">shnitsel.data.dataset_containers.per_state</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/shared/index.html">shnitsel.data.dataset_containers.shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/trajectory/index.html">shnitsel.data.dataset_containers.trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/trajectory_collection/index.html">shnitsel.data.dataset_containers.trajectory_collection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/dataset_containers/xr_conversion/index.html">shnitsel.data.dataset_containers.xr_conversion</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../data/helpers/index.html">shnitsel.data.helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/multi_indices/index.html">shnitsel.data.multi_indices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/proxy_class/index.html">shnitsel.data.proxy_class</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../data/shnitsel_db/index.html">shnitsel.data.shnitsel_db</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/shnitsel_db/db_function_decorator/index.html">shnitsel.data.shnitsel_db.db_function_decorator</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../data/shnitsel_db_helpers/index.html">shnitsel.data.shnitsel_db_helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/state_helpers/index.html">shnitsel.data.state_helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/traj_combiner_methods/index.html">shnitsel.data.traj_combiner_methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/trajectory_grouping_params/index.html">shnitsel.data.trajectory_grouping_params</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/trajectory_variable_description/index.html">shnitsel.data.trajectory_variable_description</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../data/tree/index.html">shnitsel.data.tree</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/child_support_functions/index.html">shnitsel.data.tree.child_support_functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/compound/index.html">shnitsel.data.tree.compound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/data_group/index.html">shnitsel.data.tree.data_group</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/data_leaf/index.html">shnitsel.data.tree.data_leaf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/datatree_level/index.html">shnitsel.data.tree.datatree_level</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/node/index.html">shnitsel.data.tree.node</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/selection/index.html">shnitsel.data.tree.selection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/support_functions/index.html">shnitsel.data.tree.support_functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/tree/index.html">shnitsel.data.tree.tree</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/tree_completion/index.html">shnitsel.data.tree.tree_completion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/tree_vis/index.html">shnitsel.data.tree.tree_vis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../data/tree/xr_conversion/index.html">shnitsel.data.tree.xr_conversion</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../data/xr_io_compatibility/index.html">shnitsel.data.xr_io_compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/xr_io_registry/index.html">shnitsel.data.xr_io_registry</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="current reference internal" href="#">shnitsel.filtering</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="helpers/index.html">shnitsel.filtering.helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="state_selection/index.html">shnitsel.filtering.state_selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="structure_selection/index.html">shnitsel.filtering.structure_selection</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../geo/index.html">shnitsel.geo</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../geo/alignment/index.html">shnitsel.geo.alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geo/analogs/index.html">shnitsel.geo.analogs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../geo/geocalc/index.html">shnitsel.geo.geocalc</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../io/index.html">shnitsel.io</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../io/ase/index.html">shnitsel.io.ase</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../io/ase/format_reader/index.html">shnitsel.io.ase.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../io/ase/parse/index.html">shnitsel.io.ase.parse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../io/ase/write/index.html">shnitsel.io.ase.write</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../io/format_reader_base/index.html">shnitsel.io.format_reader_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../io/format_registry/index.html">shnitsel.io.format_registry</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../io/newtonx/index.html">shnitsel.io.newtonx</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../io/newtonx/format_reader/index.html">shnitsel.io.newtonx.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../io/newtonx/parse/index.html">shnitsel.io.newtonx.parse</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../io/pyrai2md/index.html">shnitsel.io.pyrai2md</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../io/pyrai2md/format_reader/index.html">shnitsel.io.pyrai2md.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../io/pyrai2md/parse/index.html">shnitsel.io.pyrai2md.parse</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../io/read/index.html">shnitsel.io.read</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../io/sharc/index.html">shnitsel.io.sharc</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../io/sharc/format_reader/index.html">shnitsel.io.sharc.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../io/sharc/parse_initial_conditions/index.html">shnitsel.io.sharc.parse_initial_conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../io/sharc/parse_trajectory/index.html">shnitsel.io.sharc.parse_trajectory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../io/sharc/qm_helpers/index.html">shnitsel.io.sharc.qm_helpers</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../io/shnitsel/index.html">shnitsel.io.shnitsel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../io/shnitsel/format_reader/index.html">shnitsel.io.shnitsel.format_reader</a></li>
<li class="toctree-l4"><a class="reference internal" href="../io/shnitsel/parse/index.html">shnitsel.io.shnitsel.parse</a></li>
<li class="toctree-l4"><a class="reference internal" href="../io/shnitsel/write/index.html">shnitsel.io.shnitsel.write</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../io/xyz/index.html">shnitsel.io.xyz</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../io/xyz/parse/index.html">shnitsel.io.xyz.parse</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../rd/index.html">shnitsel.rd</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../units/index.html">shnitsel.units</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../units/conversion/index.html">shnitsel.units.conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../units/defaults/index.html">shnitsel.units.defaults</a></li>
<li class="toctree-l3"><a class="reference internal" href="../units/definitions/index.html">shnitsel.units.definitions</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../vis/index.html">shnitsel.vis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../vis/colormaps/index.html">shnitsel.vis.colormaps</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../vis/datasheet/index.html">shnitsel.vis.datasheet</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../vis/datasheet/datasheet/index.html">shnitsel.vis.datasheet.datasheet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/datasheet/datasheet_page/index.html">shnitsel.vis.datasheet.datasheet_page</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/datasheet/figures/index.html">shnitsel.vis.datasheet.figures</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../vis/plot/index.html">shnitsel.vis.plot</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../vis/plot/common/index.html">shnitsel.vis.plot.common</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/plot/filtration/index.html">shnitsel.vis.plot.filtration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/plot/kde/index.html">shnitsel.vis.plot.kde</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/plot/p3mhelpers/index.html">shnitsel.vis.plot.p3mhelpers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/plot/pca_biplot/index.html">shnitsel.vis.plot.pca_biplot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/plot/polychrom/index.html">shnitsel.vis.plot.polychrom</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/plot/select/index.html">shnitsel.vis.plot.select</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/plot/spectra3d/index.html">shnitsel.vis.plot.spectra3d</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/plot/time/index.html">shnitsel.vis.plot.time</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../vis/static/index.html">shnitsel.vis.static</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../vis/static/css/index.html">shnitsel.vis.static.css</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/static/html/index.html">shnitsel.vis.static.html</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../vis/support/index.html">shnitsel.vis.support</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../vis/support/ipython_visualization/index.html">shnitsel.vis.support.ipython_visualization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/support/multi_plot/index.html">shnitsel.vis.support.multi_plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vis/support/visualizeable/index.html">shnitsel.vis.support.visualizeable</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../vis/vmd/index.html">shnitsel.vis.vmd</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../xarray/index.html">shnitsel.xarray</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../pyramids/index.html">pyramids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../messages/index.html">messages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../positions/index.html">positions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../distances/index.html">distances</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dihedrals/index.html">dihedrals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../molcas_opt/index.html">molcas_opt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bla_chromophor/index.html">bla_chromophor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectory_setup/index.html">trajectory_setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../variable_flagging/index.html">variable_flagging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../generate_datasheet/index.html">generate_datasheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../convert_to_shnitsel/index.html">convert_to_shnitsel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../merge_shnitsel_files/index.html">merge_shnitsel_files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectory_verification/index.html">trajectory_verification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trajectory_finalization/index.html">trajectory_finalization</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">API Reference</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">shnitsel</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">shnitsel.filtering</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-shnitsel.filtering">
<span id="shnitsel-filtering"></span><h1>shnitsel.filtering<a class="headerlink" href="#module-shnitsel.filtering" title="Link to this heading">#</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="helpers/index.html">shnitsel.filtering.helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="state_selection/index.html">shnitsel.filtering.state_selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure_selection/index.html">shnitsel.filtering.structure_selection</a></li>
</ul>
</div>
</section>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.filtering.FeatureDescriptor" title="shnitsel.filtering.FeatureDescriptor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FeatureDescriptor</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.filtering.StructureSelectionDescriptor" title="shnitsel.filtering.StructureSelectionDescriptor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StructureSelectionDescriptor</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.filtering.StateCombination" title="shnitsel.filtering.StateCombination"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateCombination</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.filtering.StateId" title="shnitsel.filtering.StateId"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateId</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.filtering.StateSelectionDescriptor" title="shnitsel.filtering.StateSelectionDescriptor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateSelectionDescriptor</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StructureSelection</span></code></a></p></td>
<td><p>Class to keep track of a (sub-)selection of structural features.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StateSelection</span></code></a></p></td>
<td><p>Class to keep track of a (sub-)selection of states and state transitions for analysis and plotting.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StructureSelection</span></span><a class="headerlink" href="#shnitsel.filtering.StructureSelection" title="Link to this definition">#</a></dt>
<dd><p>Class to keep track of a (sub-)selection of structural features.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.mol">
<span class="sig-name descname"><span class="pre">mol</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">rdkit.Chem.rdchem.Mol</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.mol" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.atoms">
<span class="sig-name descname"><span class="pre">atoms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AtomDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.atoms" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.atoms_types">
<span class="sig-name descname"><span class="pre">atoms_types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AtomDescriptor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.atoms_types" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.atoms_selected">
<span class="sig-name descname"><span class="pre">atoms_selected</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AtomDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.atoms_selected" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.bonds">
<span class="sig-name descname"><span class="pre">bonds</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">BondDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.bonds" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.bonds_types">
<span class="sig-name descname"><span class="pre">bonds_types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">BondDescriptor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.bonds_types" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.bonds_selected">
<span class="sig-name descname"><span class="pre">bonds_selected</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">BondDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.bonds_selected" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.angles">
<span class="sig-name descname"><span class="pre">angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AngleDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.angles" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.angles_types">
<span class="sig-name descname"><span class="pre">angles_types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AngleDescriptor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.angles_types" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.angles_selected">
<span class="sig-name descname"><span class="pre">angles_selected</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">AngleDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.angles_selected" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.dihedrals">
<span class="sig-name descname"><span class="pre">dihedrals</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">DihedralDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.dihedrals" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.dihedrals_types">
<span class="sig-name descname"><span class="pre">dihedrals_types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">DihedralDescriptor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.dihedrals_types" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.dihedrals_selected">
<span class="sig-name descname"><span class="pre">dihedrals_selected</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">DihedralDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.dihedrals_selected" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.pyramids">
<span class="sig-name descname"><span class="pre">pyramids</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">PyramidsDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.pyramids" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.pyramids_types">
<span class="sig-name descname"><span class="pre">pyramids_types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">PyramidsDescriptor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.pyramids_types" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.pyramids_selected">
<span class="sig-name descname"><span class="pre">pyramids_selected</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><span class="pre">PyramidsDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.pyramids_selected" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.feature_level_colors">
<span class="sig-name descname"><span class="pre">feature_level_colors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">FeatureLevelType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelection.feature_level_colors" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.copy_or_update">
<span class="sig-name descname"><span class="pre">copy_or_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_selected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_selected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles_selected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedrals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedrals_selected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedrals_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyramids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyramids_selected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyramids_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.copy_or_update" title="Link to this definition">#</a></dt>
<dd><p>Function to create a copy with replaced member values.</p>
<p>Meant as a helper for the <cite>Frozen</cite> logic of the selection, i.e. method calls return a new instance
instead of updating the existing instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em><em> | </em><em>None</em><em>, </em><em>optional</em>)  The new RDKit Mol object to assign to this selection. Should usually not be updated, but can be for completeness. Defaults to None.</p></li>
<li><p><strong>atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  New indices of atoms. Defaults to None.</p></li>
<li><p><strong>atoms_selected</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  New indices of selected atoms. Defaults to None.</p></li>
<li><p><strong>atoms_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>AtomDescriptor</em><em>, </em><em>optional</em>)  New metadata dict for atom indices. Defaults to None.</p></li>
<li><p><strong>bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>BondDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Bond indices set. Defaults to None.</p></li>
<li><p><strong>bonds_selected</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>BondDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Set of bond indices that have been selected. Defaults to None.</p></li>
<li><p><strong>bonds_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>BondDescriptor</em><em>, </em><em>optional</em>)  Dict with metadata for the bonds. Defaults to None.</p></li>
<li><p><strong>angles</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>AngleDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Set of all indices of angles. Defaults to None.</p></li>
<li><p><strong>angles_selected</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>AngleDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Set of selected indices of angles. Defaults to None.</p></li>
<li><p><strong>angles_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>AngleDescriptor</em><em>, </em><em>optional</em>)  Dict with metadata about the angles. Defaults to None.</p></li>
<li><p><strong>dihedrals</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>DihedralDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Set of all indices of dihedrals in the structure. Defaults to None.</p></li>
<li><p><strong>dihedrals_selected</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>DihedralDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Set of selected indices of dihedrals. Defaults to None.</p></li>
<li><p><strong>dihedrals_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>DihedralDescriptor</em><em>, </em><em>optional</em>)  Dict with metadata about dihedrals. Defaults to None.</p></li>
<li><p><strong>pyramids</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>PyramidsDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Set of all indices of pyramids in the structure. Defaults to None.</p></li>
<li><p><strong>pyramids_selected</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><em>set</em></a><em>[</em><em>PyramidsDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Set of selected indices of pyramids. Defaults to None.</p></li>
<li><p><strong>pyramids_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>PyramidsDescriptor</em><em>, </em><em>optional</em>)  Dict with metadata about pyramids. Defaults to None.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag to allow for in-place updates instead of returning a new cop. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The selection update with the new members set. Can either be a copy if <cite>inplace=False</cite> or the old instance with updated members otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.init_from_dataset">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_from_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['atoms',</span> <span class="pre">'bonds']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to2D</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.init_from_dataset" title="Link to this definition">#</a></dt>
<dd><p>Alternative constructor that creates an initial StructureSelection object from a dataset using the entire structural information in it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><em>type</em></a><em>[</em><em>Self</em><em>]</em>)  The type of this StructureSelection so that we can create instances of it.</p></li>
<li><p><strong>frame</strong> (<em>xr.Dataset</em><em> | </em><a class="reference internal" href="../data/dataset_containers/index.html#shnitsel.data.dataset_containers.ShnitselDataset" title="shnitsel.data.dataset_containers.ShnitselDataset"><em>ShnitselDataset</em></a>)  The dataset (optionally a single frame) to extract the structure information out of.
Must have at least <cite>atXYZ</cite> variable and a <cite>atom</cite> dimension.
Ideally, an <cite>atom</cite> coordinate for feature selection is also provided.
If multiple frames/timesteps are present within the data, a best-effort guess of a suitable frame from the data will be made.</p></li>
<li><p><strong>default_selection</strong> (<em>Sequence</em><em>[</em><em>FeatureLevelOptions</em><em>]</em><em>, </em><em>optional</em>)  List of features to activate as selected by default. Defaults to [ atoms, bonds, ].</p></li>
<li><p><strong>to2D</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag to control whether a mol representation is converted to a 2d projection before use for visualization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A structure selection object initially covering all atoms and structural features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If no structural information could be extracted from the dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.init_from_mol">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_from_mol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['atoms',</span> <span class="pre">'bonds']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.init_from_mol" title="Link to this definition">#</a></dt>
<dd><p>Alternative constructor that creates an initial StructureSelection object from an RDKit Mol object</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><em>type</em></a><em>[</em><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection"><em>StructureSelection</em></a><em>]</em>)  The type of this StructureSelection so that we can create instances of it.</p></li>
<li><p><strong>mol</strong> (<em>rdkit.rdchem.Mol</em>)  The RDKit Mol object to extract all initial structural information out of</p></li>
<li><p><strong>default_selection</strong> (<em>Sequence</em><em>[</em><em>FeatureLevelOptions</em><em>]</em><em>, </em><em>optional</em>)  List of features to activate as selected by default. Defaults to [ atoms, bonds, ].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A structure selection object initially covering all atoms and structural features.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If no structural information could be extracted from the dataset.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.derive_other_from_descriptor">
<span class="sig-name descname"><span class="pre">derive_other_from_descriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">descriptor_or_selection</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.derive_other_from_descriptor" title="Link to this definition">#</a></dt>
<dd><p>Helper function to create another structure selection based on a <cite>StructureSelectionDescriptor</cite></p>
<p>If the descriptor if already a selection, just return it.
If the descriptor needs to be applied based on the current selection, construct the other selection
and return the resulting selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>descriptor_or_selection</strong> (<a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection"><em>StructureSelection</em></a><em> | </em><em>StructureSelectionDescriptor</em>)  Either a complete selection or a set of descriptors to derive the new selection from the old one.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The derived <cite>other</cite> selection or <cite>None</cite> if not enough information was provided.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.only">
<span class="sig-name descname"><span class="pre">only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.only" title="Link to this definition">#</a></dt>
<dd><p>Only retain the selected features of the specified feature levels.</p>
<p>E.g. selection.only(bonds) yields a selection where only bonds are selected as according to the previous selection.
All selections for features not in <cite>feature_level</cite> will be set to an empty selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_level</strong> (<em>FeatureLevelOptions</em><em> | </em><em>Sequence</em><em>[</em><em>FeatureLevelOptions</em><em>] </em><em>| </em><em>None</em>)  The desired feature levels to retain in the resulting selection. If set to <cite>None</cite>, all selections will be cleared.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to update the selection in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The selection where only the chosen feature levels are still active.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_all">
<span class="sig-name descname"><span class="pre">select_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">FEATURE_LEVELS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_all" title="Link to this definition">#</a></dt>
<dd><p>Helper function to set all entries of a certain feature level to selected.</p>
<p>By default marks all features as selected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_level</strong> (<em>FeatureLevelOptions</em><em> | </em><em>Sequence</em><em>[</em><em>FeatureLevelOptions</em><em>]</em><em>, </em><em>optional</em>)  The set of feature levels to mark as within the selection. Defaults to all FEATURE_LEVELS.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to update the selection in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_atoms">
<span class="sig-name descname"><span class="pre">select_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smarts_or_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_atoms" title="Link to this definition">#</a></dt>
<dd><p>Select all atoms covered either by the smarts string(s) provided in <cite>smarts_or_selection</cite> or by either a single or multiple atom ids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smarts_or_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] </em><em>| </em><em>AtomDescriptor</em><em> | </em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either one or multiple smart strings or a single or sequence of atom ids. Defaults to None meaning all atoms will be selected.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to update the selection in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If <cite>self.mol</cite> is not set and SMARTS matching is attempted.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_atoms_idx">
<span class="sig-name descname"><span class="pre">select_atoms_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_atoms_idx" title="Link to this definition">#</a></dt>
<dd><p>Function to update the selection of atoms by specifying atom indices directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>AtomDescriptor</em><em> | </em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either a single atom selector or a sequence of atom selectors. Defaults to None, which means that all available atoms will be considered.</p></li>
<li><p><strong>extend_selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If set to True, the selection will be extended by the atoms denoted by <cite>selection</cite>. Otherwise, the new selection will be the intersection between the old selection and <cite>selection</cite>. Defaults to False.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to update this selection in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_bonds">
<span class="sig-name descname"><span class="pre">select_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_bonds" title="Link to this definition">#</a></dt>
<dd><p>Restrict the current selection of bonds by either specifying a SMARTS string (or sequence thereof) to specify substructures of
the molecule to consider bonds in, or by providing one or more bond desciptor tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] </em><em>| </em><em>BondDescriptor</em><em> | </em><em>Sequence</em><em>[</em><em>BondDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  The criterion or criteria by which to retain bonds in the selection.
Defaults to None meaning that all bonds will be added back into the selection.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to update the selection in-place or return an updated copy. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If no <cite>self.mol</cite> object is set and a SMARTS match is attempted</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_bonds_idx">
<span class="sig-name descname"><span class="pre">select_bonds_idx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_bonds_idx" title="Link to this definition">#</a></dt>
<dd><p>Helper function to select bonds by specifying the explicit Bond descriptors/tuples.</p>
<p>Restricts the selection further to this set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<em>BondDescriptor</em><em> | </em><em>Sequence</em><em>[</em><em>BondDescriptor</em><em>]</em>)  Either an individual bond selector or a sequence of bonds to select.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selections</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_pw_dists">
<span class="sig-name descname"><span class="pre">select_pw_dists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selected_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_pw_dists" title="Link to this definition">#</a></dt>
<dd><p>Helper function to select all pairwise distances between atoms in the current selection, even if they are outside of our bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selected_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether only pairwise distances in the selected atoms should be considered, by default True.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_bonds_by_atoms">
<span class="sig-name descname"><span class="pre">select_bonds_by_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_bonds_by_atoms" title="Link to this definition">#</a></dt>
<dd><p>Helper function to select bonds by specifying a subset of atoms to consider for bonds between them.</p>
<p>Allows provision of a single list of atoms or multiple such lists and will iterate over them as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either a single set of atoms to keep bonds between or multiple sets within which the bonds should be kept. Defaults to None.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection._new_bond_selection_from_atoms">
<span class="sig-name descname"><span class="pre">_new_bond_selection_from_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consider_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection._new_bond_selection_from_atoms" title="Link to this definition">#</a></dt>
<dd><p>Internal helper to get bond selection instead of directly updating the selection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either a single set of atoms to keep bonds between or multiple sets within which the bonds should be kept. Defaults to None.</p></li>
<li><p><strong>consider_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to use the entire set of features in the whole molecule as basis or just the selected set. Defaults to using only the currently selected set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The set of bond descriptors in current selection fully covered by these atoms</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)">set</a>[BondDescriptor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_angles">
<span class="sig-name descname"><span class="pre">select_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_angles" title="Link to this definition">#</a></dt>
<dd><p>Function to restrict the angles selection by providing either providing SMARTS strings or explicit angles descriptors to retain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] </em><em>| </em><em>AngleDescriptor</em><em> | </em><em>Sequence</em><em>[</em><em>AngleDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  The criterion or criteria by which to retain angles in the selection.
Defaults to None meaning that all angles will be added back into the selection.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_angles_by_atoms">
<span class="sig-name descname"><span class="pre">select_angles_by_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_angles_by_atoms" title="Link to this definition">#</a></dt>
<dd><p>Helper function to select angles by specifying a subset of atoms to consider angles between.</p>
<p>Allows provision of a single list of atoms or multiple such lists and will iterate over them as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either a single set of atoms to keep angles between or multiple sets within which the bonds should be kept. Defaults to None.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection._new_angle_selection_from_atoms">
<span class="sig-name descname"><span class="pre">_new_angle_selection_from_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consider_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection._new_angle_selection_from_atoms" title="Link to this definition">#</a></dt>
<dd><p>Internal helper to get angle selection instead of directly updating the selection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either a single set of atoms to keep angles between or multiple sets within which the bonds should be kept. Defaults to None.</p></li>
<li><p><strong>consider_all</strong> (<em>bool :</em>)  Whether to use the entire set of features in the whole molecule as basis or just the selected set.
Defaults to using only the currently selected set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The set of agnle descriptors in current selection fully covered by these <cite>atoms</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)">set</a>[AngleDescriptor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_dihedrals">
<span class="sig-name descname"><span class="pre">select_dihedrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_dihedrals" title="Link to this definition">#</a></dt>
<dd><p>Function to restrict the dihedral selection by providing either providing SMARTS strings or explicit dihedral descriptors to retain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>| </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>]</em><em>| </em><em>DihedralDescriptor</em><em>| </em><em>Sequence</em><em>[</em><em>DihedralDescriptor</em><em>]</em><em>| </em><em>None</em><em>, </em><em>optional</em>)  A SMARTS string, a sequence thereof or one or more index sets for dihedrals to be identified</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If an invalid entry or selection was provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_dihedrals_by_atoms">
<span class="sig-name descname"><span class="pre">select_dihedrals_by_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_dihedrals_by_atoms" title="Link to this definition">#</a></dt>
<dd><p>Helper function to select dihedrals by specifying a subset of atoms to consider dihedrals between.</p>
<p>Allows provision of a single list of atoms or multiple such lists and will iterate over them as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either a single
set of atoms to keep angles between or multiple sets within which the bonds should be kept.
Defaults to None.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection._new_dihedral_selection_from_atoms">
<span class="sig-name descname"><span class="pre">_new_dihedral_selection_from_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consider_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection._new_dihedral_selection_from_atoms" title="Link to this definition">#</a></dt>
<dd><p>Internal helper to get dihedral selection instead of directly updating the selection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either a single set of atoms to keep dihedrals between or multiple sets within which the dihedrals should be kept. Defaults to None.</p></li>
<li><p><strong>consider_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to use the entire set of features in the whole molecule as basis or just the selected set. Defaults to using only the currently selected set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The set of dihedral descriptors in current selection fully covered by these atoms</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)">set</a>[DihedralDescriptor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_pyramids">
<span class="sig-name descname"><span class="pre">select_pyramids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_pyramids" title="Link to this definition">#</a></dt>
<dd><p>Function to restrict the pyramid selection by providing either SMARTS strings or explicit pyramids descriptors or sets of atoms between which to retain pyramids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selection</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] </em><em>| </em><em>PyramidsDescriptor</em><em> | </em><em>Sequence</em><em>[</em><em>PyramidsDescriptor</em><em>]  </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  The criterion or criteria by which to retain pyramids in the selection.
Defaults to None meaning that all pyramids will be added back into the selection.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If an invalid selector is provided.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_pyramids_by_atoms">
<span class="sig-name descname"><span class="pre">select_pyramids_by_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_pyramids_by_atoms" title="Link to this definition">#</a></dt>
<dd><p>Helper function to select pyramids by specifying a subset of atoms to consider pyramids between.</p>
<p>Allows provision of a single list of atoms or multiple such lists and will iterate over them as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>] </em><em>| </em><em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either a single
set of atoms to keep angles between or multiple sets within which the bonds should be kept.
Defaults to None.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection._new_pyramid_selection_from_atoms">
<span class="sig-name descname"><span class="pre">_new_pyramid_selection_from_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">consider_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection._new_pyramid_selection_from_atoms" title="Link to this definition">#</a></dt>
<dd><p>Internal helper to get pyramids selection instead of directly updating the selection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>| </em><em>Sequence</em><em>[</em><em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>]</em><em>| </em><em>None :</em>)  Either a single set of atoms to keep pyramids between or multiple sets within which the pyramids should be kept. Defaults to None.</p></li>
<li><p><strong>atoms</strong></p></li>
<li><p><strong>consider_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to use the entire set of features in the whole molecule as basis or just the selected set.
Defaults to using only the currently selected set.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The set of dihedral descriptors in current selection fully covered by these atoms</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)">set</a>[Pyramid]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_bats">
<span class="sig-name descname"><span class="pre">select_bats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">smarts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subgraph_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idxs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_bats" title="Link to this definition">#</a></dt>
<dd><p>Update entire selection on this molecule to a subset of available atoms, bonds, angles or dihedrals.</p>
<p>Updates can be requested by providing smarts strings or by providing specific ids of features, where the feature type will be
determined based on the length of the tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>smarts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  One or more smarts to identify subsets of the molecule and the features therein. Defaults to None.</p></li>
<li><p><strong>subgraph_selection</strong> (<em>Sequence</em><em>[</em><em>AtomDescriptor</em><em>]</em><em>, </em><em>optional</em>)  Only allow for results within the subgraph over these atoms to be retained.
If not provided, no filtering will be performed. Can be used to select by the result of a SMARTS pattern match.</p></li>
<li><p><strong>idxs</strong> (<em>FeatureDescriptor</em><em> | </em><em>Sequence</em><em>[</em><em>FeatureDescriptor</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  Either a single tuple or a sequence of tuples to use for the update.
Will be assigned based on the length of the tuple. Defaults to None.</p></li>
<li><p><strong>mode</strong> (<em>Literal</em><em>[</em><em>'repl'</em><em>, </em><em>'intersect'</em><em>, </em><em>'ext'</em><em>, </em><em>'sub'</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>)  The mode for the update. The new selection can either be the intersection of the current
selection and the features covered by the new update set, it can be extended to contain the new update set (ext) or the new update set can
be removed from the current selection (<cite>sub</cite>). Can also be repl to indicate that we want to replace all indices with the provided idxs results.
Defaults to intersect if a SMARTS is provided, to repl if only idxs is provided.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether the selection should be updated in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select">
<span class="sig-name descname"><span class="pre">select</span></span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__match_pattern">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__match_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smarts</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__match_pattern" title="Link to this definition">#</a></dt>
<dd><p>Find all substructure matches of a SMARTS pattern in a molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdkit.Chem.rdchem.Mol</em><em>|</em><em>None</em>)  RDKit molecule object.</p></li>
<li><p><strong>smarts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)  SMARTS pattern to search for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list of Sequence of AtomDescriptor</em>  Each Entry contains all atom indices corresponding to one match of the SMARTS pattern.
Returns an empty list if no match is found.</p></li>
<li><p><em>None</em>  if the provided SMARTS string was invalid.</p></li>
<li><p><em>Raises</em></p></li>
<li><p><em>-</em></p></li>
<li><p><strong>ValueError</strong> (If no <cite>mol</cite> object is provided. Cannot match if not molecule object provided.)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[Sequence[AtomDescriptor]] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection._flatten">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_flatten</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection._flatten" title="Link to this definition">#</a></dt>
<dd><p>Helper functiont to flatten nested lists</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obj</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>|</em><em>Any</em>)  A potentially nested set of lists.</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Iterator[Any]</em>  The iterator to iterate over all entries in the flattened list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.draw">
<span class="sig-name descname"><span class="pre">draw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bonds'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.draw" title="Link to this definition">#</a></dt>
<dd><p>Helper function to allow visualization of the structure represented in this selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flag_level</strong> (<em>FeatureLevelOptions</em><em>, </em><em>optional</em>)  Currently unused. Defaults to bonds.</p></li>
<li><p><strong>highlight_color</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)  Color to use for highlights of the active parts. Defaults to a flag-level dependent color.</p></li>
<li><p><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>)  Width of the figure. Defaults to 300.</p></li>
<li><p><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>)  Height of the figure. Defaults to 300.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The SVG representation of this selections figure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>SVG</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__get_active_atoms">
<span class="sig-name descname"><span class="pre">__get_active_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'atoms'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__get_active_atoms" title="Link to this definition">#</a></dt>
<dd><p>Helper function to get the list of atoms involved in the selection at feature level <cite>flag_level</cite>.</p>
<p>Available levels are:
- 1 | atoms: atoms selected
- 2 | bonds: bonds selected
- 3 | angles: angles selected
- 4 | dihedrals: dihedrals selected
- 5 | pyramids: pyramids selected</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flag_level</strong> (<em>Literal</em><em>[</em><em>1</em><em>, </em><em>2</em><em>, </em><em>3</em><em>, </em><em>4</em><em>]</em><em>, </em><em>optional</em>)  The level of selection that should be used for finding all involved bonds. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of atom indices involved in the selection at the desired feature level.s</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[AtomDescriptor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__get_active_bonds">
<span class="sig-name descname"><span class="pre">__get_active_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flag_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bonds'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__get_active_bonds" title="Link to this definition">#</a></dt>
<dd><p>Get the list of active bonds at a certain level of selection, i.e. in bonds, in angles, in dihedrals, or in pyramids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flag_level</strong> (<em>FeatureLevelOptions</em><em>, </em><em>optional</em>)  The level of selection that should be used for finding all involved bonds. Needs to be at least 2 (<cite>bonds</cite>) to yield any bonds. Defaults to 2.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of involved bond descriptors at that feature level.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[BondDescriptor]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.bond_descriptor_to_mol_index">
<span class="sig-name descname"><span class="pre">bond_descriptor_to_mol_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_descriptors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.bond_descriptor_to_mol_index" title="Link to this definition">#</a></dt>
<dd><p>Helper function to translate a list of Bond descriptors into RDKit bond indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bond_descriptors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><em>BondDescriptor</em><em>]</em>)  The list of BondDescriptor tuples that we want to translate into RDKit mol internal bond indices.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>list[int]</em>  The mapped list of RDKit self.mol internal bond indices.</p></li>
<li><p><em>int</em>  If a single bond descriptor was provided</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.14)"><strong>AssertionError</strong></a>  if self.mol is None, no mapping can be performed.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a> | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.select_BLA_chromophor">
<span class="sig-name descname"><span class="pre">select_BLA_chromophor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">BLA_smarts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_double_bonds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_chain_elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#6,#7,#8,#15,#16'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_considered_BLA_double_bonds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.select_BLA_chromophor" title="Link to this definition">#</a></dt>
<dd><p>Select the (maximum length) BLA chromophor in the system.</p>
<p>You can provide a SMARTS to match the BLA chromophor directly, specify the number of double bonds in the chromophor
and the allowed elements in the BLA chain via <cite>allowed_chain_elements</cite>, which will be integrated directly into the SMARTS string
or the function will automatically try to detect the maximum BLA system size.</p>
<p>This function assumes the BLA chromophor to be unique.
If the maximum chromophor is not unique, an error will be raised.
In that case, you can get all the matches by building the BLA SMARTS with <cite>__build_conjugated_smarts()</cite> and
yield the entire chromophore match with <cite>select_bats()</cite> for that SMARTS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BLA_smarts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>)  The SMARTS string to match the maximum chromophor to. Defaults to None.</p></li>
<li><p><strong>num_double_bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>)  The number of double bonds in the maximum size chromophor to construct a SMARTS string
if not provided. Defaults to None.</p></li>
<li><p><strong>allowed_chain_elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)  Allowed elements along the chromophor chain. Defaults to #6,#7,#8,#15,#16.</p></li>
<li><p><strong>max_considered_BLA_double_bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>)  Maximum number of double bonds in a BLA chromophor if automatic maximum size detection
is performed. Defaults to 50.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to update the selection in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated selection constrained to the unique BLA chromophor of maximum length</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StructureSelection" title="shnitsel.filtering.StructureSelection">StructureSelection</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If the maximum BLA is not unique.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__build_conjugated_smarts">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__build_conjugated_smarts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_double_bonds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allowed_chain_elements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#6,#7,#8,#15,#16'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__build_conjugated_smarts" title="Link to this definition">#</a></dt>
<dd><p>Build a SMARTS pattern for a linear conjugated system with <cite>n_double</cite>
alternating double bonds.</p>
<p>Example (n_double=2):
[#6,#7]=[#6,#7]-[#6,#7]=[#6,#7]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_double_bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)  Number of C=C-like double bonds. Must be positive, i.e. at least 1.</p></li>
<li><p><strong>allowed_chain_elements</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)  SMARTS atomic specification, i.e. comma-separated list of element descriptors (default: C,N,O,P,S represented as #6,#7,#8,#15,#16).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>SMARTS string encoding the conjugated system.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection._to_feature_level_str">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_to_feature_level_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ft</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection._to_feature_level_str" title="Link to this definition">#</a></dt>
<dd><p>Convert arbitrary representations of feature levels (level ids or level names)
to standardized level name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ft</strong> (<em>FeatureLevelOptions</em>)  A representation of a feature level</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string representing the feature level</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>FeatureLevelType</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.canonicalize_bond">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">canonicalize_bond</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.canonicalize_bond" title="Link to this definition">#</a></dt>
<dd><p>Impose a standardized index order in bonds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bond</strong> (<em>BondDescriptor</em>)  The bond descriptor to canonicalize</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The bond descriptor with standardized index order</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>BondDescriptor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.canonicalize_angle">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">canonicalize_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.canonicalize_angle" title="Link to this definition">#</a></dt>
<dd><p>Impose a standardized index order in angles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>angle</strong> (<em>AngleDescriptor</em>)  The angle descriptor to canonicalize</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The bond descriptor with standardized index order</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>AngleDescriptor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.canonicalize_dihedral">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">canonicalize_dihedral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dihedral</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.canonicalize_dihedral" title="Link to this definition">#</a></dt>
<dd><p>Impose a standardized index order in dihedrals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dihedral</strong> (<em>DihedralDescriptor :</em>)  The dihedral descriptor to canonicalize</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dihedral descriptor with standardized index order</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DihedralDescriptor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.canonicalize_pyramid">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">canonicalize_pyramid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pyramid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.canonicalize_pyramid" title="Link to this definition">#</a></dt>
<dd><p>Impose a standardized index order in pyramids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pyramid</strong> (<em>PyramidsDescriptor :</em>)  The pyramid descriptor to canonicalize</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The pyramid descriptor with standardized index order</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>PyramidsDescriptor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.get_bond_type">
<span class="sig-name descname"><span class="pre">get_bond_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.get_bond_type" title="Link to this definition">#</a></dt>
<dd><p>Helper function to get the bond type between two atoms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bond</strong> (<em>BondDescriptor</em>)  The bond descriptor</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The bond type as a float</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__get_smiles_order">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__get_smiles_order</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__get_smiles_order" title="Link to this definition">#</a></dt>
<dd><p>Returns the order in which atoms would appear in the canonical SMILES of
<code class="docutils literal notranslate"><span class="pre">mol</span></code>, ignoring hydrogens</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Mol</em>)  An <code class="docutils literal notranslate"><span class="pre">rdkit.Chem.Mol</span></code> object</p></li>
<li><p><strong>include_h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  A flag to include the H atoms in the smiles order. If set to False, will return
the set of original indices of all atoms but hydrogens. If set to True,
will return the index set of all atoms in the molecule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of integers representing indices of the original <code class="docutils literal notranslate"><span class="pre">mol</span></code> object (as opposed
to the integers assigned to the copy stripped of hydrogens)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>]</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Helper function for <cite>non_redundant()</cite> method to get the non-redundant subset of bonds,
angles and dihedrals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.non_redundant">
<span class="sig-name descname"><span class="pre">non_redundant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.non_redundant" title="Link to this definition">#</a></dt>
<dd><p>Compute a non-redundant set of bonds, angles, and dihedrals
sufficient to uniquely determine the atoms of the input,
given a fixed centre and whole-molecular orientation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>include_h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to include internal coordinates for hydrogen atoms</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Whether to update the selection in-place. Defaults to False, yielding a new object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated StructureSelection object with only non-redundant coordinates in bonds,
angles and dihedrals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For many cases including methane, the internal coordinates
returned by this function will not be complete (but should still be
non-redundant). E.g. in the case of methane, 7 (distinct) coordinates
will be returned where 5*3-6=9 would be expected.
This should mostly affect the internal coordinates of hydrogens as
opposed to those of heavy atoms.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__add__" title="Link to this definition">#</a></dt>
<dd><p>Add the selected entries of the other structure selection to a shared selection.</p>
<p>For consistency reasons, the other <cite>StructureSelection</cite> (which can be provided as a descriptor instead),
should be built upon the same base structure/molecule.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Metadata is not copied over, only the selection.
The support for arithmetic or boolean operations is only meant as a helper to
make combinations of selections easier.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Self</em><em> | </em><em>StructureSelectionDescriptor</em>)  The selected features to add to this selection, either as another structure selection or
as a description of features, SMARTS or FeatureLevels, that can be used in the various
<cite>.select_*()</cite> methods on this class.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>StructureSelection</cite> object representing the union of the selections</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__or__">
<span class="sig-name descname"><span class="pre">__or__</span></span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__or__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__sub__">
<span class="sig-name descname"><span class="pre">__sub__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__sub__" title="Link to this definition">#</a></dt>
<dd><p>Remove the selected entries of the other structure selection to create a new selection.</p>
<p>For consistency reasons, the other <cite>StructureSelection</cite> (which can be provided as a descriptor instead),
should be built upon the same base structure/molecule.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Metadata is not copied over, only the selection.
The support for arithmetic or boolean operations is only meant as a helper to
make combinations of selections easier.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Self</em><em> | </em><em>StructureSelectionDescriptor</em>)  The selected features to remove from this selection, either as another structure selection or
as a description of features, SMARTS or FeatureLevels, that can be used in the various
<cite>.select_*()</cite> methods on this class.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>StructureSelection</cite> object representing the difference of the selections (elements in the first but not the second)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__and__">
<span class="sig-name descname"><span class="pre">__and__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__and__" title="Link to this definition">#</a></dt>
<dd><p>Build the intersection of the selected entries of the other structure selection and this selection to create a new selection.</p>
<p>For consistency reasons, the other <cite>StructureSelection</cite> (which can be provided as a descriptor instead),
should be built upon the same base structure/molecule.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Metadata is not copied over, only the selection.
The support for arithmetic or boolean operations is only meant as a helper to
make combinations of selections easier.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Self</em><em> | </em><em>StructureSelectionDescriptor</em>)  The selected features to intersect with this selection, either as another structure selection or
as a description of features, SMARTS or FeatureLevels, that can be used in the various
<cite>.select_*()</cite> methods on this class.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>StructureSelection</cite> object representing the intersection of the selections (elements in the first and the second).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.__invert__">
<span class="sig-name descname"><span class="pre">__invert__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.__invert__" title="Link to this definition">#</a></dt>
<dd><p>Get an inverted selection of the features within this selection</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <cite>StructureSelection</cite> object representing the inverted selection in this object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.union">
<span class="sig-name descname"><span class="pre">union</span></span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.union" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.intersect">
<span class="sig-name descname"><span class="pre">intersect</span></span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.intersect" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.difference">
<span class="sig-name descname"><span class="pre">difference</span></span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.difference" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelection.invert">
<span class="sig-name descname"><span class="pre">invert</span></span><a class="headerlink" href="#shnitsel.filtering.StructureSelection.invert" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py type">
<dt class="sig sig-object py" id="shnitsel.filtering.FeatureDescriptor">
<em class="property"><span class="k"><span class="pre">type</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">FeatureDescriptor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">AtomDescriptor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">BondDescriptor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">AngleDescriptor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DihedralDescriptor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">PyramidsDescriptor</span></em><a class="headerlink" href="#shnitsel.filtering.FeatureDescriptor" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py type">
<dt class="sig sig-object py" id="shnitsel.filtering.StructureSelectionDescriptor">
<em class="property"><span class="k"><span class="pre">type</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StructureSelectionDescriptor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">SMARTSstring</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">FeatureLevelType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">FeatureDescriptor</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Collection</span><span class="p"><span class="pre">[</span></span><span class="pre">SMARTSstring</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">FeatureLevelType</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">FeatureDescriptor</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StructureSelectionDescriptor" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StateSelection</span></span><a class="headerlink" href="#shnitsel.filtering.StateSelection" title="Link to this definition">#</a></dt>
<dd><p>Class to keep track of a (sub-)selection of states and state transitions for analysis and plotting.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.is_directed">
<span class="sig-name descname"><span class="pre">is_directed</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.is_directed" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.states_base">
<span class="sig-name descname"><span class="pre">states_base</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateId</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.states_base" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.states">
<span class="sig-name descname"><span class="pre">states</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateId</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.states" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.ground_state_id">
<span class="sig-name descname"><span class="pre">ground_state_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">shnitsel.core.typedefs.StateId</span></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.ground_state_id" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_types">
<span class="sig-name descname"><span class="pre">state_types</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateId</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_types" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_names">
<span class="sig-name descname"><span class="pre">state_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateId</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_names" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_charges">
<span class="sig-name descname"><span class="pre">state_charges</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateId</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_charges" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_degeneracy_group">
<span class="sig-name descname"><span class="pre">state_degeneracy_group</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateId</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_degeneracy_group" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.degeneracy_group_states">
<span class="sig-name descname"><span class="pre">degeneracy_group_states</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateId</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.degeneracy_group_states" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_combinations_base">
<span class="sig-name descname"><span class="pre">state_combinations_base</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateCombination</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_combinations_base" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_combinations">
<span class="sig-name descname"><span class="pre">state_combinations</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateCombination</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_combinations" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_combination_names">
<span class="sig-name descname"><span class="pre">state_combination_names</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateCombination</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_combination_names" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_colors">
<span class="sig-name descname"><span class="pre">state_colors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateId</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_colors" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_combination_colors">
<span class="sig-name descname"><span class="pre">state_combination_colors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><span class="pre">shnitsel.core.typedefs.StateCombination</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_combination_colors" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.copy_or_update">
<span class="sig-name descname"><span class="pre">copy_or_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_directed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ground_state_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_charges</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_combinations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_combination_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_combination_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_degeneracy_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degeneracy_group_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.copy_or_update" title="Link to this definition">#</a></dt>
<dd><p>Function to create a copy with replaced member values.</p>
<p>Meant as a helper for the <cite>Frozen</cite> logic of the selection, i.e. method calls return a new instance
instead of updating the existing instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>is_directed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Potentially new flag whether state combinations are considered to be directed (i.e. (1,3) is different from (3,1)) or not. Defaults to None.</p></li>
<li><p><strong>ground_state_id</strong> (<em>StateId</em><em> or </em><em>None</em><em>, </em><em>optional</em>)  Potentially new ground_state id. Defaults to None.</p></li>
<li><p><strong>states</strong> (<em>Sequence</em><em>[</em><em>StateId</em><em>] or </em><em>None</em><em>, </em><em>optional</em>)  Potentially new state ids. Defaults to None.</p></li>
<li><p><strong>state_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateId</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] or </em><em>None</em><em>, </em><em>optional</em>)  Potentially new state types/multiplicities. Defaults to None.</p></li>
<li><p><strong>state_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateId</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] or </em><em>None</em><em>, </em><em>optional</em>)  Potentially new state names. Defaults to None.</p></li>
<li><p><strong>state_degeneracy_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateId</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] or </em><em>None</em><em>, </em><em>optional</em>)  Optional degeneracy group indices for states. Defaults to None.</p></li>
<li><p><strong>degeneracy_group_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><em>StateId</em><em>]</em><em>] or </em><em>None</em><em>, </em><em>optional</em>)  Optional mapping of degeneracy groups to the states they hold. Defaults to None.</p></li>
<li><p><strong>state_charges</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateId</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] or </em><em>None</em><em>, </em><em>optional</em>)  Potentially new state charges. Defaults to None.</p></li>
<li><p><strong>state_combinations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><em>StateCombination</em><em>] or </em><em>None</em><em>, </em><em>optional</em><em>)</em>)  Potentially new state combinations. Defaults to None.</p></li>
<li><p><strong>state_combination_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateCombination</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] or </em><em>None</em><em>, </em><em>optional</em>)  Potentially new names for state combinations. Defaults to None.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  A flag whether the existing instance should be updated or a new one should be created. Defaults to False, i.e. a new instance is created.</p></li>
<li><p><strong>state_colors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateId</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] or </em><em>None</em><em>, </em><em>optional</em>)  An optional colormap for states. Defaults to None.</p></li>
<li><p><strong>state_combination_colors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateCombination</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] or </em><em>None</em><em>, </em><em>optional</em>)  An optional colormap for state combinations. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The selection update with the new members set. Can either be a copy if <cite>inplace=False</cite> or the old instance with updated members otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.init_from_dataset">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_from_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_directed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.init_from_dataset" title="Link to this definition">#</a></dt>
<dd><p>Alternative constructor that creates an initial StateSelection object from a dataset using the entire state information in it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><em>type</em></a><em>[</em><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection"><em>StateSelection</em></a><em>]</em>)  The type of this StateSelection so that we can create instances of it.</p></li>
<li><p><strong>dataset</strong> (<em>xr.Dataset</em><em> or </em><a class="reference internal" href="../data/dataset_containers/index.html#shnitsel.data.dataset_containers.ShnitselDataset" title="shnitsel.data.dataset_containers.ShnitselDataset"><em>ShnitselDataset</em></a>)  The dataset to extract the state information out of. Must have a <cite>state</cite> dimension and preferrably coordinates <cite>state</cite>, <cite>state_names</cite>, <cite>state_types</cite>, <cite>state_charges</cite>, and <cite>statecomb</cite> set.
If <cite>state</cite> is not set as a coordinate, a potential dimension size of <cite>state</cite> is taken and states are enumerates <cite>1</cite> through <cite>1+dataset.sizes[state]</cite>.
If <cite>statecomb</cite> is not set as a coordinate, all unordered pairs of states will be used as a default value for <cite>state_combinations</cite>.</p></li>
<li><p><strong>is_directed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default=False</em>)  Flag whether state combinatons should be assumed different, i.e. (1,3) should be considered different from (3,1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A state selection object initially covering all states (and state combinations) present in the dataset.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If no <cite>state</cite> information could be extracted from the dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.init_from_descriptor">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">init_from_descriptor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_directed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.init_from_descriptor" title="Link to this definition">#</a></dt>
<dd><p>Build a (rather rudimentary) state selection and
state combination selection from descriptors with no support for determination of
multiplicity groups and others but to simplify the process of providing a state selection
to function calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><em>type</em></a><em>[</em><em>Self</em><em>]</em>)  StateSelection class to use for construction.</p></li>
<li><p><strong>spec</strong> (<em>StateSelectionDescriptor</em>)  Either a single spec string, a Sequence of state ids or state id pairs
or a sequence of spec strings.
A selection of <code class="docutils literal notranslate"><span class="pre">[(1,</span> <span class="pre">2),</span> <span class="pre">(2,</span> <span class="pre">1),</span> <span class="pre">(3,</span> <span class="pre">1)]</span></code> means
to select only transitions between states 1 and 2 as well as from
3 to 1 (but not from 1 to 3).
Alternatively, combinations may be specified as a single string
in the following style: <code class="docutils literal notranslate"><span class="pre">'1&lt;&gt;2,</span> <span class="pre">3-&gt;1'</span></code>  this specification
selects the same combinations as in the previous example, with <code class="docutils literal notranslate"><span class="pre">&lt;&gt;</span></code>
selecting transitions in either direction and <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> being
one-directional.</p></li>
<li><p><strong>is_directed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether state combinatons should be assumed different, i.e. (1,3) should be considered different from (3,1).
If not provided, will be set depending on whether there is a directed transition in the descriptors, i.e. <cite>i -&gt; j</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A StateSelection built from the state specification.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection._standard_state_comb_spec">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_standard_state_comb_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection._standard_state_comb_spec" title="Link to this definition">#</a></dt>
<dd><p>Support extracting states and state combinations from strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>spec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)  The spec string with a certain pattern.
A state selection holding states or state transitions that should be used
in analysis, e.g.:
A selection of <code class="docutils literal notranslate"><span class="pre">[(1,</span> <span class="pre">2),</span> <span class="pre">(2,</span> <span class="pre">1),</span> <span class="pre">(3,</span> <span class="pre">1)]</span></code> means
to select only transitions between states 1 and 2 as well as from
3 to 1 (but not from 1 to 3).
Alternatively, combinations may be specified as a single string
in the following style: <code class="docutils literal notranslate"><span class="pre">'1&lt;&gt;2,</span> <span class="pre">3-&gt;1'</span></code>  this specification
selects the same hops as in the previous example, with <code class="docutils literal notranslate"><span class="pre">&lt;&gt;</span></code>
selecting hops in either direction and <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> being one-
directional.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>First the list of StateIds mentioned in the selection descriptor, then the list of state combinations listed in
the state combination mentioned in the state selection descriptor.
Finally a flag whether there was at least one directed state combination specifier.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[StateId], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[StateCombination], <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection._abstract_state_comb_spec">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_abstract_state_comb_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states_from_sc_statements</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection._abstract_state_comb_spec" title="Link to this definition">#</a></dt>
<dd><p>Support for abstract state combination description, allowing for inputs like
<cite>T-&gt;S</cite> to specify transitions from a triplet to a singlet state in addition to the extraction
of specific state ids in <cite>._standard_state_comb_spec()</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)  The spec string with a certain pattern.
A state selection (optionally including patterns) holding states or state transitions that should be used
in analysis, e.g.:
A selection of <code class="docutils literal notranslate"><span class="pre">[(1,</span> <span class="pre">2),</span> <span class="pre">(2,</span> <span class="pre">1),</span> <span class="pre">(3,</span> <span class="pre">1)]</span></code> means
to select only transitions between states 1 and 2 as well as from
3 to 1 (but not from 1 to 3).
Alternatively, combinations may be specified as a single string
in the following style: <code class="docutils literal notranslate"><span class="pre">'1&lt;&gt;2,</span> <span class="pre">3-&gt;1'</span></code>  this specification
selects the same hops as in the previous example, with <code class="docutils literal notranslate"><span class="pre">&lt;&gt;</span></code>
selecting hops in either direction and <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> being one-
directional.
States can also be described using their names (if configured, e.g. <cite>S0</cite>)
or a label describing their multiplicities (if configured, e.g. <cite>T</cite> for all triplet states)</p></li>
<li><p><strong>states_from_sc_statements</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default=False</em>)  Flag whether states mentioned in state combination statements should be included in the
resulting sets for explicit states and state patterns.
E.g. if the selection is <cite>1-&gt;2</cite>, normally, the state selection would be empty,
but with <cite>states_from_sc_statements=True</cite>, the state selection would be <cite>[1,2]</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>set[StateId],
set[StateCombination],
set[MultiplicityLabel | str],
set[</p>
<blockquote>
<div><dl class="simple">
<dt>tuple[</dt><dd><p>MultiplicityLabel | str | StateId,
MultiplicityLabel | str | StateId,</p>
</dd>
</dl>
<p>]</p>
</div></blockquote>
<p>],
bool]
First the set of explicit <cite>StateIds</cite> mentioned in the selection descriptor,
then the set of explicit state combinations listed in
the state combination mentioned in the state selection descriptor.
Third the set of patterns for states, i.e. the set of multiplicity labels or state names,
Fourth the set of patterns for state types, i.e. tuples involving at least one pattern for states.
Finally a flag whether there was at least one directed state combination specifier.</p>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a>[</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.as_directed_selection">
<span class="sig-name descname"><span class="pre">as_directed_selection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.as_directed_selection" title="Link to this definition">#</a></dt>
<dd><p>Helper method to turn an undirected selection into a directed selection.</p>
<p>If the selection is already directed, it will be returned unmodified.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either the already directed selection or a copy with all mirrored transitions also initially included.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.as_undirected_selection">
<span class="sig-name descname"><span class="pre">as_undirected_selection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.as_undirected_selection" title="Link to this definition">#</a></dt>
<dd><p>Helper method to turn a directed selection into an undirected selection.</p>
<p>If the selection is already undirected, it will be returned unmodified.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either the already undirected selection or a copy with all transitions reduced to those with canonical order.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection._state_comb_canonicalized">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_state_comb_canonicalized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_directed</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection._state_comb_canonicalized" title="Link to this definition">#</a></dt>
<dd><p>Helper to turn transitions into a canonic order if the selection is not directed.</p>
<p>If the selection is directed, the combination is returned as-is.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comb</strong> (<em>StateCombination</em>)  The combination tuple to turn into a canonical order</p></li>
<li><p><strong>is_directed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>)  Flag whether the order should be canonical in a set with this <cite>is_directed</cite> flag</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The canonicalized combination tuple.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StateCombination</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection._state_id_matches_pattern">
<span class="sig-name descname"><span class="pre">_state_id_matches_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection._state_id_matches_pattern" title="Link to this definition">#</a></dt>
<dd><p>Helper function to check whether a state Id matches a certain string pattern provided by a user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>StateId</em>)  The state id to check for a match</p></li>
<li><p><strong>pattern</strong> (<em>MultiplicityLabel</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>StateId</em>)  The pattern to compare the state to.
Can be a multiplicity label or a state name.
If the values for multiplicity labels or state names are not set, this may result in an exception
being raised</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether the state matches the pattern</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.14)"><strong>RuntimeError</strong></a>  If matching for multiplicity or name is requested and type information or name data is missin.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection._state_ids_match_pattern">
<span class="sig-name descname"><span class="pre">_state_ids_match_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection._state_ids_match_pattern" title="Link to this definition">#</a></dt>
<dd><p>Helper function to check which states out of a collection matches a certain string pattern provided by a user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_selection</strong> (<em>Iterable</em><em>[</em><em>StateId</em><em>]</em><em>s</em>)  The state id to check for a match</p></li>
<li><p><strong>pattern</strong> (<em>MultiplicityLabel</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>)  The pattern to compare the state to.
Can be a multiplicity label or a state name.
If the values for multiplicity labels or state names are not set, this may result in an error.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The set of state ids from the selection that adhere to the pattern.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)">set</a>[StateId]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection._state_combs_matches_pattern">
<span class="sig-name descname"><span class="pre">_state_combs_matches_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_comb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection._state_combs_matches_pattern" title="Link to this definition">#</a></dt>
<dd><p>Helper function to check whether a specific state combinations matches a certain string pattern provided by a user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_comb</strong> (<em>StateCombination</em>)  The state combination to check for a match</p></li>
<li><p><strong>pattern</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><em>MultiplicityLabel</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>StateId</em><em>, </em><em>MultiplicityLabel</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em> | </em><em>StateId</em><em>]</em>)  The pattern to compare the state to.
Each entry can be a multiplicity label or a state name and of of both entries can be an explicit state id..
If the values for multiplicity labels or state names are not set, this may result in an error.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean flag whether the state combinations matches the pattern</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>boole</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection._state_combs_match_pattern">
<span class="sig-name descname"><span class="pre">_state_combs_match_pattern</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pattern</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection._state_combs_match_pattern" title="Link to this definition">#</a></dt>
<dd><p>Helper function to check which state combinations out of a collection matches a certain string pattern provided by a user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_selection</strong> (<em>Iterable</em><em>[</em><em>StateCombination</em><em>]</em>)  The state combinations to check for a match</p></li>
<li><p><strong>pattern</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><em>tuple</em></a><em>[</em><em>MultiplicityLabel</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>MultiplicityLabel</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>]</em>)  The pattern to compare the state to.
Each entry can be a multiplicity label or a state name.
If the values for multiplicity labels or state names are not set, this may result in an error.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The set of state combination identifiers from the selection that adhere to the pattern.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)">set</a>[StateCombination]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.select_states">
<span class="sig-name descname"><span class="pre">select_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_charge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_multiplicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_states_in_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states_from_sc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.select_states" title="Link to this definition">#</a></dt>
<dd><p>Method to get a new state selection only retaining the states satisfying the required inclusion criteria and
not satisfying the exclusion criteria.</p>
<p>Will return a new StateSelection object with the resulting set of states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selectors</strong> (<em>Iterable</em><em>[</em><em>StateId</em><em> or </em><em>StateSelectionDescriptor</em><em>] or </em><em>StateId</em><em> or </em><em>StateSelectionDescriptor</em><em> or </em><em>None</em><em>, </em><em>optional</em>)  Explicit ids of states to retain. Either a single id or an iterable collection of state ids can be provided. Defaults to None.</p></li>
<li><p><strong>exclude_ids</strong> (<em>Iterable</em><em>[</em><em>StateId</em><em>] or </em><em>StateId</em><em> or </em><em>None</em><em>, </em><em>optional</em><em>)</em>)  Explicit ids of states to exclude. Either a single id or an iterable collection of state ids can be provided. Defaults to None.</p></li>
<li><p><strong>charge</strong> (<em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>)  Charges of states to retain. Defaults to None.</p></li>
<li><p><strong>exclude_charge</strong> (<em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>)  Charges of states to exclude. Defaults to None.</p></li>
<li><p><strong>multiplicity</strong> (<em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>)  Multiplicity of states to retain. Defaults to None.</p></li>
<li><p><strong>exclude_multiplicity</strong> (<em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> or </em><em>None</em><em>, </em><em>optional</em>)  Multiplicity of states to exclude. Defaults to None.</p></li>
<li><p><strong>min_states_in_selection</strong> (<em>{0</em><em>, </em><em>1</em><em>, </em><em>2}</em><em>, </em><em>optional</em>)  Optional parameter to determine whether state combinations should be kept if states they include are no longer part of the selection.
A state combination is retained if at least <cite>min_states_in_selection</cite> of their states are still within the state selection. Defaults to 0, meaning all combinations are kept.</p></li>
<li><p><strong>states_from_sc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default=False</em>)  Flag, whether states should be included in the selection based on states mentioned in state combination
selectors. By default False.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag to update the selection in-place. Defaults to False, meaning a modified copy is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting selection after applying all of the requested conditions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection._mult_label_transl">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_mult_label_transl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multipl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">shnitsel.core.typedefs.MultiplicityLabel</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#shnitsel.filtering.StateSelection._mult_label_transl" title="Link to this definition">#</a></dt>
<dt class="sig sig-object py">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_mult_label_transl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">multipl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">shnitsel.core.typedefs.MultiplicityLabel</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></span></dt>
<dd><p>Function to translate potential string-based multiplicities to integers</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>multipl</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> or </em><em>MultiplicityLabel</em><em> or </em><em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> or </em><em>MultiplicityLabel</em><em>]</em>)  List of multiplicities, either ints or string labels</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A set representation of the numeric multiplicities or the single translated value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)">set</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.select_state_combinations">
<span class="sig-name descname"><span class="pre">select_state_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_states_in_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.select_state_combinations" title="Link to this definition">#</a></dt>
<dd><p>Method to get a new state selection with a potentially reduced set of state combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selectors</strong> (<em>StateSelectionDescriptor</em><em> or </em><em>Iterable</em><em>[</em><em>StateSelectionDescriptor</em><em>]</em><em>, </em><em>optional</em>)  A textual or tuple-based description of the</p></li>
<li><p><strong>ids</strong> (<em>Iterable</em><em>[</em><em>StateCombination</em><em>] or </em><em>None</em><em>, </em><em>optional</em>)  Explicit state transitions ids to retain. Defaults to None.</p></li>
<li><p><strong>min_states_in_selection</strong> (<em>Literal</em><em>[</em><em>0</em><em>, </em><em>1</em><em>, </em><em>2</em><em>]</em><em>, </em><em>optional</em>)  Minimum number of states involved in the state combination that still need to be within the state selection to keep this combination. Defaults to 0, meaning no check will be performed.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag to update the selection in-place. Defaults to False, meaning a modified copy is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new state selection with potentially fewer state combinations considered.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_states_in_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states_from_sc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.select" title="Link to this definition">#</a></dt>
<dd><p>Method to select both states and state combinations in one go.</p>
<p>Internally calls <cite>.select_states()</cite> and <cite>.select_state_combinations()</cite>.
Additionally, the <cite>exclude</cite> keyword parameter can be used to remove matched entries from the
overall selection.
If no parameters are provided, all states and state combinations will be provided.
May implicitly convert to a directed selection if descriptors include directed transitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selectors</strong> (<em>Iterable</em><em>[</em><em>StateId</em><em>  |  </em><em>StateCombination</em><em>  |  </em><em>StateSelectionDescriptor</em><em>] </em><em>| </em><em>StateId</em><em> | </em><em>StateCombination</em><em> | </em><em>StateSelectionDescriptor</em><em> | </em><em>None</em><em>, </em><em>optional</em>)  <p>The description of states and state combinations supposed to be included within the resulting selection.
The description can be a state id (<cite>int</cite>), a transition id, (<cite>tuple[int,int]</cite>) or a <cite>str</cite> with comma-separated statements
denoting either states or state combinations.
The following statements are supported in selector strings:</p>
<blockquote>
<div><ul>
<li><p>A <cite>str</cite> representation of a state id.</p></li>
<li><p>A multiplicity label e.g. <cite>S</cite> or <cite>t</cite> (capitalization irrelevant, requires state types to be set)</p></li>
<li><p>A state name, if state names are configured on this selection, e.g, <cite>S0</cite></p></li>
<li><dl class="simple">
<dt>A state combination representation as a <cite>str</cite>, of one of the following forms:</dt><dd><ul class="simple">
<li><p><cite>&lt;state_a&gt; -&gt; &lt;state_b&gt;</cite> (for directed transitions a to b)</p></li>
<li><p><cite>&lt;state_a&gt; &lt;&gt; &lt;state_b&gt;</cite> (for undirected/bidirectional transitions between a and b)</p></li>
</ul>
</dd>
</dl>
<p>All <cite>&lt;state&gt;</cite> expressions may take any statement of the state representations above.</p>
</li>
</ul>
</div></blockquote>
<p>By default, no states will be selected.</p>
</p></li>
<li><p><strong>exclude</strong> (<em>Iterable</em><em>[</em><em>StateId</em><em>  |  </em><em>StateSelectionDescriptor</em><em>] </em><em>| </em><em>StateId</em><em> | </em><em>StateSelectionDescriptor</em><em> | </em><em>None</em><em>, </em><em>optional</em>)  Same format at <cite>selectors</cite>. If set, the states and state combinations selected by this argument are excluded from the resulting selection.
By default None, meaning no states will be removed.</p></li>
<li><p><strong>min_states_in_selection</strong> (<em>Literal</em><em>[</em><em>0</em><em>, </em><em>1</em><em>, </em><em>2</em><em>]</em><em>, </em><em>optional</em>)  Optional parameter to denote, how many states of a state combination must be within the selection for the state combination to be included in a result, by default 0
E.g. if only states <cite>1</cite> and <cite>3</cite> are selected, and the selection would include <cite>1-&gt;2</cite>, this parameter
needs to be <cite>1</cite> or <cite>0</cite> for <cite>(1,2)</cite> to be included in the result.</p></li>
<li><p><strong>states_from_sc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>default=False</em>)  Flag, whether states should be included in the selection based on states mentioned in state combination
selectors. By default False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting selection with states and state combinations selected.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.set_state_names">
<span class="sig-name descname"><span class="pre">set_state_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.set_state_names" title="Link to this definition">#</a></dt>
<dd><p>Helper function to assign new state names to the selection.</p>
<p>Will peform some sanity checks first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateId</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>]</em>)  Either a list of state names aligned with <cite>self.states</cite> ids or a dictionary mapping state ids to names.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag to determine whether this function should update the existing selection sequence or return a modified copy. Defaults to True, meaning the existing instance is updated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either the existing selection with updated names or a new instance with modified names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If a Sequence is provided that does not have enough values</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If a dict is  provided that does not have mapping for all state ids in <cite>self.states</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.set_state_types">
<span class="sig-name descname"><span class="pre">set_state_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.set_state_types" title="Link to this definition">#</a></dt>
<dd><p>Helper function to assign new state types/multiplicites to the selection.</p>
<p>Will peform some sanity checks first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>types</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateId</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>]</em>)  Either a list of state types/multiplicities aligned with <cite>self.states</cite> ids or a dictionary mapping state ids to types.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag to determine whether this function should update the existing selection sequence or return a modified copy. Defaults to True, meaning the existing instance is updated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either the existing selection with updated types or a new instance with modified types.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If a Sequence is provided that does not have enough values</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If a dict is  provided that does not have mapping for all state ids in <cite>self.states</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.set_state_charges">
<span class="sig-name descname"><span class="pre">set_state_charges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.set_state_charges" title="Link to this definition">#</a></dt>
<dd><p>Helper function to assign new state charges to the selection.</p>
<p>Will peform some sanity checks first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>charges</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em> or </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>] or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateId</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>]</em>)  Either a single charge for all states or a list of state charges aligned with <cite>self.states</cite> ids or a dictionary mapping state ids to charges.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag to determine whether this function should update the existing selection sequence or return a modified copy. Defaults to True, meaning the existing instance is updated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either the existing selection with updated charges or a new instance with modified charges.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If a Sequence is provided that does not have enough charges</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If a dict is provided that does not have mapping for all state ids in <cite>self.states</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.set_state_combinations">
<span class="sig-name descname"><span class="pre">set_state_combinations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">combinations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.set_state_combinations" title="Link to this definition">#</a></dt>
<dd><p>Helper function to assign new state combinations to the selection.</p>
<p>Will peform some sanity checks first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>combinations</strong> (<em>Sequence</em><em>[</em><em>StateCombination</em><em>]</em>)  A list of state combination tuples to set to the selection</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag to determine whether this function should update the existing selection or return a modified copy. Defaults to True, meaning the existing instance is updated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either the existing selection with updated combinations or a new instance with modified combinations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If an entry in the combinations sequence has a non-positive state entry.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.set_state_combination_names">
<span class="sig-name descname"><span class="pre">set_state_combination_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.set_state_combination_names" title="Link to this definition">#</a></dt>
<dd><p>Helper function to assign new state combination labels to the selection.</p>
<p>Will peform some sanity checks first.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><em>StateCombination</em>)  Either a list of state combination names aligned with <cite>self.state_combinations</cite> or a dictionary mapping state combination ids to names.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag to determine whether this function should update the existing selection or return a modified copy. Defaults to True, meaning the existing instance is updated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either the existing selection with updated names or a new instance with modified names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If a Sequence is provided that does not have enough values</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If a dict is  provided that does not have mapping for all state combination ids in <cite>self.state_combinations</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.singlets_only">
<span class="sig-name descname"><span class="pre">singlets_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.singlets_only" title="Link to this definition">#</a></dt>
<dd><p>Helper function to immediately filter only singlet states. Does not affect state combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether the operation should update the selection in-place. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated selection only containing singlet states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.triplets_only">
<span class="sig-name descname"><span class="pre">triplets_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.triplets_only" title="Link to this definition">#</a></dt>
<dd><p>Helper function to immediately filter only triplet states. Does not affect state combinations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether the operation should update the selection in-place. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated selection only containing triplet states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.same_multiplicity_transitions">
<span class="sig-name descname"><span class="pre">same_multiplicity_transitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.same_multiplicity_transitions" title="Link to this definition">#</a></dt>
<dd><p>Helper function to only retain combinations between states of the same multiplicities (e.g. for NACs)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether the operation should update the selection in-place. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated selection only containing transitions between states of same multiplicity (i.e. singlet-singlet, triplet-tiplet).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.different_multiplicity_transitions">
<span class="sig-name descname"><span class="pre">different_multiplicity_transitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.different_multiplicity_transitions" title="Link to this definition">#</a></dt>
<dd><p>Helper function to only retain combinations between states of the different multiplicities (e.g. for SOCs)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether the operation should update the selection in-place. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated selection only containing transitions between states of different multiplicity (i.e. singlet-triplet).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.ground_state_transitions">
<span class="sig-name descname"><span class="pre">ground_state_transitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ground_state_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.ground_state_transitions" title="Link to this definition">#</a></dt>
<dd><p>Helper function to only retain combinations between states containing the lowest-level state id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ground_state_id</strong> (<em>StateId</em><em>, </em><em>optional</em>)  Id of the state to be considered the ground state. Defaults to the lowest id of the selected states.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether the operation should update the selection in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated selection only containing transitions between ground state and other states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.excited_state_transitions">
<span class="sig-name descname"><span class="pre">excited_state_transitions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ground_state_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.excited_state_transitions" title="Link to this definition">#</a></dt>
<dd><p>Helper function to only retain combinations between states not involving the ground state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ground_state_id</strong> (<em>StateId</em><em>, </em><em>optional</em>)  Id of the state to be considered the ground state. Defaults to the lowest id of the selected states.</p></li>
<li><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether the operation should update the selection in-place. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated selection only containing transitions between non-ground states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.non_degenerate">
<span class="sig-name descname"><span class="pre">non_degenerate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.non_degenerate" title="Link to this definition">#</a></dt>
<dd><p>Helper function to remove all degenerate states and combinations identical except for degeneracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether the operation should update the selection in-place. Defaults to False.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated selection only containing non-degenerate states and non-degenerate-equivalent combinations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#shnitsel.filtering.StateSelection" title="shnitsel.filtering.StateSelection">StateSelection</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.state_info">
<span class="sig-name descname"><span class="pre">state_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.state_info" title="Link to this definition">#</a></dt>
<dd><p>Get an iterator over the states in this selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Yields<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Iterable[StateInfo]</em>  An iterator over the available state info</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Iterable[<a class="reference internal" href="../core/typedefs/index.html#shnitsel.core.typedefs.StateInfo" title="shnitsel.core.typedefs.StateInfo">shnitsel.core.typedefs.StateInfo</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.get_state_name_or_default">
<span class="sig-name descname"><span class="pre">get_state_name_or_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.get_state_name_or_default" title="Link to this definition">#</a></dt>
<dd><p>Helper method to either get registered state name or a default string to identify the state</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>StateId</em>)  Id of the state to get the name for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Label of the state</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.get_state_combination_name_or_default">
<span class="sig-name descname"><span class="pre">get_state_combination_name_or_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.get_state_combination_name_or_default" title="Link to this definition">#</a></dt>
<dd><p>Helper method to either get registered state combination name or a default string to identify the state combination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>comb</strong> (<em>StateCombination</em>)  Id of the state combination to get the name for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Label of the state combination</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.get_state_tex_label">
<span class="sig-name descname"><span class="pre">get_state_tex_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.get_state_tex_label" title="Link to this definition">#</a></dt>
<dd><p>Function to get a nice tex-printable label with super- and subscripts for the denoted state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>StateId</em>)  Id of the state to get the label for</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tex-label that needs to be enclosed in a math environment to not cause issues.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.get_state_combination_tex_label">
<span class="sig-name descname"><span class="pre">get_state_combination_tex_label</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.get_state_combination_tex_label" title="Link to this definition">#</a></dt>
<dd><p>Function to get a nice tex-printable label with super- and subscripts for a state combination in this selection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>comb</strong> (<em>StateCombination</em>)  Combination identifier to get the label for</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tex-label that needs to be enclosed in a math environment to not cause issues.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.combination_info">
<span class="sig-name descname"><span class="pre">combination_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degeneracy_free</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.combination_info" title="Link to this definition">#</a></dt>
<dd><p>Get an iterator over the state combinations in this selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>degeneracy_free</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If set to true, combinations with already covered degeneracy-groups will be skipped</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Iterable[StateCombInfo]</em>  An iterator over the available state combination info</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterable[<a class="reference internal" href="../core/typedefs/index.html#shnitsel.core.typedefs.StateCombInfo" title="shnitsel.core.typedefs.StateCombInfo">shnitsel.core.typedefs.StateCombInfo</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.has_state">
<span class="sig-name descname"><span class="pre">has_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.has_state" title="Link to this definition">#</a></dt>
<dd><p>Function to check whether a state is in the selection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>StateId</em>)  The state id to check whether it has been selected</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if in the selection, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.has_state_combination">
<span class="sig-name descname"><span class="pre">has_state_combination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.has_state_combination" title="Link to this definition">#</a></dt>
<dd><p>Function to check whether a state combination is in the selection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>comb</strong> (<em>StateCombination</em>)  The combination to check whether it has been selected</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if in the selection, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.auto_assign_colors">
<span class="sig-name descname"><span class="pre">auto_assign_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.auto_assign_colors" title="Link to this definition">#</a></dt>
<dd><p>Function to automatically generate colors for states and state combinations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Flag whether the operation should update the selection in-place. Defaults to True because setting colors is not a big issue.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns the updated instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.get_state_color">
<span class="sig-name descname"><span class="pre">get_state_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.get_state_color" title="Link to this definition">#</a></dt>
<dd><p>Function to get a the state color or a default color value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>id</strong> (<em>StateId</em>)  Id of the state to get the color for</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hex-str color code</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.get_state_combination_color">
<span class="sig-name descname"><span class="pre">get_state_combination_color</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.get_state_combination_color" title="Link to this definition">#</a></dt>
<dd><p>Function to get a the state combination color or a default color value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>comb</strong> (<em>StateCombination</em>)  Id of the state combination to get the color for</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hex-str color code</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.get_state_combination_degeneracy">
<span class="sig-name descname"><span class="pre">get_state_combination_degeneracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">comb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.get_state_combination_degeneracy" title="Link to this definition">#</a></dt>
<dd><p>Function to get the combined degeneracy classes of the two states.</p>
<p>Helpful for not plotting too degenerate entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>comb</strong> (<em>StateCombination</em>)  Id of the state combination to get the color for</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Degeneracy groups of either state</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.get_state_degeneracy">
<span class="sig-name descname"><span class="pre">get_state_degeneracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.get_state_degeneracy" title="Link to this definition">#</a></dt>
<dd><p>Function to get the combined degeneracy classes of the two states.</p>
<p>Helpful for not plotting too degenerate entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comb</strong> (<em>StateCombination</em>)  Id of the state combination to get the color for</p></li>
<li><p><strong>state</strong> (<em>shnitsel.core.typedefs.StateId</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hex-str color code</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.__add__">
<span class="sig-name descname"><span class="pre">__add__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.__add__" title="Link to this definition">#</a></dt>
<dd><p>Add the states and state combinations of another state selection into the selection
represented by this selection.</p>
<p>For consistency reasons, the other StateSelection (which can be provided as a descriptor instead),
should be built upon the same base state and state combination ground set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Self</em><em> | </em><em>StateSelectionDescriptor</em>)  The states and state combinations to add to this selection, either as another state selection or
as a description of states and state combinations that can be passed to
<cite>StateSelection.init_from_descriptor()</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>StateSelection</cite> object representing the union of the selections</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.__or__">
<span class="sig-name descname"><span class="pre">__or__</span></span><a class="headerlink" href="#shnitsel.filtering.StateSelection.__or__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.__sub__">
<span class="sig-name descname"><span class="pre">__sub__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.__sub__" title="Link to this definition">#</a></dt>
<dd><p>Remove the states and state combinations of another state selection from the selection
represented by this selection.</p>
<p>For consistency reasons, the other StateSelection (which can be provided as a descriptor instead),
should be built upon the same base state and state combination ground set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Self</em><em> | </em><em>StateSelectionDescriptor</em>)  The states and state combinations to remove to this selection, either as another state selection or
as a description of states and state combinations that can be passed to
<cite>StateSelection.init_from_descriptor()</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>StateSelection</cite> object representing the difference of the selections</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.__and__">
<span class="sig-name descname"><span class="pre">__and__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.__and__" title="Link to this definition">#</a></dt>
<dd><p>Get a selection of the states and state combinations shared between
this and another state selection.</p>
<p>For consistency reasons, the other StateSelection (which can be provided
as a descriptor instead), should be built upon the same base state and
state combination ground set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>other</strong> (<em>Self</em><em> | </em><em>StateSelectionDescriptor</em>)  The states and state combinations to intersect with this
this selection, either as another state selection or
as a description of states and state combinations that
can be passed to <cite>StateSelection.init_from_descriptor()</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>StateSelection</cite> object representing the intersection of the selections</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.__invert__">
<span class="sig-name descname"><span class="pre">__invert__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.filtering.StateSelection.__invert__" title="Link to this definition">#</a></dt>
<dd><p>Get an inverted selection of the states and state combinations in
this state selection.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The result of this operation will only be as expected, if the selection was
built from a full dataset such that <cite>states_base</cite> and <cite>state_combinations_base</cite>
have been set correctly.
If the selection was built from a textual or tuple representation, the
inverted selection will only consider the states listed in the original
description.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A <cite>StateSelection</cite> object representing the inverted selection in this object</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Self</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.union">
<span class="sig-name descname"><span class="pre">union</span></span><a class="headerlink" href="#shnitsel.filtering.StateSelection.union" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.intersect">
<span class="sig-name descname"><span class="pre">intersect</span></span><a class="headerlink" href="#shnitsel.filtering.StateSelection.intersect" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.difference">
<span class="sig-name descname"><span class="pre">difference</span></span><a class="headerlink" href="#shnitsel.filtering.StateSelection.difference" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelection.invert">
<span class="sig-name descname"><span class="pre">invert</span></span><a class="headerlink" href="#shnitsel.filtering.StateSelection.invert" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py type">
<dt class="sig sig-object py" id="shnitsel.filtering.StateCombination">
<em class="property"><span class="k"><span class="pre">type</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StateCombination</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">StateId</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StateId</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#shnitsel.filtering.StateCombination" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py type">
<dt class="sig sig-object py" id="shnitsel.filtering.StateId">
<em class="property"><span class="k"><span class="pre">type</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StateId</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#shnitsel.filtering.StateId" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py type">
<dt class="sig sig-object py" id="shnitsel.filtering.StateSelectionDescriptor">
<em class="property"><span class="k"><span class="pre">type</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StateSelectionDescriptor</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">StateId</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">StateCombination</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></em><a class="headerlink" href="#shnitsel.filtering.StateSelectionDescriptor" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../data/xr_io_registry/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">shnitsel.data.xr_io_registry</p>
      </div>
    </a>
    <a class="right-next"
       href="helpers/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">shnitsel.filtering.helpers</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classes">Classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#package-contents">Package Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection"><code class="docutils literal notranslate"><span class="pre">StructureSelection</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.mol"><code class="docutils literal notranslate"><span class="pre">StructureSelection.mol</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection.atoms</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.atoms_types"><code class="docutils literal notranslate"><span class="pre">StructureSelection.atoms_types</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.atoms_selected"><code class="docutils literal notranslate"><span class="pre">StructureSelection.atoms_selected</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.bonds"><code class="docutils literal notranslate"><span class="pre">StructureSelection.bonds</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.bonds_types"><code class="docutils literal notranslate"><span class="pre">StructureSelection.bonds_types</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.bonds_selected"><code class="docutils literal notranslate"><span class="pre">StructureSelection.bonds_selected</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.angles"><code class="docutils literal notranslate"><span class="pre">StructureSelection.angles</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.angles_types"><code class="docutils literal notranslate"><span class="pre">StructureSelection.angles_types</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.angles_selected"><code class="docutils literal notranslate"><span class="pre">StructureSelection.angles_selected</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.dihedrals"><code class="docutils literal notranslate"><span class="pre">StructureSelection.dihedrals</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.dihedrals_types"><code class="docutils literal notranslate"><span class="pre">StructureSelection.dihedrals_types</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.dihedrals_selected"><code class="docutils literal notranslate"><span class="pre">StructureSelection.dihedrals_selected</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.pyramids"><code class="docutils literal notranslate"><span class="pre">StructureSelection.pyramids</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.pyramids_types"><code class="docutils literal notranslate"><span class="pre">StructureSelection.pyramids_types</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.pyramids_selected"><code class="docutils literal notranslate"><span class="pre">StructureSelection.pyramids_selected</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.feature_level_colors"><code class="docutils literal notranslate"><span class="pre">StructureSelection.feature_level_colors</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.copy_or_update"><code class="docutils literal notranslate"><span class="pre">StructureSelection.copy_or_update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.init_from_dataset"><code class="docutils literal notranslate"><span class="pre">StructureSelection.init_from_dataset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.init_from_mol"><code class="docutils literal notranslate"><span class="pre">StructureSelection.init_from_mol()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.derive_other_from_descriptor"><code class="docutils literal notranslate"><span class="pre">StructureSelection.derive_other_from_descriptor()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.only"><code class="docutils literal notranslate"><span class="pre">StructureSelection.only()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_all"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_all()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_atoms_idx"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_atoms_idx()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_bonds"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_bonds()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_bonds_idx"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_bonds_idx()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_pw_dists"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_pw_dists()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_bonds_by_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_bonds_by_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection._new_bond_selection_from_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection._new_bond_selection_from_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_angles"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_angles()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_angles_by_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_angles_by_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection._new_angle_selection_from_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection._new_angle_selection_from_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_dihedrals"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_dihedrals()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_dihedrals_by_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_dihedrals_by_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection._new_dihedral_selection_from_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection._new_dihedral_selection_from_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_pyramids"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_pyramids()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_pyramids_by_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_pyramids_by_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection._new_pyramid_selection_from_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection._new_pyramid_selection_from_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_bats"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_bats()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__match_pattern"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__match_pattern()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection._flatten"><code class="docutils literal notranslate"><span class="pre">StructureSelection._flatten()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.draw"><code class="docutils literal notranslate"><span class="pre">StructureSelection.draw()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__get_active_atoms"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__get_active_atoms()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__get_active_bonds"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__get_active_bonds()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.bond_descriptor_to_mol_index"><code class="docutils literal notranslate"><span class="pre">StructureSelection.bond_descriptor_to_mol_index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.select_BLA_chromophor"><code class="docutils literal notranslate"><span class="pre">StructureSelection.select_BLA_chromophor()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__build_conjugated_smarts"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__build_conjugated_smarts()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection._to_feature_level_str"><code class="docutils literal notranslate"><span class="pre">StructureSelection._to_feature_level_str()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.canonicalize_bond"><code class="docutils literal notranslate"><span class="pre">StructureSelection.canonicalize_bond()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.canonicalize_angle"><code class="docutils literal notranslate"><span class="pre">StructureSelection.canonicalize_angle()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.canonicalize_dihedral"><code class="docutils literal notranslate"><span class="pre">StructureSelection.canonicalize_dihedral()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.canonicalize_pyramid"><code class="docutils literal notranslate"><span class="pre">StructureSelection.canonicalize_pyramid()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.get_bond_type"><code class="docutils literal notranslate"><span class="pre">StructureSelection.get_bond_type()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__get_smiles_order"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__get_smiles_order()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.non_redundant"><code class="docutils literal notranslate"><span class="pre">StructureSelection.non_redundant()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__add__"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__add__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__or__"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__or__</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__sub__"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__sub__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__and__"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__and__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.__invert__"><code class="docutils literal notranslate"><span class="pre">StructureSelection.__invert__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.union"><code class="docutils literal notranslate"><span class="pre">StructureSelection.union</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.intersect"><code class="docutils literal notranslate"><span class="pre">StructureSelection.intersect</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.difference"><code class="docutils literal notranslate"><span class="pre">StructureSelection.difference</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelection.invert"><code class="docutils literal notranslate"><span class="pre">StructureSelection.invert</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.FeatureDescriptor"><code class="docutils literal notranslate"><span class="pre">FeatureDescriptor</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StructureSelectionDescriptor"><code class="docutils literal notranslate"><span class="pre">StructureSelectionDescriptor</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection"><code class="docutils literal notranslate"><span class="pre">StateSelection</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.is_directed"><code class="docutils literal notranslate"><span class="pre">StateSelection.is_directed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.states_base"><code class="docutils literal notranslate"><span class="pre">StateSelection.states_base</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.states"><code class="docutils literal notranslate"><span class="pre">StateSelection.states</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.ground_state_id"><code class="docutils literal notranslate"><span class="pre">StateSelection.ground_state_id</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_types"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_types</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_names"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_names</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_charges"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_charges</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_degeneracy_group"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_degeneracy_group</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.degeneracy_group_states"><code class="docutils literal notranslate"><span class="pre">StateSelection.degeneracy_group_states</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_combinations_base"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_combinations_base</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_combinations"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_combinations</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_combination_names"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_combination_names</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_colors"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_colors</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_combination_colors"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_combination_colors</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.copy_or_update"><code class="docutils literal notranslate"><span class="pre">StateSelection.copy_or_update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.init_from_dataset"><code class="docutils literal notranslate"><span class="pre">StateSelection.init_from_dataset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.init_from_descriptor"><code class="docutils literal notranslate"><span class="pre">StateSelection.init_from_descriptor()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection._standard_state_comb_spec"><code class="docutils literal notranslate"><span class="pre">StateSelection._standard_state_comb_spec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection._abstract_state_comb_spec"><code class="docutils literal notranslate"><span class="pre">StateSelection._abstract_state_comb_spec()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.as_directed_selection"><code class="docutils literal notranslate"><span class="pre">StateSelection.as_directed_selection()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.as_undirected_selection"><code class="docutils literal notranslate"><span class="pre">StateSelection.as_undirected_selection()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection._state_comb_canonicalized"><code class="docutils literal notranslate"><span class="pre">StateSelection._state_comb_canonicalized()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection._state_id_matches_pattern"><code class="docutils literal notranslate"><span class="pre">StateSelection._state_id_matches_pattern()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection._state_ids_match_pattern"><code class="docutils literal notranslate"><span class="pre">StateSelection._state_ids_match_pattern()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection._state_combs_matches_pattern"><code class="docutils literal notranslate"><span class="pre">StateSelection._state_combs_matches_pattern()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection._state_combs_match_pattern"><code class="docutils literal notranslate"><span class="pre">StateSelection._state_combs_match_pattern()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.select_states"><code class="docutils literal notranslate"><span class="pre">StateSelection.select_states()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection._mult_label_transl"><code class="docutils literal notranslate"><span class="pre">StateSelection._mult_label_transl()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.select_state_combinations"><code class="docutils literal notranslate"><span class="pre">StateSelection.select_state_combinations()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.select"><code class="docutils literal notranslate"><span class="pre">StateSelection.select()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.set_state_names"><code class="docutils literal notranslate"><span class="pre">StateSelection.set_state_names()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.set_state_types"><code class="docutils literal notranslate"><span class="pre">StateSelection.set_state_types()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.set_state_charges"><code class="docutils literal notranslate"><span class="pre">StateSelection.set_state_charges()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.set_state_combinations"><code class="docutils literal notranslate"><span class="pre">StateSelection.set_state_combinations()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.set_state_combination_names"><code class="docutils literal notranslate"><span class="pre">StateSelection.set_state_combination_names()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.singlets_only"><code class="docutils literal notranslate"><span class="pre">StateSelection.singlets_only()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.triplets_only"><code class="docutils literal notranslate"><span class="pre">StateSelection.triplets_only()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.same_multiplicity_transitions"><code class="docutils literal notranslate"><span class="pre">StateSelection.same_multiplicity_transitions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.different_multiplicity_transitions"><code class="docutils literal notranslate"><span class="pre">StateSelection.different_multiplicity_transitions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.ground_state_transitions"><code class="docutils literal notranslate"><span class="pre">StateSelection.ground_state_transitions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.excited_state_transitions"><code class="docutils literal notranslate"><span class="pre">StateSelection.excited_state_transitions()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.non_degenerate"><code class="docutils literal notranslate"><span class="pre">StateSelection.non_degenerate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.state_info"><code class="docutils literal notranslate"><span class="pre">StateSelection.state_info()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.get_state_name_or_default"><code class="docutils literal notranslate"><span class="pre">StateSelection.get_state_name_or_default()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.get_state_combination_name_or_default"><code class="docutils literal notranslate"><span class="pre">StateSelection.get_state_combination_name_or_default()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.get_state_tex_label"><code class="docutils literal notranslate"><span class="pre">StateSelection.get_state_tex_label()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.get_state_combination_tex_label"><code class="docutils literal notranslate"><span class="pre">StateSelection.get_state_combination_tex_label()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.combination_info"><code class="docutils literal notranslate"><span class="pre">StateSelection.combination_info()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.has_state"><code class="docutils literal notranslate"><span class="pre">StateSelection.has_state()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.has_state_combination"><code class="docutils literal notranslate"><span class="pre">StateSelection.has_state_combination()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.auto_assign_colors"><code class="docutils literal notranslate"><span class="pre">StateSelection.auto_assign_colors()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.get_state_color"><code class="docutils literal notranslate"><span class="pre">StateSelection.get_state_color()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.get_state_combination_color"><code class="docutils literal notranslate"><span class="pre">StateSelection.get_state_combination_color()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.get_state_combination_degeneracy"><code class="docutils literal notranslate"><span class="pre">StateSelection.get_state_combination_degeneracy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.get_state_degeneracy"><code class="docutils literal notranslate"><span class="pre">StateSelection.get_state_degeneracy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.__add__"><code class="docutils literal notranslate"><span class="pre">StateSelection.__add__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.__or__"><code class="docutils literal notranslate"><span class="pre">StateSelection.__or__</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.__sub__"><code class="docutils literal notranslate"><span class="pre">StateSelection.__sub__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.__and__"><code class="docutils literal notranslate"><span class="pre">StateSelection.__and__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.__invert__"><code class="docutils literal notranslate"><span class="pre">StateSelection.__invert__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.union"><code class="docutils literal notranslate"><span class="pre">StateSelection.union</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.intersect"><code class="docutils literal notranslate"><span class="pre">StateSelection.intersect</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.difference"><code class="docutils literal notranslate"><span class="pre">StateSelection.difference</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelection.invert"><code class="docutils literal notranslate"><span class="pre">StateSelection.invert</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateCombination"><code class="docutils literal notranslate"><span class="pre">StateCombination</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateId"><code class="docutils literal notranslate"><span class="pre">StateId</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shnitsel.filtering.StateSelectionDescriptor"><code class="docutils literal notranslate"><span class="pre">StateSelectionDescriptor</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/api/shnitsel/filtering/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright 2026, Kevin Hllring, Theodor Everley Rhrkasten, Carolin Mller.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>