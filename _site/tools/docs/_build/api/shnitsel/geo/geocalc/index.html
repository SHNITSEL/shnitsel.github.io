<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>shnitsel.geo.geocalc &#8212; shnitsel-tools 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
    <script src="../../../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="shnitsel.geo.geomatch" href="../geomatch/index.html" />
    <link rel="prev" title="shnitsel.geo.analogs" href="../analogs/index.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-shnitsel.geo.geocalc">
<span id="shnitsel-geo-geocalc"></span><h1>shnitsel.geo.geocalc<a class="headerlink" href="#module-shnitsel.geo.geocalc" title="Link to this heading">¶</a></h1>
<p>This module will contain two types of closely-related functionality:
- generic geometry functions
- functions that use RDKit to identify internal coordinates, and then the above to calculate the values
Currently, the first category of function is found under postprocess</p>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.dnorm" title="shnitsel.geo.geocalc.dnorm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dnorm</span></code></a>(a)</p></td>
<td><p>Calculate the norm along the <cite>direction</cite> dimension. All other dimensions are maintaned</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.dcross" title="shnitsel.geo.geocalc.dcross"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dcross</span></code></a>(a, b)</p></td>
<td><p>Generalized cross vector product in the dimension of <cite>direction</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.ddot" title="shnitsel.geo.geocalc.ddot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ddot</span></code></a>(a, b)</p></td>
<td><p>Dot product in the dimension of <cite>direction</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.angle_" title="shnitsel.geo.geocalc.angle_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">angle_</span></code></a>(a, b)</p></td>
<td><p>Helper function to calculate the angle between the entries in a and b based on their coordinates in the <cite>direction</cite> dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.angle_cos_sin_" title="shnitsel.geo.geocalc.angle_cos_sin_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">angle_cos_sin_</span></code></a>(a, b)</p></td>
<td><p>returns the cosine and sine of the angle between two vectors</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.normal" title="shnitsel.geo.geocalc.normal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">normal</span></code></a>(a, b, c)</p></td>
<td><p>Calculate normal vectors on the planes through corresponding points in a, b and c.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.dihedral_" title="shnitsel.geo.geocalc.dihedral_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dihedral_</span></code></a>(a, b, c, d)</p></td>
<td><p>Function to calculate the limited (up to +-pi/2 radian) dihedral angle between the points in arrays a,b,c and d.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.full_dihedral_" title="shnitsel.geo.geocalc.full_dihedral_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">full_dihedral_</span></code></a>(a, b, c, d)</p></td>
<td><p>Function to calculate the signed/full dihedral angle (up to +-pi radian) between the points in arrays a,b,c and d.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.dihedral" title="shnitsel.geo.geocalc.dihedral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dihedral</span></code></a>(atXYZ, i, j, k, l, *[, deg, full])</p></td>
<td><p>Calculate all dihedral angles between the atoms specified.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.angle" title="shnitsel.geo.geocalc.angle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">angle</span></code></a>(atXYZ, i, j, k, *[, deg])</p></td>
<td><p>Method to calculate the angle between atoms i,j, and k in the positions DataArray throughout time.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.distance" title="shnitsel.geo.geocalc.distance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">distance</span></code></a>(atXYZ, i, j)</p></td>
<td><p>Method to calculate the various distances between atoms i and j throughout time</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc._ndarray_of_tuples" title="shnitsel.geo.geocalc._ndarray_of_tuples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_ndarray_of_tuples</span></code></a>(da, dim)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc._check_matches" title="shnitsel.geo.geocalc._check_matches"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_check_matches</span></code></a>(matches_or_mol, atXYZ[, fn])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc._positions" title="shnitsel.geo.geocalc._positions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_positions</span></code></a>(atXYZ, atom_idxs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc._assign_descriptor_coords" title="shnitsel.geo.geocalc._assign_descriptor_coords"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_assign_descriptor_coords</span></code></a>(obj, atom_idxs, bond_idxs, ...)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc._empty_results" title="shnitsel.geo.geocalc._empty_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">_empty_results</span></code></a>(atXYZ)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.get_bond_lengths" title="shnitsel.geo.geocalc.get_bond_lengths"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bond_lengths</span></code></a>(atXYZ[, matches_or_mol])</p></td>
<td><p>Identify bonds (using RDKit) and find the length of each bond in each</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.get_bond_angles" title="shnitsel.geo.geocalc.get_bond_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bond_angles</span></code></a>(atXYZ[, matches_or_mol, mol, ang])</p></td>
<td><p>Identify triples of bonded atoms (using RDKit) and calculate every bond angle for each</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.get_bond_torsions" title="shnitsel.geo.geocalc.get_bond_torsions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bond_torsions</span></code></a>(atXYZ[, matches_or_mol, signed, ang])</p></td>
<td><p>Identify quadruples of bonded atoms (using RDKit) and calculate the corresponding proper bond torsion for each</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.get_bats" title="shnitsel.geo.geocalc.get_bats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bats</span></code></a>(atXYZ[, matches_or_mol, signed, ang, pyr])</p></td>
<td><p>Get bond lengths, angles and torsions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.get_bla_chromophor" title="shnitsel.geo.geocalc.get_bla_chromophor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bla_chromophor</span></code></a>(atXYZ[, matches_or_mol, mol, ang])</p></td>
<td><p>Identify triples of bonded atoms (using RDKit) and calculate every bond angle for each</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.identify_pyramids" title="shnitsel.geo.geocalc.identify_pyramids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">identify_pyramids</span></code></a>(mol)</p></td>
<td><p>Identify atoms with three bonds (using RDKit), specifically chain-internal atoms with</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.pyramid_" title="shnitsel.geo.geocalc.pyramid_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyramid_</span></code></a>(a, b, c, x)</p></td>
<td><p>Method to calculate the pyramidalization angle of a quadruple of atoms.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.get_pyramids" title="shnitsel.geo.geocalc.get_pyramids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pyramids</span></code></a>(atXYZ[, pyramid_idxs, mol, deg, signed])</p></td>
<td><p>Identify atoms with three bonds (using RDKit) and calculate the corresponding pyramidalization angles</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.center_geoms" title="shnitsel.geo.geocalc.center_geoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">center_geoms</span></code></a>(atXYZ[, by_mass])</p></td>
<td><p>Helper function to set the center of the geometry (i.e. mean along the <cite>atom</cite> axis) to zero.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.rotational_procrustes_" title="shnitsel.geo.geocalc.rotational_procrustes_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotational_procrustes_</span></code></a>(A, B[, weight])</p></td>
<td><p>Rotationally align the geometrie(s) in A to the single geometry in B.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.rotational_procrustes" title="shnitsel.geo.geocalc.rotational_procrustes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotational_procrustes</span></code></a>(A, B[, dim0, dim1, weight])</p></td>
<td><p>Rotationally align the geometrie(s) in A to the single geometry in B.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.geo.geocalc.kabsch" title="shnitsel.geo.geocalc.kabsch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kabsch</span></code></a>(atXYZ[, reference_or_indexers])</p></td>
<td><p>Rotationally align the molecular geometries in <code class="docutils literal notranslate"><span class="pre">atXYZ</span></code> to a single molecular geometry</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.dnorm">
<span class="sig-name descname"><span class="pre">dnorm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.dnorm" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the norm along the <cite>direction</cite> dimension. All other dimensions are maintaned</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>a</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The data array to perform the norming on</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resulting dataarray after calculation of the norm in the dimension <a href="#id1"><span class="problematic" id="id2">`</span></a>direction.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray | xr.Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.dcross">
<span class="sig-name descname"><span class="pre">dcross</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.dcross" title="Link to this definition">¶</a></dt>
<dd><p>Generalized cross vector product in the dimension of <cite>direction</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The first array to use for the binary operation</p></li>
<li><p><strong>b</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The second array to use for the binary operation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting array of the cross-product</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray | xr.Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.ddot">
<span class="sig-name descname"><span class="pre">ddot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.ddot" title="Link to this definition">¶</a></dt>
<dd><p>Dot product in the dimension of <cite>direction</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The first array to use for the binary operation</p></li>
<li><p><strong>b</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The second array to use for the binary operation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting array of the dot-product still retaining all other dimensions except <cite>direction</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray | xr.Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.angle_">
<span class="sig-name descname"><span class="pre">angle_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.angle_" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to calculate the angle between the entries in a and b based on their coordinates in the <cite>direction</cite> dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The first array to use for the binary operation</p></li>
<li><p><strong>b</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The second array to use for the binary operation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting array of the angle calculation still retaining all other dimensions except <cite>direction</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray | xr.Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.angle_cos_sin_">
<span class="sig-name descname"><span class="pre">angle_cos_sin_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.angle_cos_sin_" title="Link to this definition">¶</a></dt>
<dd><p>returns the cosine and sine of the angle between two vectors</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.normal">
<span class="sig-name descname"><span class="pre">normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.normal" title="Link to this definition">¶</a></dt>
<dd><p>Calculate normal vectors on the planes through corresponding points in a, b and c.</p>
<p>The normal vector will be calculated based on the position in <cite>direction</cite> dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The first array to use for the ternary operation</p></li>
<li><p><strong>b</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The second array to use for the ternary operation</p></li>
<li><p><strong>c</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The third array to use for the ternary operation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array with all dimensions equal to those of a, b, and c but holding normal vectors along the <cite>direction</cite> dimension.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray | xr.Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.dihedral_">
<span class="sig-name descname"><span class="pre">dihedral_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.dihedral_" title="Link to this definition">¶</a></dt>
<dd><p>Function to calculate the limited (up to +-pi/2 radian) dihedral angle between the points in arrays a,b,c and d.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The first array to use for the operation</p></li>
<li><p><strong>b</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The second array to use for the operation</p></li>
<li><p><strong>c</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The third array to use for the operation</p></li>
<li><p><strong>d</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The fourth array to use for the operation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The array of dihedral angels between the four input arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray | xr.Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.full_dihedral_">
<span class="sig-name descname"><span class="pre">full_dihedral_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.full_dihedral_" title="Link to this definition">¶</a></dt>
<dd><p>Function to calculate the signed/full dihedral angle (up to +-pi radian) between the points in arrays a,b,c and d.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The first array to use for the operation</p></li>
<li><p><strong>b</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The second array to use for the operation</p></li>
<li><p><strong>c</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The third array to use for the operation</p></li>
<li><p><strong>d</strong> (<em>xr.DataArray</em><em> | </em><em>xr.Variable</em>) – The fourth array to use for the operation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The array of full signed dihedral angels between the four input arrays.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray | xr.Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.dihedral">
<span class="sig-name descname"><span class="pre">dihedral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.dihedral" title="Link to this definition">¶</a></dt>
<dd><p>Calculate all dihedral angles between the atoms specified.
The atoms specified needed be bonded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<em>shnitsel.core.typedefs.AtXYZ</em>) – A <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> of coordinates, with <code class="docutils literal notranslate"><span class="pre">atom</span></code> and <code class="docutils literal notranslate"><span class="pre">direction</span></code> dimensions</p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The four atom indices</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The four atom indices</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The four atom indices</p></li>
<li><p><strong>l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – The four atom indices</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to return angles in degrees (True) or radians (False), by default False</p></li>
<li><p><strong>full</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to return signed angles between -180° and 180° (True) or unsigned angles between 0 and 180° (False), by default False</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">DataArray</span></code> containing dihedral angles</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.angle">
<span class="sig-name descname"><span class="pre">angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.angle" title="Link to this definition">¶</a></dt>
<dd><p>Method to calculate the angle between atoms i,j, and k in the positions DataArray throughout time.</p>
<p>Can return results in radian (default) and degrees (if <cite>deg=True</cite>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<em>AtXYZ</em>) – DataArray with positions</p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index of first atom</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index of second atom</p></li>
<li><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index of third atom</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>) – Flag whether the results should be in degrees instead of radian. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting angles between the denoted atoms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.distance" title="Link to this definition">¶</a></dt>
<dd><p>Method to calculate the various distances between atoms i and j throughout time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<em>AtXYZ</em>) – Array with atom positions</p></li>
<li><p><strong>i</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index of the first atom</p></li>
<li><p><strong>j</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index of the second atom</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The resulting array holding the pairwise distance between i and j.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc._ndarray_of_tuples">
<span class="sig-name descname"><span class="pre">_ndarray_of_tuples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">da</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc._ndarray_of_tuples" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc._check_matches">
<span class="sig-name descname"><span class="pre">_check_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matches_or_mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">flag_bats</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc._check_matches" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc._positions">
<span class="sig-name descname"><span class="pre">_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_idxs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc._positions" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc._assign_descriptor_coords">
<span class="sig-name descname"><span class="pre">_assign_descriptor_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_idxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_idxs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fragment_objs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tex_pattern</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_atom_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc._assign_descriptor_coords" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>)</p></li>
<li><p><strong>atom_idxs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>]</em><em>]</em>)</p></li>
<li><p><strong>bond_idxs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>]</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)">xarray.DataArray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc._empty_results">
<span class="sig-name descname"><span class="pre">_empty_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc._empty_results" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.get_bond_lengths">
<span class="sig-name descname"><span class="pre">get_bond_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches_or_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.get_bond_lengths" title="Link to this definition">¶</a></dt>
<dd><p>Identify bonds (using RDKit) and find the length of each bond in each
frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of molecular coordinates, with dimensions
<cite>frame</cite>, <cite>atom</cite> and <cite>direction</cite></p></li>
<li><p><strong>matches_or_mol</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> | </em><em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – A list containing information for each internal coordinate to be calculated.
It may be convenient to use <a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_dihedrals" title="shnitsel.geo.geomatch.flag_dihedrals"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_dihedrals()</span></code></a>
to create a dictionary in the correct format, and then customize it.
Alternatively, you may supply an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is passed to
<a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_bats" title="shnitsel.geo.geomatch.flag_bats"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_bats()</span></code></a>.
If this argument is omitted altogether, an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object is generated
using <a class="reference internal" href="../../bridges/index.html#shnitsel.bridges.default_mol" title="shnitsel.bridges.default_mol"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.bridges.default_mol()</span></code></a> and used as above.</p></li>
<li><p><strong>optional</strong> – A list containing information for each internal coordinate to be calculated.
It may be convenient to use <a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_dihedrals" title="shnitsel.geo.geomatch.flag_dihedrals"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_dihedrals()</span></code></a>
to create a dictionary in the correct format, and then customize it.
Alternatively, you may supply an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is passed to
<a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_bats" title="shnitsel.geo.geomatch.flag_bats"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_bats()</span></code></a>.
If this argument is omitted altogether, an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object is generated
using <a class="reference internal" href="../../bridges/index.html#shnitsel.bridges.default_mol" title="shnitsel.bridges.default_mol"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.bridges.default_mol()</span></code></a> and used as above.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of bond lengths with dimensions <cite>frame</cite> and <cite>bond</cite>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#UserWarning" title="(in Python v3.14)"><strong>UserWarning</strong></a> – If both <cite>matches</cite> and <cite>mol</cite> are specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.get_bond_angles">
<span class="sig-name descname"><span class="pre">get_bond_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches_or_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.get_bond_angles" title="Link to this definition">¶</a></dt>
<dd><p>Identify triples of bonded atoms (using RDKit) and calculate every bond angle for each
frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of molecular coordinates, with dimensions
<cite>frame</cite>, <cite>atom</cite> and <cite>direction</cite></p></li>
<li><p><strong>matches_or_mol</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> | </em><em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – A list containing information for each internal coordinate to be calculated.
It may be convenient to use <a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_angles" title="shnitsel.geo.geomatch.flag_angles"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_angles()</span></code></a>
to create a dictionary in the correct format, and then customize it.
Alternatively, you may supply an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is passed to
<a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_bats" title="shnitsel.geo.geomatch.flag_bats"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_bats()</span></code></a>.
If this argument is omitted altogether, an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object is generated
using <a class="reference internal" href="../../bridges/index.html#shnitsel.bridges.default_mol" title="shnitsel.bridges.default_mol"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.bridges.default_mol()</span></code></a> and used as above.</p></li>
<li><p><strong>optional</strong> – A list containing information for each internal coordinate to be calculated.
It may be convenient to use <a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_angles" title="shnitsel.geo.geomatch.flag_angles"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_angles()</span></code></a>
to create a dictionary in the correct format, and then customize it.
Alternatively, you may supply an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is passed to
<a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_bats" title="shnitsel.geo.geomatch.flag_bats"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_bats()</span></code></a>.
If this argument is omitted altogether, an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object is generated
using <a class="reference internal" href="../../bridges/index.html#shnitsel.bridges.default_mol" title="shnitsel.bridges.default_mol"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.bridges.default_mol()</span></code></a> and used as above.</p></li>
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – An RDKit <cite>Mol</cite> object, which is generated from <cite>atXYZ</cite> if this argument is omitted.</p></li>
<li><p><strong>optional</strong> – An RDKit <cite>Mol</cite> object, which is generated from <cite>atXYZ</cite> if this argument is omitted.</p></li>
<li><p><strong>ang</strong> (<em>Literal</em><em>[</em><em>False</em><em>, </em><em>'deg'</em><em>, </em><em>'rad'</em><em>]</em>) – If False (the default), returns sines and cosines;
if set to ‘deg’, returns angles in degrees
if set to ‘rad’, returns angles in radians</p></li>
<li><p><strong>optional</strong> – If False (the default), returns sines and cosines;
if set to ‘deg’, returns angles in degrees
if set to ‘rad’, returns angles in radians</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of bond angles with dimensions <cite>frame</cite> and <cite>angle</cite>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#UserWarning" title="(in Python v3.14)"><strong>UserWarning</strong></a> – If both <cite>matches</cite> and <cite>mol</cite> are specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.get_bond_torsions">
<span class="sig-name descname"><span class="pre">get_bond_torsions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches_or_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.get_bond_torsions" title="Link to this definition">¶</a></dt>
<dd><p>Identify quadruples of bonded atoms (using RDKit) and calculate the corresponding proper bond torsion for each
frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of molecular coordinates, with dimensions
<cite>frame</cite>, <cite>atom</cite> and <cite>direction</cite></p></li>
<li><p><strong>matches_or_mol</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> | </em><em>None</em>) – A list containing information for each internal coordinate to be calculated.
It may be convenient to use <a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_dihedrals" title="shnitsel.geo.geomatch.flag_dihedrals"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_dihedrals()</span></code></a>
to create a dictionary in the correct format, and then customize it.
Alternatively, you may supply an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is passed to
<a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_bats" title="shnitsel.geo.geomatch.flag_bats"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_bats()</span></code></a>.
If this argument is omitted altogether, an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object is generated
using <a class="reference internal" href="../../bridges/index.html#shnitsel.bridges.default_mol" title="shnitsel.bridges.default_mol"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.bridges.default_mol()</span></code></a> and used as above.</p></li>
<li><p><strong>optional</strong> – A list containing information for each internal coordinate to be calculated.
It may be convenient to use <a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_dihedrals" title="shnitsel.geo.geomatch.flag_dihedrals"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_dihedrals()</span></code></a>
to create a dictionary in the correct format, and then customize it.
Alternatively, you may supply an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is passed to
<a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_bats" title="shnitsel.geo.geomatch.flag_bats"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_bats()</span></code></a>.
If this argument is omitted altogether, an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object is generated
using <a class="reference internal" href="../../bridges/index.html#shnitsel.bridges.default_mol" title="shnitsel.bridges.default_mol"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.bridges.default_mol()</span></code></a> and used as above.</p></li>
<li><p><strong>signed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em> | </em><em>None</em>) – Whether to distinguish between clockwise and anticlockwise rotation,
when returning angles; by default, do not distinguish.</p></li>
<li><p><strong>optional</strong> – Whether to distinguish between clockwise and anticlockwise rotation,
when returning angles; by default, do not distinguish.</p></li>
<li><p><strong>ang</strong> (<em>Literal</em><em>[</em><em>False</em><em>, </em><em>'deg'</em><em>, </em><em>'rad'</em><em>]</em>) – If False (the default), returns sines and cosines;
if set to ‘deg’, returns angles in degrees
if set to ‘rad’, returns angles in radians</p></li>
<li><p><strong>optional</strong> – If False (the default), returns sines and cosines;
if set to ‘deg’, returns angles in degrees
if set to ‘rad’, returns angles in radians</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of bond torsions with dimensions <cite>frame</cite> and <cite>torsion</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.get_bats">
<span class="sig-name descname"><span class="pre">get_bats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches_or_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.get_bats" title="Link to this definition">¶</a></dt>
<dd><p>Get bond lengths, angles and torsions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>) – The coordinates to use.</p></li>
<li><p><strong>matches_or_mol</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> | </em><em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – An rdkit Mol object used to determine connectivity; by default this is
determined automatically based on the first frame of <code class="docutils literal notranslate"><span class="pre">atXYZ</span></code>.
Alternatively, a dictionary containing match information, as produced
by one of the <code class="docutils literal notranslate"><span class="pre">flag_*</span></code> functions.</p></li>
<li><p><strong>optional</strong> – An rdkit Mol object used to determine connectivity; by default this is
determined automatically based on the first frame of <code class="docutils literal notranslate"><span class="pre">atXYZ</span></code>.
Alternatively, a dictionary containing match information, as produced
by one of the <code class="docutils literal notranslate"><span class="pre">flag_*</span></code> functions.</p></li>
<li><p><strong>signed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em> | </em><em>None</em>) – Whether to distinguish between clockwise and anticlockwise rotation,
when returning angles as opposed to cosine &amp; sine values;
by default, do not distinguish.
NB. This applies only to the dihedrals, not to the three-center angles.
The latter are always unsigned.</p></li>
<li><p><strong>optional</strong> – Whether to distinguish between clockwise and anticlockwise rotation,
when returning angles as opposed to cosine &amp; sine values;
by default, do not distinguish.
NB. This applies only to the dihedrals, not to the three-center angles.
The latter are always unsigned.</p></li>
<li><p><strong>ang</strong> (<em>Literal</em><em>[</em><em>False</em><em>, </em><em>'deg'</em><em>, </em><em>'rad'</em><em>]</em>) – If False (the default), returns sines and cosines;
if set to ‘deg’, returns angles in degrees
if set to ‘rad’, returns angles in radians</p></li>
<li><p><strong>optional</strong> – If False (the default), returns sines and cosines;
if set to ‘deg’, returns angles in degrees
if set to ‘rad’, returns angles in radians</p></li>
<li><p><strong>pyr</strong> – Whether to include pyramidalizations from <code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.get_pyramids()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> containing bond lengths, angles and tensions.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">shnitsel</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">shnitsel.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">geom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frames</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">open_frames</span><span class="p">(</span><span class="s1">&#39;/tmp/A03_filtered.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geom</span><span class="o">.</span><span class="n">get_bats</span><span class="p">(</span><span class="n">frames</span><span class="p">[</span><span class="s1">&#39;atXYZ&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.get_bla_chromophor">
<span class="sig-name descname"><span class="pre">get_bla_chromophor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matches_or_mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ang</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.get_bla_chromophor" title="Link to this definition">¶</a></dt>
<dd><p>Identify triples of bonded atoms (using RDKit) and calculate every bond angle for each
frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of molecular coordinates, with dimensions
<cite>frame</cite>, <cite>atom</cite> and <cite>direction</cite></p></li>
<li><p><strong>matches_or_mol</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> | </em><em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – A list containing information for each internal coordinate to be calculated.
It may be convenient to use <a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_angles" title="shnitsel.geo.geomatch.flag_angles"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_angles()</span></code></a>
to create a dictionary in the correct format, and then customize it.
Alternatively, you may supply an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is passed to
<a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_bats" title="shnitsel.geo.geomatch.flag_bats"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_bats()</span></code></a>.
If this argument is omitted altogether, an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object is generated
using <a class="reference internal" href="../../bridges/index.html#shnitsel.bridges.default_mol" title="shnitsel.bridges.default_mol"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.bridges.default_mol()</span></code></a> and used as above.</p></li>
<li><p><strong>optional</strong> – A list containing information for each internal coordinate to be calculated.
It may be convenient to use <a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_angles" title="shnitsel.geo.geomatch.flag_angles"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_angles()</span></code></a>
to create a dictionary in the correct format, and then customize it.
Alternatively, you may supply an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is passed to
<a class="reference internal" href="../geomatch/index.html#shnitsel.geo.geomatch.flag_bats" title="shnitsel.geo.geomatch.flag_bats"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.geo.geomatch.flag_bats()</span></code></a>.
If this argument is omitted altogether, an RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object is generated
using <a class="reference internal" href="../../bridges/index.html#shnitsel.bridges.default_mol" title="shnitsel.bridges.default_mol"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.bridges.default_mol()</span></code></a> and used as above.</p></li>
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em><em> | </em><em>None</em>)</p></li>
<li><p><strong>ang</strong> (<em>Literal</em><em>[</em><em>False</em><em>, </em><em>'deg'</em><em>, </em><em>'rad'</em><em>]</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of bond angles with dimensions <cite>frame</cite> and <cite>angle</cite>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#UserWarning" title="(in Python v3.14)"><strong>UserWarning</strong></a> – If both <cite>matches</cite> and <cite>mol</cite> are specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.identify_pyramids">
<span class="sig-name descname"><span class="pre">identify_pyramids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.identify_pyramids" title="Link to this definition">¶</a></dt>
<dd><p>Identify atoms with three bonds (using RDKit), specifically chain-internal atoms with
a single carbon, and chain-terminal atoms with two carbons.</p>
<p>Each ‘pyramid’ consists of four atoms. Three of these (the “plane” atoms) are consecutive, and the fourth (the “bending” atom)
is bonded to the middle atom of the plane atoms. The pyramidalization is the the angle between the plane of the plane atoms
and the bond from the middle plane atom to the bending atom.</p>
<p>Two sorts of pyramids are currently handled: terminal and chain-internal.</p>
<ul class="simple">
<li><p>Terminal pyramids are those where the central atom is bonded to two hydrogens and a single non-hydrogen;
for these, the central atom and the <strong>hydrogens</strong> constitute the plane and the non-hydrogen becomes the bending atom.</p></li>
<li><p>Chain-internal pyramids are those where the central atom is bonded to non-hydrogens and a single hydrogen;
for these, the central atom and the <strong>non-hydrogens</strong> constitute the plane and the hydrogen becomes the bending atom.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>) – An RDKit Mol object</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>dict</em> –</p>
<dl class="simple">
<dt>{</dt><dd><p>x1: (a1, b1, c1),
x2: (a2, b2, c2),
…</p>
</dd>
</dl>
<p>}</p>
</li>
<li><p><em>where</em> –</p>
<ul class="simple">
<li><p>a, b, c are indices of contiguous atoms used to determine the plane</p></li>
<li><p>x is the index of an atom bonded to atom b, considered to be bending</p></li>
</ul>
<p>above and beneath the plane</p>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.pyramid_">
<span class="sig-name descname"><span class="pre">pyramid_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.pyramid_" title="Link to this definition">¶</a></dt>
<dd><p>Method to calculate the pyramidalization angle of a quadruple of atoms.</p>
<p>The result will be pi/2 minus the angle between the normal of ABC and the vector BX.
(I.e.: the pyramidalization at atom b)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>xr.DataArray</em>) – The first array to use for the operation</p></li>
<li><p><strong>b</strong> (<em>xr.DataArray</em>) – The second array to use for the operation</p></li>
<li><p><strong>c</strong> (<em>xr.DataArray</em>) – The third array to use for the operation</p></li>
<li><p><strong>x</strong> (<em>xr.DataArray</em>) – The fourth array to use for the operation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The array of pyramidalization angles</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xr.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.get_pyramids">
<span class="sig-name descname"><span class="pre">get_pyramids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyramid_idxs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.get_pyramids" title="Link to this definition">¶</a></dt>
<dd><p>Identify atoms with three bonds (using RDKit) and calculate the corresponding pyramidalization angles
for each frame.</p>
<p>Each ‘pyramid’ consists of four atoms. Three of these (the “plane” atoms) are consecutive, and the fourth (the “bending” atom)
is bonded to the middle atom of the plane atoms. The pyramidalization is the the angle between the plane of the plane atoms
and the bond from the middle plane atom to the bending atom.</p>
<p>Two sorts of pyramids are currently handled: terminal and chain-internal.</p>
<ul class="simple">
<li><p>Terminal pyramids are those where the central atom is bonded to two hydrogens and a single non-hydrogen;
for these, the central atom and the <strong>hydrogens</strong> constitute the plane and the non-hydrogen becomes the bending atom.</p></li>
<li><p>Chain-internal pyramids are those where the central atom is bonded to non-hydrogens and a single hydrogen;
for these, the central atom and the <strong>non-hydrogens</strong> constitute the plane and the hydrogen becomes the bending atom.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of molecular coordinates, with dimensions
<code class="docutils literal notranslate"><span class="pre">frame</span></code>, <code class="docutils literal notranslate"><span class="pre">atom</span></code> and <code class="docutils literal notranslate"><span class="pre">direction</span></code></p></li>
<li><p><strong>pyramid_idxs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>]</em><em>] </em><em>| </em><em>None</em>) – A dictionary containing types of bonds as keys, and lists of atom index pair
as values. It may be convenient to use <code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.identify_pyramids()</span></code>
to create a dictionary in the correct format, and then customize it. If omitted,
relevant sets of atoms are identified automatically based on the <code class="docutils literal notranslate"><span class="pre">mol</span></code> argument.</p></li>
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – An RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is generated from <code class="docutils literal notranslate"><span class="pre">atXYZ</span></code> if this argument is omitted.</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to return angles in degrees (as opposed to radians), by default False</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of pyramidalizations with dimensions <code class="docutils literal notranslate"><span class="pre">frame</span></code> and <code class="docutils literal notranslate"><span class="pre">atom</span></code>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#UserWarning" title="(in Python v3.14)"><strong>UserWarning</strong></a> – If both <cite>pyramid_idxs</cite> and <cite>mol</cite> are specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.center_geoms">
<span class="sig-name descname"><span class="pre">center_geoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.center_geoms" title="Link to this definition">¶</a></dt>
<dd><p>Helper function to set the center of the geometry (i.e. mean along the <cite>atom</cite> axis) to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<em>AtXYZ</em>) – Array of positional data</p></li>
<li><p><strong>by_mass</strong> (<em>Literal</em><em>[</em><em>False</em><em>]</em><em>, </em><em>optional</em>) – Flag whether the centering/average should be center of mass or just plain average of positions. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.14)"><strong>NotImplementedError</strong></a> – Centering the COM instead of the mean is currently not implemented.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Resulting positions after centering.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>AtXYZ</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.rotational_procrustes_">
<span class="sig-name descname"><span class="pre">rotational_procrustes_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.rotational_procrustes_" title="Link to this definition">¶</a></dt>
<dd><p>Rotationally align the geometrie(s) in A to the single geometry in B.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – The geometries to process with shape
<code class="docutils literal notranslate"><span class="pre">(n_geometries,</span> <span class="pre">n_points,</span> <span class="pre">n_coordinates)</span></code></p></li>
<li><p><strong>B</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><em>numpy.ndarray</em></a>) – The reference geometry with shape
<code class="docutils literal notranslate"><span class="pre">(n_points,</span> <span class="pre">n_coordinates)</span></code></p></li>
<li><p><strong>weight</strong> (<em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>] </em><em>| </em><em>None</em>) – How much importance should be given to the alignment of
each point, by default equal importance</p></li>
<li><p><strong>optional</strong> – How much importance should be given to the alignment of
each point, by default equal importance</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An array with the same shape as A</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.rotational_procrustes">
<span class="sig-name descname"><span class="pre">rotational_procrustes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'atom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'direction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.rotational_procrustes" title="Link to this definition">¶</a></dt>
<dd><p>Rotationally align the geometrie(s) in A to the single geometry in B.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>) – The geometries to process</p></li>
<li><p><strong>B</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>) – The reference geometry</p></li>
<li><p><strong>dim0</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the dimension over points to be rotated;
must be present in <code class="docutils literal notranslate"><span class="pre">A</span></code> and <a href="#id3"><span class="problematic" id="id4">``</span></a>B`; by default ‘atom’</p></li>
<li><p><strong>optional</strong> – The name of the dimension over points to be rotated;
must be present in <code class="docutils literal notranslate"><span class="pre">A</span></code> and <a href="#id5"><span class="problematic" id="id6">``</span></a>B`; by default ‘atom’</p></li>
<li><p><strong>dim1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the dimension over the coordinates of the aforementioned
points; must be present in <code class="docutils literal notranslate"><span class="pre">A</span></code> and <a href="#id7"><span class="problematic" id="id8">``</span></a>B`; by default ‘direction’</p></li>
<li><p><strong>optional</strong> – The name of the dimension over the coordinates of the aforementioned
points; must be present in <code class="docutils literal notranslate"><span class="pre">A</span></code> and <a href="#id9"><span class="problematic" id="id10">``</span></a>B`; by default ‘direction’</p></li>
<li><p><strong>weight</strong> (<em>Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>] </em><em>| </em><em>None</em>) – How much importance should be given to the alignment of
each point (atom), by default equal importance</p></li>
<li><p><strong>optional</strong> – How much importance should be given to the alignment of
each point (atom), by default equal importance</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An xr.DataArray with the same shape as <code class="docutils literal notranslate"><span class="pre">A</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.geo.geocalc.kabsch">
<span class="sig-name descname"><span class="pre">kabsch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_or_indexers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">indexers_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.geo.geocalc.kabsch" title="Link to this definition">¶</a></dt>
<dd><p>Rotationally align the molecular geometries in <code class="docutils literal notranslate"><span class="pre">atXYZ</span></code> to a single molecular geometry</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a>) – The geometries to process (with dims ‘atom’, ‘direction’)</p></li>
<li><p><strong>reference_or_indexers</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.12.0)"><em>xarray.DataArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> | </em><em>None</em>) – Either a reference geometry (with dims ‘atom’, ‘direction’)
or an indexer dictionary which will be passed to <code class="docutils literal notranslate"><span class="pre">atXYZ.sel()</span></code></p></li>
<li><p><strong>optional</strong> – Either a reference geometry (with dims ‘atom’, ‘direction’)
or an indexer dictionary which will be passed to <code class="docutils literal notranslate"><span class="pre">atXYZ.sel()</span></code></p></li>
<li><p><strong>**indexer_kwargs</strong> – The keyword-argument form of the indexer to be passed to <code class="docutils literal notranslate"><span class="pre">atXYZ.sel()</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>The aligned geometries</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a> – If nothing is done to indicate a reference geometry, i.e.
neither reference_or_indexers nor indexer_kwargs are passed</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">shnitsel-tools</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../top-level.html">Top-level functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../accessors/ds_accessors.html">Dataset accessor methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../accessors/da_accessors.html">DataArray accessor methods</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">API Reference</a><ul>
  <li><a href="../../index.html">shnitsel</a><ul>
  <li><a href="../index.html">shnitsel.geo</a><ul>
      <li>Previous: <a href="../analogs/index.html" title="previous chapter">shnitsel.geo.analogs</a></li>
      <li>Next: <a href="../geomatch/index.html" title="next chapter">shnitsel.geo.geomatch</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Theodor Everley Röhrkasten, Carolin Müller.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../../_sources/api/shnitsel/geo/geocalc/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>