<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>shnitsel.core.geom &#8212; shnitsel-tools 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
    <script src="../../../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="shnitsel.core.indexes" href="../indexes/index.html" />
    <link rel="prev" title="shnitsel.core.filtre" href="../filtre/index.html" />
   
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-shnitsel.core.geom">
<span id="shnitsel-core-geom"></span><h1>shnitsel.core.geom<a class="headerlink" href="#module-shnitsel.core.geom" title="Link to this heading">¶</a></h1>
<p>This module will contain two types of closely-related functionality:
- generic geometry functions
- functions that use RDKit to identify internal coordinates, and then the above to calculate the values
Currently, the first category of function is found under postprocess</p>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.core.geom.bond_type_to_symbols" title="shnitsel.core.geom.bond_type_to_symbols"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bond_type_to_symbols</span></code></a>(e1, e2)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.core.geom.identify_bonds" title="shnitsel.core.geom.identify_bonds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">identify_bonds</span></code></a>(mol[, symbols])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.core.geom.get_bond_lengths" title="shnitsel.core.geom.get_bond_lengths"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bond_lengths</span></code></a>(atXYZ[, bond_types, mol])</p></td>
<td><p>Identify bonds (using RDKit) and find the length of each bond in each</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.core.geom.identify_angles" title="shnitsel.core.geom.identify_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">identify_angles</span></code></a>(mol)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.core.geom.get_bond_angles" title="shnitsel.core.geom.get_bond_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bond_angles</span></code></a>(atXYZ[, angle_types, mol, deg])</p></td>
<td><p>Identify triples of bonded atoms (using RDKit) and calculate every bond angle for each</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.core.geom.identify_torsions" title="shnitsel.core.geom.identify_torsions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">identify_torsions</span></code></a>(mol)</p></td>
<td><p>Finds sets of four contiguous atoms that form a torsion</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.core.geom.get_bond_torsions" title="shnitsel.core.geom.get_bond_torsions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bond_torsions</span></code></a>(atXYZ[, quadruple_types, mol, ...])</p></td>
<td><p>Identify quadruples of bonded atoms (using RDKit) and calculate the corresponding proper bond torsion for each</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.core.geom.get_bats" title="shnitsel.core.geom.get_bats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_bats</span></code></a>(atXYZ[, mol, signed, deg, pyr])</p></td>
<td><p>Get bond lengths, angles and torsions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.core.geom.identify_pyramids" title="shnitsel.core.geom.identify_pyramids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">identify_pyramids</span></code></a>(mol)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.core.geom.pyramid_" title="shnitsel.core.geom.pyramid_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pyramid_</span></code></a>(a, b, c, x)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.core.geom.get_pyramids" title="shnitsel.core.geom.get_pyramids"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_pyramids</span></code></a>(atXYZ[, pyramid_idxs, mol, deg, signed])</p></td>
<td><p>Identify atoms with three bonds (using RDKit) and calculate the corresponding pyramidalization angles</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.core.geom.center_geoms" title="shnitsel.core.geom.center_geoms"><code class="xref py py-obj docutils literal notranslate"><span class="pre">center_geoms</span></code></a>(atXYZ[, by_mass])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.core.geom.rotational_procrustes_" title="shnitsel.core.geom.rotational_procrustes_"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotational_procrustes_</span></code></a>(A, B[, weight])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#shnitsel.core.geom.rotational_procrustes" title="shnitsel.core.geom.rotational_procrustes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rotational_procrustes</span></code></a>(A, B[, dim0, dim1, weight])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#shnitsel.core.geom.kabsch" title="shnitsel.core.geom.kabsch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kabsch</span></code></a>(atXYZ[, reference_or_indexers])</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.bond_type_to_symbols">
<span class="sig-name descname"><span class="pre">bond_type_to_symbols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.bond_type_to_symbols" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.identify_bonds">
<span class="sig-name descname"><span class="pre">identify_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.identify_bonds" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>)</p></li>
<li><p><strong>symbols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.get_bond_lengths">
<span class="sig-name descname"><span class="pre">get_bond_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.get_bond_lengths" title="Link to this definition">¶</a></dt>
<dd><p>Identify bonds (using RDKit) and find the length of each bond in each
frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><em>xarray.DataArray</em></a>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of molecular coordinates, with dimensions
<cite>frame</cite>, <cite>atom</cite> and <cite>direction</cite></p></li>
<li><p><strong>bond_types</strong> – A dictionary containing types of bonds as keys, and lists of atom index pair
as values. It may be convenient to use <a class="reference internal" href="#shnitsel.core.geom.identify_bonds" title="shnitsel.core.geom.identify_bonds"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.identify_bonds()</span></code></a>
to create a dictionary in the correct format, and then customize it. If omitted,
bonds are identified automatically based on the <cite>mol</cite> argument.</p></li>
<li><p><strong>optional</strong> – A dictionary containing types of bonds as keys, and lists of atom index pair
as values. It may be convenient to use <a class="reference internal" href="#shnitsel.core.geom.identify_bonds" title="shnitsel.core.geom.identify_bonds"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.identify_bonds()</span></code></a>
to create a dictionary in the correct format, and then customize it. If omitted,
bonds are identified automatically based on the <cite>mol</cite> argument.</p></li>
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – An RDKit <cite>Mol</cite> object, which is generated from <cite>atXYZ</cite> if this argument is omitted.</p></li>
<li><p><strong>optional</strong> – An RDKit <cite>Mol</cite> object, which is generated from <cite>atXYZ</cite> if this argument is omitted.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of bond lengths with dimensions <cite>frame</cite> and <cite>bond</cite>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#UserWarning" title="(in Python v3.14)"><strong>UserWarning</strong></a> – If both <cite>bond_types</cite> and <cite>mol</cite> are specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.identify_angles">
<span class="sig-name descname"><span class="pre">identify_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.identify_angles" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.10.1)">xarray.Dataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.get_bond_angles">
<span class="sig-name descname"><span class="pre">get_bond_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.get_bond_angles" title="Link to this definition">¶</a></dt>
<dd><p>Identify triples of bonded atoms (using RDKit) and calculate every bond angle for each
frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><em>xarray.DataArray</em></a>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of molecular coordinates, with dimensions
<cite>frame</cite>, <cite>atom</cite> and <cite>direction</cite></p></li>
<li><p><strong>angle_types</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.10.1)"><em>xarray.Dataset</em></a><em> | </em><em>None</em>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a> containing atom indices, atomic numbers, bond types, angle type
and angle symbol for each angle to be calculated.
It may be convenient to use <a class="reference internal" href="#shnitsel.core.geom.identify_angles" title="shnitsel.core.geom.identify_angles"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.identify_angles()</span></code></a>
to create a Dataset in the correct format, and then customize it. If omitted,
angles are identified automatically based on the <cite>mol</cite> argument.</p></li>
<li><p><strong>optional</strong> – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a> containing atom indices, atomic numbers, bond types, angle type
and angle symbol for each angle to be calculated.
It may be convenient to use <a class="reference internal" href="#shnitsel.core.geom.identify_angles" title="shnitsel.core.geom.identify_angles"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.identify_angles()</span></code></a>
to create a Dataset in the correct format, and then customize it. If omitted,
angles are identified automatically based on the <cite>mol</cite> argument.</p></li>
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – An RDKit <cite>Mol</cite> object, which is generated from <cite>atXYZ</cite> if this argument is omitted.</p></li>
<li><p><strong>optional</strong> – An RDKit <cite>Mol</cite> object, which is generated from <cite>atXYZ</cite> if this argument is omitted.</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to return angles in degrees (as opposed to radians), by default False</p></li>
<li><p><strong>optional</strong> – Whether to return angles in degrees (as opposed to radians), by default False</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of bond angles with dimensions <cite>frame</cite> and <cite>angle</cite>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#UserWarning" title="(in Python v3.14)"><strong>UserWarning</strong></a> – If both <cite>angle_types</cite> and <cite>mol</cite> are specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.identify_torsions">
<span class="sig-name descname"><span class="pre">identify_torsions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.identify_torsions" title="Link to this definition">¶</a></dt>
<dd><p>Finds sets of four contiguous atoms that form a torsion</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.10.1)">xarray.Dataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.get_bond_torsions">
<span class="sig-name descname"><span class="pre">get_bond_torsions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quadruple_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.get_bond_torsions" title="Link to this definition">¶</a></dt>
<dd><p>Identify quadruples of bonded atoms (using RDKit) and calculate the corresponding proper bond torsion for each
frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><em>xarray.DataArray</em></a>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of molecular coordinates, with dimensions
<cite>frame</cite>, <cite>atom</cite> and <cite>direction</cite></p></li>
<li><p><strong>quadruple_types</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.10.1)"><em>xarray.Dataset</em></a><em> | </em><em>None</em>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a> containing atom indices, atomic numbers, bond types, torsion type
and torsion symbol for each angle to be calculated.
It may be convenient to use <a class="reference internal" href="#shnitsel.core.geom.identify_torsions" title="shnitsel.core.geom.identify_torsions"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.identify_torsions()</span></code></a>
to create a Dataset in the correct format, and then customize it. If omitted,
angles are identified automatically based on the <cite>mol</cite> argument.</p></li>
<li><p><strong>optional</strong> – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.Dataset.html#xarray.Dataset" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.Dataset</span></code></a> containing atom indices, atomic numbers, bond types, torsion type
and torsion symbol for each angle to be calculated.
It may be convenient to use <a class="reference internal" href="#shnitsel.core.geom.identify_torsions" title="shnitsel.core.geom.identify_torsions"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.identify_torsions()</span></code></a>
to create a Dataset in the correct format, and then customize it. If omitted,
angles are identified automatically based on the <cite>mol</cite> argument.</p></li>
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – An RDKit <cite>Mol</cite> object, which is generated from <cite>atXYZ</cite> if this argument is omitted.</p></li>
<li><p><strong>optional</strong> – An RDKit <cite>Mol</cite> object, which is generated from <cite>atXYZ</cite> if this argument is omitted.</p></li>
<li><p><strong>signed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to distinguish between clockwise and anticlockwise rotation, by default False</p></li>
<li><p><strong>optional</strong> – Whether to distinguish between clockwise and anticlockwise rotation, by default False</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to return angles in degrees (as opposed to radians), by default False</p></li>
<li><p><strong>optional</strong> – Whether to return angles in degrees (as opposed to radians), by default False</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of bond torsions with dimensions <cite>frame</cite> and <cite>torsion</cite>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#UserWarning" title="(in Python v3.14)"><strong>UserWarning</strong></a> – If both <cite>torsion_types</cite> and <cite>mol</cite> are specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.get_bats">
<span class="sig-name descname"><span class="pre">get_bats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.get_bats" title="Link to this definition">¶</a></dt>
<dd><p>Get bond lengths, angles and torsions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><em>xarray.DataArray</em></a>) – The coordinates to use.</p></li>
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – An rdkit Mol object used to determine connectivity; by default this is
determined automatically based on the first frame of <code class="docutils literal notranslate"><span class="pre">atXYZ</span></code>.</p></li>
<li><p><strong>optional</strong> – An rdkit Mol object used to determine connectivity; by default this is
determined automatically based on the first frame of <code class="docutils literal notranslate"><span class="pre">atXYZ</span></code>.</p></li>
<li><p><strong>pyr</strong> – Whether to include pyramidalizations from <a class="reference internal" href="#shnitsel.core.geom.get_pyramids" title="shnitsel.core.geom.get_pyramids"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.get_pyramids()</span></code></a></p></li>
<li><p><strong>signed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>)</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> containing bond lengths, angles and tensions.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">shnitsel</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">shnitsel.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">geom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frames</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">open_frames</span><span class="p">(</span><span class="s1">&#39;/tmp/A03_filtered.nc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geom</span><span class="o">.</span><span class="n">get_bats</span><span class="p">(</span><span class="n">frames</span><span class="p">[</span><span class="s1">&#39;atXYZ&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.identify_pyramids">
<span class="sig-name descname"><span class="pre">identify_pyramids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.identify_pyramids" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)">list</a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.pyramid_">
<span class="sig-name descname"><span class="pre">pyramid_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.pyramid_" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.get_pyramids">
<span class="sig-name descname"><span class="pre">get_pyramids</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pyramid_idxs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.get_pyramids" title="Link to this definition">¶</a></dt>
<dd><p>Identify atoms with three bonds (using RDKit) and calculate the corresponding pyramidalization angles
for each frame.</p>
<p>Each ‘pyramid’ consists of four atoms. Three of these (the “plane” atoms) are consecutive, and the fourth (the “bending” atom)
is bonded to the middle atom of the plane atoms. The pyramidalization is the the angle between the plane of the plane atoms
and the bond from the middle plane atom to the bending atom.</p>
<p>Two sorts of pyramids are currently handled: terminal and chain-internal.</p>
<ul class="simple">
<li><p>Terminal pyramids are those where the central atom is bonded to two hydrogens and a single non-hydrogen;
for these, the central atom and the <strong>hydrogens</strong> constitute the plane and the non-hydrogen becomes the bending atom.</p></li>
<li><p>Chain-internal pyramids are those where the central atom is bonded to non-hydrogens and a single hydrogen;
for these, the central atom and the <strong>non-hydrogens</strong> constitute the plane and the hydrogen becomes the bending atom.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atXYZ</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><em>xarray.DataArray</em></a>) – An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of molecular coordinates, with dimensions
<code class="docutils literal notranslate"><span class="pre">frame</span></code>, <code class="docutils literal notranslate"><span class="pre">atom</span></code> and <code class="docutils literal notranslate"><span class="pre">direction</span></code></p></li>
<li><p><strong>pyramid_idxs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>]</em><em>] </em><em>| </em><em>None</em>) – A dictionary containing types of bonds as keys, and lists of atom index pair
as values. It may be convenient to use <a class="reference internal" href="#shnitsel.core.geom.identify_pyramids" title="shnitsel.core.geom.identify_pyramids"><code class="xref py py-func docutils literal notranslate"><span class="pre">shnitsel.core.geom.identify_pyramids()</span></code></a>
to create a dictionary in the correct format, and then customize it. If omitted,
relevant sets of atoms are identified automatically based on the <code class="docutils literal notranslate"><span class="pre">mol</span></code> argument.</p></li>
<li><p><strong>mol</strong> (<em>rdkit.Chem.Mol</em><em> | </em><em>None</em>) – An RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> object, which is generated from <code class="docutils literal notranslate"><span class="pre">atXYZ</span></code> if this argument is omitted.</p></li>
<li><p><strong>deg</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to return angles in degrees (as opposed to radians), by default False</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>An <a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">xarray.DataArray</span></code></a> of pyramidalizations with dimensions <code class="docutils literal notranslate"><span class="pre">frame</span></code> and <code class="docutils literal notranslate"><span class="pre">atom</span></code>.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#UserWarning" title="(in Python v3.14)"><strong>UserWarning</strong></a> – If both <cite>pyramid_idxs</cite> and <cite>mol</cite> are specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.center_geoms">
<span class="sig-name descname"><span class="pre">center_geoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.center_geoms" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>by_mass</strong> (<em>Literal</em><em>[</em><em>False</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.rotational_procrustes_">
<span class="sig-name descname"><span class="pre">rotational_procrustes_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.rotational_procrustes_" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.rotational_procrustes">
<span class="sig-name descname"><span class="pre">rotational_procrustes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'atom'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'direction'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.rotational_procrustes" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="shnitsel.core.geom.kabsch">
<span class="sig-name descname"><span class="pre">kabsch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atXYZ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_or_indexers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">indexers_kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#shnitsel.core.geom.kabsch" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>reference_or_indexers</strong> (<a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.DataArray.html#xarray.DataArray" title="(in xarray v2025.10.1)"><em>xarray.DataArray</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em> | </em><em>None</em>)</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../../index.html">shnitsel-tools</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../../top-level.html">Top-level functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../accessors/ds_accessors.html">Dataset accessor methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../accessors/da_accessors.html">DataArray accessor methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../priority.html">Frequently-used functions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../../index.html">Documentation overview</a><ul>
  <li><a href="../../../index.html">API Reference</a><ul>
  <li><a href="../../index.html">shnitsel</a><ul>
  <li><a href="../index.html">shnitsel.core</a><ul>
      <li>Previous: <a href="../filtre/index.html" title="previous chapter">shnitsel.core.filtre</a></li>
      <li>Next: <a href="../indexes/index.html" title="next chapter">shnitsel.core.indexes</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Theodor Everley Röhrkasten, Carolin Müller.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../../../../_sources/api/shnitsel/core/geom/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>