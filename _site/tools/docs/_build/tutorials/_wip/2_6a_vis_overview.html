
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>1) Loading data &#8212; shnitsel-tools 0.0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/_wip/2_6a_vis_overview';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">shnitsel-tools 0.0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../top-level.html">
    Top-level functions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../accessors/ds_accessors.html">
    Dataset accessor methods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../accessors/da_accessors.html">
    DataArray accessor methods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tutorials.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../top-level.html">
    Top-level functions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../accessors/ds_accessors.html">
    Dataset accessor methods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../accessors/da_accessors.html">
    DataArray accessor methods
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tutorials.html">
    Tutorials
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">1) Loading data</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p>The following submodules are demonstrated in other tutorials:</p>
<ul class="simple">
<li><p>filtration (<code class="docutils literal notranslate"><span class="pre">2_3_clean_and_plot</span></code>)</p></li>
<li><p>kde (used in <code class="docutils literal notranslate"><span class="pre">3_across_compounds</span></code>)</p></li>
<li><p>spectra3d (<code class="docutils literal notranslate"><span class="pre">2_4_PS_spectra</span></code>)</p></li>
<li><p>polychrom (TODO)</p></li>
</ul>
<p>So we need to describe the following:</p>
<ul class="simple">
<li><p>select</p></li>
<li><p>p3mhelpers</p></li>
<li><p>vmd</p></li>
</ul>
<section id="1)-Loading-data">
<h1>1) Loading data<a class="headerlink" href="#1)-Loading-data" title="Link to this heading">#</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shnitsel</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">st</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shnitsel.xarray</span>

<span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span>
    <span class="n">display_expand_coords</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">display_expand_data_vars</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">display_expand_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;xarray.core.options.set_options at 0x7f3a724cba10&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">shnitsel.data.tree</span><span class="w"> </span><span class="kn">import</span> <span class="n">tree_to_frames</span>

<span class="n">db</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;tut_data/traj_I02.nc&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;shnitsel&quot;</span><span class="p">,</span> <span class="n">input_state_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;S0&quot;</span><span class="p">,</span> <span class="s2">&quot;S1&quot;</span><span class="p">,</span> <span class="s2">&quot;S2&quot;</span><span class="p">])</span>
<span class="n">frames</span> <span class="o">=</span> <span class="n">tree_to_frames</span><span class="p">(</span><span class="n">db</span><span class="p">[</span><span class="s1">&#39;I02&#39;</span><span class="p">])</span>
<span class="n">frames</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name,
.xr-group-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-group-name::before {
  content: "ðŸ“";
  padding-right: 0.3em;
}

.xr-group-name,
.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "â–º";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "â–¼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 20px auto;
  width: 100%;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 20px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 6MB
Dimensions:                (state: 3, frame: 6452, atom: 14, direction: 3,
                            statecomb: 3, full_statecomb: 6, trajid_: 16)
Coordinates: (24)
Data variables: (9)
Attributes: (6)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8568d9db-7c48-4d2a-842a-93dd8e8e0776' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8568d9db-7c48-4d2a-842a-93dd8e8e0776' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>state</span>: 3</li><li><span class='xr-has-index'>frame</span>: 6452</li><li><span class='xr-has-index'>atom</span>: 14</li><li><span class='xr-has-index'>direction</span>: 3</li><li><span class='xr-has-index'>statecomb</span>: 3</li><li><span class='xr-has-index'>full_statecomb</span>: 6</li><li><span class='xr-has-index'>trajid_</span>: 16</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-11218769-edf0-445c-9d45-ac94098ad1f8' class='xr-section-summary-in' type='checkbox'  ><label for='section-11218769-edf0-445c-9d45-ac94098ad1f8' class='xr-section-summary' >Coordinates: <span>(24)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>state</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3</div><input id='attrs-dd6512e8-2fdb-45e3-89e7-33c80d29f101' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dd6512e8-2fdb-45e3-89e7-33c80d29f101' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a3f5a951-9565-471e-8533-ac3b8f14b3cb' class='xr-var-data-in' type='checkbox'><label for='data-a3f5a951-9565-471e-8533-ac3b8f14b3cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Index of relevant states for indexing</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([1, 2, 3])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frame</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-fbf29e80-6032-4b38-a776-6a0bd04f856d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fbf29e80-6032-4b38-a776-6a0bd04f856d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89ca722b-300b-439f-9f15-6a8dd1d93948' class='xr-var-data-in' type='checkbox'><label for='data-89ca722b-300b-439f-9f15-6a8dd1d93948' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6452 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>atom</span></div><div class='xr-var-dims'>(atom)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-83fa2ad0-f164-4ed0-8fec-67b654867ce6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-83fa2ad0-f164-4ed0-8fec-67b654867ce6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04c4e237-69cd-4505-a73e-bf6ff77989d8' class='xr-var-data-in' type='checkbox'><label for='data-04c4e237-69cd-4505-a73e-bf6ff77989d8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>direction</span></div><div class='xr-var-dims'>(direction)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27;</div><input id='attrs-b1594442-7f24-46d3-887f-98975d96558d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b1594442-7f24-46d3-887f-98975d96558d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c101244-61a2-4422-94e6-6e0f4a969ffd' class='xr-var-data-in' type='checkbox'><label for='data-0c101244-61a2-4422-94e6-6e0f4a969ffd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>statecomb</span></div><div class='xr-var-dims'>(statecomb)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-46d3786b-c7ac-4f79-b007-ccc89aff17b6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-46d3786b-c7ac-4f79-b007-ccc89aff17b6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e821268-9b45-457c-b427-2a0c6b94cf8a' class='xr-var-data-in' type='checkbox'><label for='data-3e821268-9b45-457c-b427-2a0c6b94cf8a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[3 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>full_statecomb</span></div><div class='xr-var-dims'>(full_statecomb)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-a1a02679-8f51-4f27-89d0-4d52ec446dff' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a1a02679-8f51-4f27-89d0-4d52ec446dff' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-db2384e7-dcb7-46d3-98d3-daf55f6daffc' class='xr-var-data-in' type='checkbox'><label for='data-db2384e7-dcb7-46d3-98d3-daf55f6daffc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>trajid_</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 6 7 8 ... 13 14 17 18 19 20</div><input id='attrs-7d469b34-60ae-47f7-9959-646562f5bdae' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d469b34-60ae-47f7-9959-646562f5bdae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-803f26f2-511c-46d0-8d64-f0633ede2f71' class='xr-var-data-in' type='checkbox'><label for='data-803f26f2-511c-46d0-8d64-f0633ede2f71' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  6,  7,  8,  9, 10, 12, 13, 14, 17, 18, 19, 20])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>state_names</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>&lt;U2</div><div class='xr-var-preview xr-preview'>&#x27;S0&#x27; &#x27;S1&#x27; &#x27;S2&#x27;</div><input id='attrs-58c23940-829c-4b80-bb70-ceac8c91fd5c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-58c23940-829c-4b80-bb70-ceac8c91fd5c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0fe21c47-25a3-4400-b631-7c264f3f53b0' class='xr-var-data-in' type='checkbox'><label for='data-0fe21c47-25a3-4400-b631-7c264f3f53b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>String representations of the states.</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;S0&#x27;, &#x27;S1&#x27;, &#x27;S2&#x27;], dtype=&#x27;&lt;U2&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>state_types</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>1 1 1</div><input id='attrs-c5d16bd2-ef19-46be-a77c-5a32caa4c208' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c5d16bd2-ef19-46be-a77c-5a32caa4c208' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7e49740d-18f1-4537-a109-f4dc9d858df9' class='xr-var-data-in' type='checkbox'><label for='data-7e49740d-18f1-4537-a109-f4dc9d858df9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Multiplicity to indicate whether the respective state is singlet (1), doublet (2), or triplet(3)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([1, 1, 1], dtype=int8)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>state_charges</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0</div><input id='attrs-ddeb40b3-1da1-431b-8605-07ab459ecf33' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ddeb40b3-1da1-431b-8605-07ab459ecf33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-99146d5f-dd56-412a-8707-cc70862a55e7' class='xr-var-data-in' type='checkbox'><label for='data-99146d5f-dd56-412a-8707-cc70862a55e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Charge of the various states.</dd><dt><span>unitdim :</span></dt><dd>charge</dd><dt><span>units :</span></dt><dd>e</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([0., 0., 0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>atNames</span></div><div class='xr-var-dims'>(atom)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;C&#x27; &#x27;H&#x27; &#x27;H&#x27; &#x27;C&#x27; ... &#x27;H&#x27; &#x27;N&#x27; &#x27;H&#x27; &#x27;H&#x27;</div><input id='attrs-a3238d3f-e745-4fb5-b673-5ccc748b1987' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a3238d3f-e745-4fb5-b673-5ccc748b1987' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-43974e79-0297-48ee-9706-429e735b6abc' class='xr-var-data-in' type='checkbox'><label for='data-43974e79-0297-48ee-9706-429e735b6abc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Names of atomic elements (short form)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;C&#x27;, &#x27;H&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;N&#x27;, &#x27;H&#x27;,
       &#x27;H&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>atNums</span></div><div class='xr-var-dims'>(atom)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>6 1 1 6 1 6 1 6 1 6 1 7 1 1</div><input id='attrs-0c632399-cfc4-4877-91c1-3960e74e4b69' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c632399-cfc4-4877-91c1-3960e74e4b69' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3ef6dacc-d73b-4dbe-b5fc-48671e4285e6' class='xr-var-data-in' type='checkbox'><label for='data-3ef6dacc-d73b-4dbe-b5fc-48671e4285e6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Periodic number of atomic elements</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([6, 1, 1, 6, 1, 6, 1, 6, 1, 6, 1, 7, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>from</span></div><div class='xr-var-dims'>(statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 2</div><input id='attrs-799ef080-088d-43f6-a8e5-1c786ab51178' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-799ef080-088d-43f6-a8e5-1c786ab51178' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74a83b28-3076-4f4f-a7e8-2bca6d6e3f43' class='xr-var-data-in' type='checkbox'><label for='data-74a83b28-3076-4f4f-a7e8-2bca6d6e3f43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the first state of a statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[3 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>to</span></div><div class='xr-var-dims'>(statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 3 3</div><input id='attrs-42f2f5e0-5c0d-4d40-a5ff-ef6d8fdffca7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-42f2f5e0-5c0d-4d40-a5ff-ef6d8fdffca7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-560dae42-a5cc-4ad4-8419-f4b9c6d5c089' class='xr-var-data-in' type='checkbox'><label for='data-560dae42-a5cc-4ad4-8419-f4b9c6d5c089' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the second state of a statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[3 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>full_statecomb_from</span></div><div class='xr-var-dims'>(full_statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 2 2 3 3</div><input id='attrs-a24abe94-5aab-4d1b-b5e6-9db53809a568' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a24abe94-5aab-4d1b-b5e6-9db53809a568' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f0192bc8-f5fb-4dc4-9e94-52ffbd94e44d' class='xr-var-data-in' type='checkbox'><label for='data-f0192bc8-f5fb-4dc4-9e94-52ffbd94e44d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the first state of a full_statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>full_statecomb_to</span></div><div class='xr-var-dims'>(full_statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 3 1 3 1 2</div><input id='attrs-cfdb43cc-1ef3-4333-8fdf-9f52a85c225f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cfdb43cc-1ef3-4333-8fdf-9f52a85c225f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60ac6c8f-fb61-4395-82a1-236ea0e0393d' class='xr-var-data-in' type='checkbox'><label for='data-60ac6c8f-fb61-4395-82a1-236ea0e0393d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the second state of a full_statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>trajid</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1 1 ... 20 20 20 20 20 20</div><input id='attrs-be70c6b0-5baa-4d9d-9187-32f74e115a3d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-be70c6b0-5baa-4d9d-9187-32f74e115a3d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ba8367c-152c-4063-a605-a864b4780cd0' class='xr-var-data-in' type='checkbox'><label for='data-6ba8367c-152c-4063-a605-a864b4780cd0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6452 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.5 1.0 ... 218.0 218.5 219.0</div><input id='attrs-88dc7bba-551c-46a8-96d9-bfef6d9d820e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-88dc7bba-551c-46a8-96d9-bfef6d9d820e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a53cffb8-0df7-451c-8494-ebd700f38134' class='xr-var-data-in' type='checkbox'><label for='data-a53cffb8-0df7-451c-8494-ebd700f38134' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time in trajectory or timestep</dd><dt><span>unitdim :</span></dt><dd>time</dd><dt><span>units :</span></dt><dd>fs</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6452 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>input_format</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>&lt;U5</div><div class='xr-var-preview xr-preview'>&#x27;sharc&#x27; &#x27;sharc&#x27; ... &#x27;sharc&#x27; &#x27;sharc&#x27;</div><input id='attrs-645cb23b-7445-4dec-9abd-a5685314d0e7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-645cb23b-7445-4dec-9abd-a5685314d0e7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e4ec4686-dcab-4f8d-947d-aef79f9d24d2' class='xr-var-data-in' type='checkbox'><label for='data-e4ec4686-dcab-4f8d-947d-aef79f9d24d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;,
       &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;,
       &#x27;sharc&#x27;, &#x27;sharc&#x27;], dtype=&#x27;&lt;U5&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t_max</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03 1e+03 1e+03 ... 1e+03 1e+03</div><input id='attrs-866f4279-5ff9-4146-a536-5582948ca466' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-866f4279-5ff9-4146-a536-5582948ca466' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cfe09a40-e69e-4785-adf1-380ea4549564' class='xr-var-data-in' type='checkbox'><label for='data-cfe09a40-e69e-4785-adf1-380ea4549564' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1000., 1000., 1000., 1000., 1000., 1000., 1000., 1000., 1000.,
       1000., 1000., 1000., 1000., 1000., 1000., 1000.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>max_ts</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>384 367 444 106 ... 450 449 335 439</div><input id='attrs-a3998d06-6202-481b-833b-3221a10f4337' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a3998d06-6202-481b-833b-3221a10f4337' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17e47732-edf4-4c32-b79e-6c479eb271dd' class='xr-var-data-in' type='checkbox'><label for='data-17e47732-edf4-4c32-b79e-6c479eb271dd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([384, 367, 444, 106, 443, 450, 444, 356, 447, 442, 451, 445, 450,
       449, 335, 439])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>completed</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False False False ... False False</div><input id='attrs-861bd298-ea4f-4531-ac6b-874c27e734a8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-861bd298-ea4f-4531-ac6b-874c27e734a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-730d1067-3107-48e4-9862-cfe2822e50c8' class='xr-var-data-in' type='checkbox'><label for='data-730d1067-3107-48e4-9862-cfe2822e50c8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>has_forces</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True True True ... True True True</div><input id='attrs-1c113ae9-d487-4cc5-952e-10a07bb7f824' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1c113ae9-d487-4cc5-952e-10a07bb7f824' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-347af681-0594-441a-8fce-993784551203' class='xr-var-data-in' type='checkbox'><label for='data-347af681-0594-441a-8fce-993784551203' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trajectory_input_path</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>&lt;U31</div><div class='xr-var-preview xr-preview'>&#x27;retinal_tutorial/I02/TRAJ_00001...</div><input id='attrs-29adfdeb-df9e-4366-be89-be24fe5d6d3f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-29adfdeb-df9e-4366-be89-be24fe5d6d3f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fdd00ce7-513f-43c0-8b6e-87d69a51d28f' class='xr-var-data-in' type='checkbox'><label for='data-fdd00ce7-513f-43c0-8b6e-87d69a51d28f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;retinal_tutorial/I02/TRAJ_00001&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00002&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00003&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00004&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00006&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00007&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00008&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00009&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00010&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00012&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00013&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00014&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00017&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00018&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00019&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00020&#x27;], dtype=&#x27;&lt;U31&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c27bfa3f-10e0-43f3-a3ce-12b32a97b9a6' class='xr-section-summary-in' type='checkbox'  ><label for='section-c27bfa3f-10e0-43f3-a3ce-12b32a97b9a6' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>energy</span></div><div class='xr-var-dims'>(state, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-248.2 -248.2 ... -248.0 -248.0</div><input id='attrs-b63c4b2d-0958-4f27-be78-ecf1c74e4018' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b63c4b2d-0958-4f27-be78-ecf1c74e4018' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f5ba7384-0cf9-4088-a7b5-5da609768eb5' class='xr-var-data-in' type='checkbox'><label for='data-f5ba7384-0cf9-4088-a7b5-5da609768eb5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Absolute energy</dd><dt><span>unitdim :</span></dt><dd>energy</dd><dt><span>units :</span></dt><dd>Hartree</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[-248.22067, -248.22716, -248.2342 , ..., -248.09761, -248.10034,
        -248.09601],
       [-248.04868, -248.05444, -248.06071, ..., -248.01071, -248.01018,
        -248.00208],
       [-248.04047, -248.04626, -248.05266, ..., -247.97426, -247.97498,
        -247.96825]], shape=(3, 6452), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>forces</span></div><div class='xr-var-dims'>(state, atom, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.02007 0.02626 ... -0.01933</div><input id='attrs-20c4d27d-0e90-46bb-9b85-eb7803dfc3ec' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-20c4d27d-0e90-46bb-9b85-eb7803dfc3ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1bafab5d-5498-4f37-ac58-282e1e462534' class='xr-var-data-in' type='checkbox'><label for='data-1bafab5d-5498-4f37-ac58-282e1e462534' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Per-atom forces</dd><dt><span>unitdim :</span></dt><dd>force</dd><dt><span>units :</span></dt><dd>Hartree/Bohr</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 2.00663898e-02,  2.62616463e-02,  2.96801813e-02, ...,
          -4.84145842e-02, -2.01488119e-02,  7.70952692e-03],
         [-6.60285354e-02, -6.78945035e-02, -6.77327588e-02, ...,
          -5.38783334e-02, -5.38948774e-02, -5.15006408e-02],
         [-1.64372958e-02, -1.62098724e-02, -1.51822641e-02, ...,
           5.80443479e-02,  2.50245035e-02, -8.95257853e-03]],

        [[-5.07116411e-03, -6.36334671e-03, -7.08915899e-03, ...,
          -2.11533438e-02, -2.31856443e-02, -2.39497423e-02],
         [-2.79151415e-03,  3.49698262e-03,  8.56452156e-03, ...,
          -1.54342717e-02, -6.95273094e-03,  2.05703126e-03],
         [-4.26179171e-03, -4.35435027e-03, -4.50829742e-03, ...,
          -1.60363771e-03,  9.95304994e-03,  2.14691050e-02]],

        [[-2.10863836e-02, -2.48636808e-02, -2.64120065e-02, ...,
           4.38925549e-02,  2.19056904e-02, -4.84297889e-05],
         [ 6.98318379e-03,  7.66210305e-03,  8.15274566e-03, ...,
          -5.79797430e-03, -1.05152251e-02, -1.64787639e-02],
         [ 1.48494439e-02,  1.53715322e-02,  1.52602196e-02, ...,
          -5.81851117e-02, -4.01220359e-02, -2.11500376e-02]],
...
           1.33374957e-02,  4.48656268e-02,  7.69411698e-02],
         [-1.68085378e-02, -2.30050683e-02, -3.28645073e-02, ...,
          -6.96286634e-02, -6.30450472e-02, -5.27126156e-02],
         [ 2.85424688e-03, -6.62100851e-04, -5.40221436e-03, ...,
           5.49750635e-03,  1.31059596e-02,  2.36402992e-02]],

        [[ 3.40768881e-02,  2.93699391e-02,  2.15194859e-02, ...,
          -5.07820211e-02, -5.11144400e-02, -4.85255271e-02],
         [-5.52620701e-02, -5.05247638e-02, -3.96354459e-02, ...,
           6.09459840e-02,  5.58766089e-02,  4.68764789e-02],
         [-6.54920423e-03, -5.87340444e-03, -3.95333348e-03, ...,
          -2.06392631e-02, -2.04062294e-02, -1.93242673e-02]],

        [[-1.21582545e-01, -9.86345485e-02, -6.13246448e-02, ...,
           2.46847495e-02, -5.92714874e-03, -3.97131890e-02],
         [ 2.28698775e-02,  2.23047826e-02,  2.06582751e-02, ...,
           5.68390498e-03,  1.95401939e-04, -5.23628527e-03],
         [-5.20444009e-03, -2.76260101e-03, -9.16319841e-05, ...,
           3.45094595e-03, -6.04119617e-03, -1.93303190e-02]]]],
      shape=(3, 14, 3, 6452), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>atXYZ</span></div><div class='xr-var-dims'>(atom, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-4.182 -4.181 ... 1.974 2.009</div><input id='attrs-9503c802-e473-4804-b86f-981b2d05e0e5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9503c802-e473-4804-b86f-981b2d05e0e5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a8622c9-9e09-457a-96ee-d7d50cf53518' class='xr-var-data-in' type='checkbox'><label for='data-6a8622c9-9e09-457a-96ee-d7d50cf53518' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Positions</dd><dt><span>unitdim :</span></dt><dd>length</dd><dt><span>units :</span></dt><dd>Bohr</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[-4.182025  , -4.1810236 , -4.1808057 , ..., -3.9376867 ,
         -3.9177969 , -3.8975132 ],
        [-0.25673106, -0.25329143, -0.2489612 , ..., -0.04124488,
         -0.02737844, -0.01245927],
        [-0.02583737, -0.02070491, -0.01522322, ...,  0.94354326,
          0.9347735 ,  0.92551494]],

       [[-3.2700472 , -3.2610302 , -3.250624  , ..., -4.229773  ,
         -4.262263  , -4.28936   ],
        [-2.0431755 , -2.0080574 , -1.9737694 , ..., -1.5592455 ,
         -1.5177611 , -1.4746597 ],
        [-0.41704622, -0.45770794, -0.49814463, ..., -0.46462294,
         -0.44016474, -0.41802138]],

       [[-6.2191415 , -6.2317843 , -6.2386346 , ..., -5.309291  ,
         -5.319027  , -5.333857  ],
        [-0.25494382, -0.24808349, -0.24318142, ..., -0.22330914,
         -0.27876028, -0.33176583],
        [ 0.5338286 ,  0.5296675 ,  0.5224748 , ...,  2.253138  ,
          2.2811437 ,  2.3184807 ]],
...
       [[ 5.2997746 ,  5.297853  ,  5.295678  , ...,  4.7195683 ,
          4.718798  ,  4.7171807 ],
        [ 6.192018  ,  6.1921186 ,  6.193293  , ...,  6.129089  ,
          6.1281695 ,  6.1279397 ],
        [ 0.4663344 ,  0.46977952,  0.47321895, ...,  1.3242255 ,
          1.3162919 ,  1.3079702 ]],

       [[ 4.6396847 ,  4.6291127 ,  4.6125417 , ...,  3.5348275 ,
          3.5118196 ,  3.5005362 ],
        [ 7.8277464 ,  7.8344965 ,  7.8514943 , ...,  7.85418   ,
          7.821614  ,  7.7763877 ],
        [ 0.8322172 ,  0.83031654,  0.8300061 , ...,  0.8727418 ,
          0.88486034,  0.90244395]],

       [[ 7.0150247 ,  7.04257   ,  7.09112   , ...,  6.5561996 ,
          6.470414  ,  6.3869452 ],
        [ 6.3125477 ,  6.282558  ,  6.247461  , ...,  6.377516  ,
          6.3532395 ,  6.3291807 ],
        [ 0.63242406,  0.61567754,  0.59971917, ...,  1.9396616 ,
          1.9738454 ,  2.009402  ]]], shape=(14, 3, 6452), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dip_perm</span></div><div class='xr-var-dims'>(state, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>6.736 6.773 6.828 ... 0.9 0.9577</div><input id='attrs-90d4f484-ec6e-476b-b496-1e70ce7933d9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-90d4f484-ec6e-476b-b496-1e70ce7933d9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-77cf8e56-1bae-429d-9e9a-88630ff2dc10' class='xr-var-data-in' type='checkbox'><label for='data-77cf8e56-1bae-429d-9e9a-88630ff2dc10' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Permanent dipoles</dd><dt><span>unitdim :</span></dt><dd>dipole</dd><dt><span>units :</span></dt><dd>debye</dd><dt><span>original_units :</span></dt><dd>au</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[ 6.7360601e+00,  6.7731652e+00,  6.8277926e+00, ...,
          8.2931070e+00,  8.1622868e+00,  8.0431528e+00],
        [ 1.0841799e+01,  1.0854571e+01,  1.0873300e+01, ...,
          1.2238400e+01,  1.2106598e+01,  1.1959476e+01],
        [ 1.1274937e+00,  1.0971485e+00,  1.0689301e+00, ...,
          1.2089833e+00,  1.2248545e+00,  1.2411696e+00]],

       [[-1.8104094e-01, -1.1436606e-01,  5.9543648e-03, ...,
          4.5535445e+00,  4.5789084e+00,  4.5369501e+00],
        [ 7.2100921e+00,  7.1777196e+00,  7.1534781e+00, ...,
          9.1613235e+00,  9.1516895e+00,  9.0701399e+00],
        [ 8.1224346e-01,  7.8864688e-01,  7.6622027e-01, ...,
          5.6820267e-01,  5.8019096e-01,  5.8440143e-01]],

       [[ 6.6706185e+00,  6.7236233e+00,  6.7840247e+00, ...,
          4.9358048e+00,  4.8889222e+00,  4.9268022e+00],
        [ 1.2257620e+01,  1.2314698e+01,  1.2387203e+01, ...,
          9.8529882e+00,  9.8000336e+00,  9.8037653e+00],
        [ 1.1380707e+00,  1.1105586e+00,  1.0879902e+00, ...,
          8.4812635e-01,  9.0001756e-01,  9.5766848e-01]]],
      shape=(3, 3, 6452), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dip_trans</span></div><div class='xr-var-dims'>(statecomb, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-6.596 -6.571 ... -0.3511 -0.349</div><input id='attrs-3a27e561-b624-4b3d-9f59-b72b62d86508' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3a27e561-b624-4b3d-9f59-b72b62d86508' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-550faf3b-a8cf-4845-b69f-62f8b929c5ec' class='xr-var-data-in' type='checkbox'><label for='data-550faf3b-a8cf-4845-b69f-62f8b929c5ec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Transitional dipoles</dd><dt><span>unitdim :</span></dt><dd>dipole</dd><dt><span>units :</span></dt><dd>debye</dd><dt><span>original_units :</span></dt><dd>au</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[-6.595958  , -6.5708036 , -6.5303516 , ..., -1.7797415 ,
         -1.8348788 , -1.9070386 ],
        [-4.370654  , -4.4054503 , -4.4464765 , ..., -1.6959522 ,
         -1.7688233 , -1.8549708 ],
        [-0.38861918, -0.38389844, -0.3788716 , ..., -0.1693822 ,
         -0.1788984 , -0.19205447]],

       [[ 0.01624402,  0.23840615,  0.5592749 , ..., -2.040554  ,
         -2.0828068 , -2.1092331 ],
        [-0.8576794 , -0.7000144 , -0.47169745, ..., -1.5552629 ,
         -1.6210021 , -1.6694036 ],
        [-0.0905462 , -0.08193003, -0.06733322, ...,  0.04111693,
          0.02626056,  0.01192588]],

       [[ 0.06016524,  0.27330142,  0.59241116, ..., -4.2613006 ,
         -4.1730227 , -4.0852723 ],
        [-0.65674233, -0.49063432, -0.23840985, ..., -3.5333228 ,
         -3.4999986 , -3.4550695 ],
        [-0.07383445, -0.06762268, -0.05626025, ..., -0.3527081 ,
         -0.35106155, -0.34904796]]], shape=(3, 3, 6452), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>socs</span></div><div class='xr-var-dims'>(full_statecomb, frame)</div><div class='xr-var-dtype'>complex128</div><div class='xr-var-preview xr-preview'>0j 0j 0j 0j 0j ... 0j 0j 0j 0j 0j</div><input id='attrs-6edcc821-5ba5-44c0-a002-6683d18683c3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6edcc821-5ba5-44c0-a002-6683d18683c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3cf0f104-a97c-42ee-83a5-66801a24da0e' class='xr-var-data-in' type='checkbox'><label for='data-3cf0f104-a97c-42ee-83a5-66801a24da0e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Spin-orbit couplings</dd><dt><span>unitdim :</span></dt><dd>socs</dd><dt><span>units :</span></dt><dd>1/cm</dd><dt><span>original_units :</span></dt><dd>Hartree</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j]],
      shape=(6, 6452))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>astate</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>2 2 2 2 2 2 2 2 ... 1 1 1 1 1 1 1 1</div><input id='attrs-2e36c9ab-153e-430b-84a5-70812160c72b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e36c9ab-153e-430b-84a5-70812160c72b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1f6c3a3-b6ab-43c5-8854-a0f361d74ca5' class='xr-var-data-in' type='checkbox'><label for='data-e1f6c3a3-b6ab-43c5-8854-a0f361d74ca5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Active state in dynamic trajectories (MCH)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([2, 2, 2, ..., 1, 1, 1], shape=(6452,), dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sdiag</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>2 2 2 2 2 2 2 2 ... 1 1 1 1 1 1 1 1</div><input id='attrs-9bab74d9-8de3-4d61-aeca-4f1b48e40cd1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9bab74d9-8de3-4d61-aeca-4f1b48e40cd1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de2daeb9-58c6-4948-b2e2-c03145b5fc7e' class='xr-var-data-in' type='checkbox'><label for='data-de2daeb9-58c6-4948-b2e2-c03145b5fc7e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Active state (diag)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([2, 2, 2, ..., 1, 1, 1], shape=(6452,), dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>phases</span></div><div class='xr-var-dims'>(state, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0</div><input id='attrs-5a5e8416-6fa4-41ca-b661-f8f29747f82b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5a5e8416-6fa4-41ca-b661-f8f29747f82b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54425ce6-10f4-4567-aaa5-88fc57172e20' class='xr-var-data-in' type='checkbox'><label for='data-54425ce6-10f4-4567-aaa5-88fc57172e20' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Phase vector</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[-1.,  1.,  1., ...,  1.,  1.,  1.],
       [-1.,  1.,  1., ...,  1.,  1.,  1.],
       [-1.,  1.,  1., ...,  1.,  1.,  1.]],
      shape=(3, 6452), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b91c6cce-d9a3-48bb-a26f-ac94285e3a22' class='xr-section-summary-in' type='checkbox'  ><label for='section-b91c6cce-d9a3-48bb-a26f-ac94285e3a22' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>input_format_version :</span></dt><dd>3.0</dd><dt><span>delta_t :</span></dt><dd>0.5</dd><dt><span>num_triplets :</span></dt><dd>0</dd><dt><span>input_type :</span></dt><dd>dynamic</dd><dt><span>num_singlets :</span></dt><dd>3</dd><dt><span>num_doublets :</span></dt><dd>0</dd></dl></div></li></ul></div></div></div>
</div>
</section>
<section id="2)-Derive-representation-for-selection">
<h1>2) Derive representation for selection<a class="headerlink" href="#2)-Derive-representation-for-selection" title="Link to this heading">#</a></h1>
<p>We will use PCA in this case, but could use any feature that associates each frame with two values to use as <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> coordinates in the selection plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">atXYZ</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">pwdists</span><span class="p">()</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">pca</span><span class="p">(</span><span class="s1">&#39;atomcomb&#39;</span><span class="p">)</span>
<span class="n">pca</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: Dimension atomcomb is being generated.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name,
.xr-group-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-group-name::before {
  content: "ðŸ“";
  padding-right: 0.3em;
}

.xr-group-name,
.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "â–º";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "â–¼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 20px auto;
  width: 100%;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 20px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (frame: 6452, PC: 2)&gt; Size: 103kB
array([[ 0.2527689 ,  0.0462187 ],
       [ 0.25525838,  0.04271544],
       [ 0.25901722,  0.03414313],
       ...,
       [-0.64467528, -0.75732731],
       [-0.6684596 , -0.73634188],
       [-0.69243973, -0.71430794]], shape=(6452, 2))
Coordinates: (3)
Dimensions without coordinates: PC
Attributes: (5)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>frame</span>: 6452</li><li><span>PC</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-ffbff226-73dd-4c3e-bc41-c3d60c640626' class='xr-array-in' type='checkbox' checked><label for='section-ffbff226-73dd-4c3e-bc41-c3d60c640626' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.2528 0.04622 0.2553 0.04272 ... -0.6685 -0.7363 -0.6924 -0.7143</span></div><div class='xr-array-data'><pre>array([[ 0.2527689 ,  0.0462187 ],
       [ 0.25525838,  0.04271544],
       [ 0.25901722,  0.03414313],
       ...,
       [-0.64467528, -0.75732731],
       [-0.6684596 , -0.73634188],
       [-0.69243973, -0.71430794]], shape=(6452, 2))</pre></div></div></li><li class='xr-section-item'><input id='section-b0e1823b-0c93-4237-b2b6-43583a803a83' class='xr-section-summary-in' type='checkbox'  ><label for='section-b0e1823b-0c93-4237-b2b6-43583a803a83' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frame</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-93d7283e-5ac5-47b6-851a-dff37edf0f59' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-93d7283e-5ac5-47b6-851a-dff37edf0f59' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f4f7896-dec6-4fe4-9eed-895d3ec7f331' class='xr-var-data-in' type='checkbox'><label for='data-9f4f7896-dec6-4fe4-9eed-895d3ec7f331' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6452 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>trajid</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1 1 ... 20 20 20 20 20 20</div><input id='attrs-c9debae6-39a8-481c-91bc-bb02020cbdcf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c9debae6-39a8-481c-91bc-bb02020cbdcf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-361fe4ca-8899-4a9d-a973-79439d56788e' class='xr-var-data-in' type='checkbox'><label for='data-361fe4ca-8899-4a9d-a973-79439d56788e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6452 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.5 1.0 ... 218.0 218.5 219.0</div><input id='attrs-6e3885b9-a8dc-43aa-9ed6-04c9cdb52784' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6e3885b9-a8dc-43aa-9ed6-04c9cdb52784' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0eb3d3b5-b5e8-4cc8-a5bf-58feb962fe80' class='xr-var-data-in' type='checkbox'><label for='data-0eb3d3b5-b5e8-4cc8-a5bf-58feb962fe80' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time in trajectory or timestep</dd><dt><span>unitdim :</span></dt><dd>time</dd><dt><span>units :</span></dt><dd>fs</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6452 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-09bca9ea-50d0-44a0-bff9-5604975e1e1b' class='xr-section-summary-in' type='checkbox'  ><label for='section-09bca9ea-50d0-44a0-bff9-5604975e1e1b' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Positions</dd><dt><span>unitdim :</span></dt><dd>length</dd><dt><span>units :</span></dt><dd>Bohr</dd><dt><span>__assigned :</span></dt><dd>True</dd><dt><span>deltaed :</span></dt><dd>{&#x27;atom&#x27;}</dd></dl></div></li></ul></div></div></div>
</div>
</section>
<section id="3)-Frame-level-selection">
<h1>3) Frame-level selection<a class="headerlink" href="#3)-Frame-level-selection" title="Link to this heading">#</a></h1>
<section id="3.1)-Select-frames-from-PCA">
<h2>3.1) Select frames from PCA<a class="headerlink" href="#3.1)-Select-frames-from-PCA" title="Link to this heading">#</a></h2>
<div class="line-block">
<div class="line">When the cell below is run, an interactive Bokeh plot should appear.</div>
<div class="line">Please use it to select a part of the PCA you find interesting.</div>
</div>
<div class="line-block">
<div class="line">NB. Later on, we will use <code class="docutils literal notranslate"><span class="pre">py3Dmol</span></code> to visualize the points selected.</div>
<div class="line">On some systems, the underlying 3Dmol.js becomes very slow when</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selector</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">FrameSelector</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style>
    .bk-notebook-logo {
        display: block;
        width: 20px;
        height: 20px;
        background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==);
    }
</style>
<div>
    <a href="https://bokeh.org" target="_blank" class="bk-notebook-logo"></a>
    <span id="ebc7298c-3b40-4b97-8587-7534ec25ab05">Loading BokehJS ...</span>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="output_javascript"></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;
'use strict';
(function(root) {
  function now() {
    return new Date();
  }

  const force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

const JS_MIME_TYPE = 'application/javascript';
  const HTML_MIME_TYPE = 'text/html';
  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  const CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    const script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    function drop(id) {
      const view = Bokeh.index.get_by_id(id)
      if (view != null) {
        view.model.document.clear()
        Bokeh.index.delete(view)
      }
    }

    const cell = handle.cell;

    const id = cell.output_area._bokeh_element_id;
    const server_id = cell.output_area._bokeh_server_id;

    // Clean up Bokeh references
    if (id != null) {
      drop(id)
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      const cmd_clean = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd_clean, {
        iopub: {
          output: function(msg) {
            const id = msg.content.text.trim()
            drop(id)
          }
        }
      });
      // Destroy server and session
      const cmd_destroy = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd_destroy);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    const output_area = handle.output_area;
    const output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {
      return
    }

    const toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      const bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      const script_attrs = bk_div.children[0].attributes;
      for (let i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      const toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    const events = require('base/js/events');
    const OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  const NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded(error = null) {
    const el = document.getElementById("ebc7298c-3b40-4b97-8587-7534ec25ab05");
    if (el != null) {
      const html = (() => {
        if (typeof root.Bokeh === "undefined") {
          if (error == null) {
            return "BokehJS is loading ...";
          } else {
            return "BokehJS failed to load.";
          }
        } else {
          const prefix = `BokehJS ${root.Bokeh.version}`;
          if (error == null) {
            return `${prefix} successfully loaded.`;
          } else {
            return `${prefix} <b>encountered errors</b> while loading and may not function as expected.`;
          }
        }
      })();
      el.innerHTML = html;

      if (error != null) {
        const wrapper = document.createElement("div");
        wrapper.style.overflow = "auto";
        wrapper.style.height = "5em";
        wrapper.style.resize = "vertical";
        const content = document.createElement("div");
        content.style.fontFamily = "monospace";
        content.style.whiteSpace = "pre-wrap";
        content.style.backgroundColor = "rgb(255, 221, 221)";
        content.textContent = error.stack ?? error.toString();
        wrapper.append(content);
        el.append(wrapper);
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(() => display_loaded(error), 100);
    }
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error(url) {
      console.error("failed to load " + url);
    }

    for (let i = 0; i < css_urls.length; i++) {
      const url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (let i = 0; i < js_urls.length; i++) {
      const url = js_urls[i];
      const element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  const js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-3.8.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.8.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.8.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.8.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.8.1.min.js"];
  const css_urls = [];

  const inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {
    }
  ];

  function run_inline_js() {
    if (root.Bokeh !== undefined || force === true) {
      try {
            for (let i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }

      } catch (error) {display_loaded(error);throw error;
      }if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      const cell = $(document.getElementById("ebc7298c-3b40-4b97-8587-7534ec25ab05")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: We appear to be running in VS Code and allowed_ws_origin was not provided, so setting allowed_ws_origin=&#39;*&#39;
INFO: Starting Bokeh server version 3.8.1 (running on Tornado 6.5.2)
INFO: User authentication hooks NOT provided (default user enabled)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<script id="fe5626fe-7a79-4b2c-aba6-7c6c9f26cd24">
  (function() {
    const xhr = new XMLHttpRequest()
    xhr.responseType = 'blob';
    xhr.open('GET', "http://localhost:40325/autoload.js?bokeh-autoload-element=fe5626fe-7a79-4b2c-aba6-7c6c9f26cd24&bokeh-absolute-url=http://localhost:40325&resources=none", true);
    xhr.withCredentials = false;
    xhr.onload = function (event) {
      const script = document.createElement('script');
      const src = URL.createObjectURL(event.target.response);
      script.src = src;
      document.body.appendChild(script);
    };
    xhr.send();
  })();
</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: 200 GET /autoload.js?bokeh-autoload-element=fe5626fe-7a79-4b2c-aba6-7c6c9f26cd24&amp;bokeh-absolute-url=http://localhost:40325&amp;resources=none (::1) 23.48ms
INFO:tornado.access:200 GET /autoload.js?bokeh-autoload-element=fe5626fe-7a79-4b2c-aba6-7c6c9f26cd24&amp;bokeh-absolute-url=http://localhost:40325&amp;resources=none (::1) 23.48ms
INFO: 101 GET /ws?id=7c11834a-bba9-4580-b7ce-1f1305a8a8a3&amp;origin=fde0f466-d350-4c7f-995b-8eef6d0b38d6&amp;swVersion=4&amp;extensionId=&amp;platform=electron&amp;vscode-resource-base-authority=vscode-resource.vscode-cdn.net&amp;parentOrigin=vscode-file%3A%2F%2Fvscode-app&amp;purpose=notebookRenderer (::1) 0.51ms
INFO:tornado.access:101 GET /ws?id=7c11834a-bba9-4580-b7ce-1f1305a8a8a3&amp;origin=fde0f466-d350-4c7f-995b-8eef6d0b38d6&amp;swVersion=4&amp;extensionId=&amp;platform=electron&amp;vscode-resource-base-authority=vscode-resource.vscode-cdn.net&amp;parentOrigin=vscode-file%3A%2F%2Fvscode-app&amp;purpose=notebookRenderer (::1) 0.51ms
INFO: WebSocket connection opened
INFO: ServerConnection created
</pre></div></div>
</div>
<p>The indices of the selected points can be retrieved in several ways:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selector</span><span class="o">.</span><span class="n">selection</span>
<span class="c1"># selector.selected_frame_indices</span>
<span class="c1"># selector.df_selection</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name,
.xr-group-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-group-name::before {
  content: "ðŸ“";
  padding-right: 0.3em;
}

.xr-group-name,
.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "â–º";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "â–¼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 20px auto;
  width: 100%;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 20px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (frame: 6, PC: 2)&gt; Size: 96B
array([[-0.6565835 ,  0.79328341],
       [-0.65415134,  0.81079937],
       [-0.65194126,  0.82149068],
       [-0.64965961,  0.82451911],
       [-0.64702436,  0.81974782],
       [-0.64369177,  0.80757171]])
Coordinates: (3)
Dimensions without coordinates: PC
Attributes: (5)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-obj-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>frame</span>: 6</li><li><span>PC</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-0c7791d3-5d75-416f-8fd1-6db75fef3128' class='xr-array-in' type='checkbox' checked><label for='section-0c7791d3-5d75-416f-8fd1-6db75fef3128' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.6566 0.7933 -0.6542 0.8108 -0.6519 ... -0.647 0.8197 -0.6437 0.8076</span></div><div class='xr-array-data'><pre>array([[-0.6565835 ,  0.79328341],
       [-0.65415134,  0.81079937],
       [-0.65194126,  0.82149068],
       [-0.64965961,  0.82451911],
       [-0.64702436,  0.81974782],
       [-0.64369177,  0.80757171]])</pre></div></div></li><li class='xr-section-item'><input id='section-23098fc2-851a-4f3f-861a-6d919fc8f669' class='xr-section-summary-in' type='checkbox'  ><label for='section-23098fc2-851a-4f3f-861a-6d919fc8f669' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frame</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-cee83fb8-3296-4c2d-b24a-a5eab92ee0fc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cee83fb8-3296-4c2d-b24a-a5eab92ee0fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-228d7fd1-f0f7-47ad-9f15-20eab473304c' class='xr-var-data-in' type='checkbox'><label for='data-228d7fd1-f0f7-47ad-9f15-20eab473304c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>trajid</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>3 3 3 3 3 3</div><input id='attrs-1289e085-1571-4685-889a-276a96b6cf44' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1289e085-1571-4685-889a-276a96b6cf44' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c14ab22e-e15e-45eb-ba54-76b5da8f8821' class='xr-var-data-in' type='checkbox'><label for='data-c14ab22e-e15e-45eb-ba54-76b5da8f8821' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>168.0 168.5 169.0 169.5 170.0 170.5</div><input id='attrs-86630e58-35ed-4c5a-b8d4-d4c6900f5563' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-86630e58-35ed-4c5a-b8d4-d4c6900f5563' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-28bee246-e96e-474a-90b4-ee228e9ddcc0' class='xr-var-data-in' type='checkbox'><label for='data-28bee246-e96e-474a-90b4-ee228e9ddcc0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time in trajectory or timestep</dd><dt><span>unitdim :</span></dt><dd>time</dd><dt><span>units :</span></dt><dd>fs</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=float64]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f4c6fae0-7247-4f4c-97da-e5d2ca636cfa' class='xr-section-summary-in' type='checkbox'  ><label for='section-f4c6fae0-7247-4f4c-97da-e5d2ca636cfa' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Positions</dd><dt><span>unitdim :</span></dt><dd>length</dd><dt><span>units :</span></dt><dd>Bohr</dd><dt><span>__assigned :</span></dt><dd>True</dd><dt><span>deltaed :</span></dt><dd>{&#x27;atom&#x27;}</dd></dl></div></li></ul></div></div></div>
</div>
<p>The indices can be used as follows, to retrieve the relevant subset of the full dataset:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">selector</span><span class="o">.</span><span class="n">selected_frame_indices</span><span class="p">)</span>
<span class="n">subset</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name,
.xr-group-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-group-name::before {
  content: "ðŸ“";
  padding-right: 0.3em;
}

.xr-group-name,
.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "â–º";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "â–¼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 20px auto;
  width: 100%;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 20px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 9kB
Dimensions:                (state: 3, frame: 6, atom: 14, direction: 3,
                            statecomb: 3, full_statecomb: 6, trajid_: 16)
Coordinates: (24)
Data variables: (9)
Attributes: (6)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-dfcd0df5-8107-4624-bfe8-b74ad9d024a7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-dfcd0df5-8107-4624-bfe8-b74ad9d024a7' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>state</span>: 3</li><li><span class='xr-has-index'>frame</span>: 6</li><li><span class='xr-has-index'>atom</span>: 14</li><li><span class='xr-has-index'>direction</span>: 3</li><li><span class='xr-has-index'>statecomb</span>: 3</li><li><span class='xr-has-index'>full_statecomb</span>: 6</li><li><span class='xr-has-index'>trajid_</span>: 16</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-91636c99-6891-4430-8fb0-de3bfcfa344b' class='xr-section-summary-in' type='checkbox'  ><label for='section-91636c99-6891-4430-8fb0-de3bfcfa344b' class='xr-section-summary' >Coordinates: <span>(24)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>state</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3</div><input id='attrs-77276383-7c54-4ca5-b4a8-73d950ed22c3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-77276383-7c54-4ca5-b4a8-73d950ed22c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-068f01a7-3279-4c01-a874-fe5bb47bbd08' class='xr-var-data-in' type='checkbox'><label for='data-068f01a7-3279-4c01-a874-fe5bb47bbd08' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Index of relevant states for indexing</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([1, 2, 3])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frame</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-c6ea4437-21ec-4dbf-8881-070338cae293' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c6ea4437-21ec-4dbf-8881-070338cae293' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-560a96d7-471b-4579-9470-16d6193db852' class='xr-var-data-in' type='checkbox'><label for='data-560a96d7-471b-4579-9470-16d6193db852' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>atom</span></div><div class='xr-var-dims'>(atom)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-cc9dbf01-5634-4b4c-a415-1b3f09ee3218' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cc9dbf01-5634-4b4c-a415-1b3f09ee3218' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e14400a-b616-45d4-aad0-e6f5c78d9747' class='xr-var-data-in' type='checkbox'><label for='data-4e14400a-b616-45d4-aad0-e6f5c78d9747' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>direction</span></div><div class='xr-var-dims'>(direction)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27;</div><input id='attrs-bf21996b-8e21-4477-9d9f-3c73335a7d9b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bf21996b-8e21-4477-9d9f-3c73335a7d9b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f4400614-c643-4eb0-9f74-5fa531c44941' class='xr-var-data-in' type='checkbox'><label for='data-f4400614-c643-4eb0-9f74-5fa531c44941' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>statecomb</span></div><div class='xr-var-dims'>(statecomb)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-7d3f4182-0f8d-4712-aa44-2b9c7f1219e0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7d3f4182-0f8d-4712-aa44-2b9c7f1219e0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c9400dca-9514-4fad-b9ae-9665d23f4fe8' class='xr-var-data-in' type='checkbox'><label for='data-c9400dca-9514-4fad-b9ae-9665d23f4fe8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[3 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>full_statecomb</span></div><div class='xr-var-dims'>(full_statecomb)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-7b92c9db-9f8b-480c-aaa8-4f1598cc79d1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7b92c9db-9f8b-480c-aaa8-4f1598cc79d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2894b671-d650-4327-8313-359f80c3e448' class='xr-var-data-in' type='checkbox'><label for='data-2894b671-d650-4327-8313-359f80c3e448' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>trajid_</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3 4 6 7 8 ... 13 14 17 18 19 20</div><input id='attrs-f70cd609-0f20-4124-89a0-931465ae03b0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f70cd609-0f20-4124-89a0-931465ae03b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7fbf07d-2b10-48cb-8301-4856af02dd4b' class='xr-var-data-in' type='checkbox'><label for='data-e7fbf07d-2b10-48cb-8301-4856af02dd4b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1,  2,  3,  4,  6,  7,  8,  9, 10, 12, 13, 14, 17, 18, 19, 20])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>state_names</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>&lt;U2</div><div class='xr-var-preview xr-preview'>&#x27;S0&#x27; &#x27;S1&#x27; &#x27;S2&#x27;</div><input id='attrs-8768d448-0eb7-4dab-ae6c-23766a394d66' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8768d448-0eb7-4dab-ae6c-23766a394d66' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5b4f110c-bd58-4a15-8be6-8e8266025469' class='xr-var-data-in' type='checkbox'><label for='data-5b4f110c-bd58-4a15-8be6-8e8266025469' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>String representations of the states.</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;S0&#x27;, &#x27;S1&#x27;, &#x27;S2&#x27;], dtype=&#x27;&lt;U2&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>state_types</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>1 1 1</div><input id='attrs-9c0674dd-73f1-4fbc-9187-5193efd74283' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9c0674dd-73f1-4fbc-9187-5193efd74283' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b79ef9f3-6cb8-47bd-9992-eeb11dfef540' class='xr-var-data-in' type='checkbox'><label for='data-b79ef9f3-6cb8-47bd-9992-eeb11dfef540' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Multiplicity to indicate whether the respective state is singlet (1), doublet (2), or triplet(3)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([1, 1, 1], dtype=int8)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>state_charges</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0</div><input id='attrs-bc5af654-ef6b-4128-9d5f-9e36996a2a66' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bc5af654-ef6b-4128-9d5f-9e36996a2a66' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bd6b339-c301-420e-842f-9f9aaa8c2399' class='xr-var-data-in' type='checkbox'><label for='data-9bd6b339-c301-420e-842f-9f9aaa8c2399' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Charge of the various states.</dd><dt><span>unitdim :</span></dt><dd>charge</dd><dt><span>units :</span></dt><dd>e</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([0., 0., 0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>atNames</span></div><div class='xr-var-dims'>(atom)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;C&#x27; &#x27;H&#x27; &#x27;H&#x27; &#x27;C&#x27; ... &#x27;H&#x27; &#x27;N&#x27; &#x27;H&#x27; &#x27;H&#x27;</div><input id='attrs-11538bc9-a2e4-4b12-90eb-c453132a3873' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-11538bc9-a2e4-4b12-90eb-c453132a3873' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4846f564-bbc5-419b-9818-fc835f5d41a0' class='xr-var-data-in' type='checkbox'><label for='data-4846f564-bbc5-419b-9818-fc835f5d41a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Names of atomic elements (short form)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;C&#x27;, &#x27;H&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;N&#x27;, &#x27;H&#x27;,
       &#x27;H&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>atNums</span></div><div class='xr-var-dims'>(atom)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>6 1 1 6 1 6 1 6 1 6 1 7 1 1</div><input id='attrs-65563f24-057f-4f06-bbdb-3a1c265fc360' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-65563f24-057f-4f06-bbdb-3a1c265fc360' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e09ae2ea-de29-4fba-bfc0-6608ebd687f2' class='xr-var-data-in' type='checkbox'><label for='data-e09ae2ea-de29-4fba-bfc0-6608ebd687f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Periodic number of atomic elements</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([6, 1, 1, 6, 1, 6, 1, 6, 1, 6, 1, 7, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>from</span></div><div class='xr-var-dims'>(statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 2</div><input id='attrs-98aae22d-da9f-4874-9ea5-4fe29cbbfbc7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-98aae22d-da9f-4874-9ea5-4fe29cbbfbc7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b6474791-8c02-408a-bb31-947ff75d7d82' class='xr-var-data-in' type='checkbox'><label for='data-b6474791-8c02-408a-bb31-947ff75d7d82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the first state of a statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[3 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>to</span></div><div class='xr-var-dims'>(statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 3 3</div><input id='attrs-1cfd1c4c-0b67-41c5-8cb8-10051ab039d3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1cfd1c4c-0b67-41c5-8cb8-10051ab039d3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-50da5783-7fad-4492-a927-080f5d8ca084' class='xr-var-data-in' type='checkbox'><label for='data-50da5783-7fad-4492-a927-080f5d8ca084' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the second state of a statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[3 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>full_statecomb_from</span></div><div class='xr-var-dims'>(full_statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 2 2 3 3</div><input id='attrs-0224993a-af10-4da9-9fa5-ee51ee36ddce' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0224993a-af10-4da9-9fa5-ee51ee36ddce' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5014f8d6-76c5-4c01-a611-526c2711682b' class='xr-var-data-in' type='checkbox'><label for='data-5014f8d6-76c5-4c01-a611-526c2711682b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the first state of a full_statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>full_statecomb_to</span></div><div class='xr-var-dims'>(full_statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 3 1 3 1 2</div><input id='attrs-60bf9470-4fd9-4458-90c5-64f51e295d9f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-60bf9470-4fd9-4458-90c5-64f51e295d9f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8dd136a9-1b88-439c-838d-c41ea8d73b38' class='xr-var-data-in' type='checkbox'><label for='data-8dd136a9-1b88-439c-838d-c41ea8d73b38' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the second state of a full_statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>trajid</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>3 3 3 3 3 3</div><input id='attrs-6ac817f8-8ce3-4bd8-9b0d-a4f1c182090a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6ac817f8-8ce3-4bd8-9b0d-a4f1c182090a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4c5580c7-f64d-4cda-aba8-31bb7e551ac4' class='xr-var-data-in' type='checkbox'><label for='data-4c5580c7-f64d-4cda-aba8-31bb7e551ac4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[6 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>168.0 168.5 169.0 169.5 170.0 170.5</div><input id='attrs-d36d089e-cbcf-427d-abbf-8972007b1394' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d36d089e-cbcf-427d-abbf-8972007b1394' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60b027d7-da92-4359-a0e0-f4950df1a958' class='xr-var-data-in' type='checkbox'><label for='data-60b027d7-da92-4359-a0e0-f4950df1a958' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time in trajectory or timestep</dd><dt><span>unitdim :</span></dt><dd>time</dd><dt><span>units :</span></dt><dd>fs</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>input_format</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>&lt;U5</div><div class='xr-var-preview xr-preview'>&#x27;sharc&#x27; &#x27;sharc&#x27; ... &#x27;sharc&#x27; &#x27;sharc&#x27;</div><input id='attrs-6e1fa54d-53f3-4432-a458-740c6ad048f4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6e1fa54d-53f3-4432-a458-740c6ad048f4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-86d43129-2de9-4f1f-b10c-464c72636ee9' class='xr-var-data-in' type='checkbox'><label for='data-86d43129-2de9-4f1f-b10c-464c72636ee9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;,
       &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;, &#x27;sharc&#x27;,
       &#x27;sharc&#x27;, &#x27;sharc&#x27;], dtype=&#x27;&lt;U5&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t_max</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03 1e+03 1e+03 ... 1e+03 1e+03</div><input id='attrs-bf469442-48fa-4942-a793-0b685dc8cc0b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bf469442-48fa-4942-a793-0b685dc8cc0b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70574f2c-7ef5-41af-866f-784372029b88' class='xr-var-data-in' type='checkbox'><label for='data-70574f2c-7ef5-41af-866f-784372029b88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1000., 1000., 1000., 1000., 1000., 1000., 1000., 1000., 1000.,
       1000., 1000., 1000., 1000., 1000., 1000., 1000.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>max_ts</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>384 367 444 106 ... 450 449 335 439</div><input id='attrs-7d63438e-aab4-4b4a-9391-86621dd9b897' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d63438e-aab4-4b4a-9391-86621dd9b897' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fb8b4c10-dcae-40ec-b94e-6219bc25effe' class='xr-var-data-in' type='checkbox'><label for='data-fb8b4c10-dcae-40ec-b94e-6219bc25effe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([384, 367, 444, 106, 443, 450, 444, 356, 447, 442, 451, 445, 450,
       449, 335, 439])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>completed</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False False False ... False False</div><input id='attrs-d897778d-8f8d-4c4b-b143-f7cd5fe62411' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d897778d-8f8d-4c4b-b143-f7cd5fe62411' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6b5aedb5-31fb-4842-aac2-5c1881eae249' class='xr-var-data-in' type='checkbox'><label for='data-6b5aedb5-31fb-4842-aac2-5c1881eae249' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([False, False, False, False, False, False, False, False, False,
       False, False, False, False, False, False, False])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>has_forces</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True True True ... True True True</div><input id='attrs-238c8e67-4807-4d76-8b5b-5999692c6f94' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-238c8e67-4807-4d76-8b5b-5999692c6f94' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-abf6cbd5-4120-49ae-812a-125bec615b68' class='xr-var-data-in' type='checkbox'><label for='data-abf6cbd5-4120-49ae-812a-125bec615b68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ True,  True,  True,  True,  True,  True,  True,  True,  True,
        True,  True,  True,  True,  True,  True,  True])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trajectory_input_path</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>&lt;U31</div><div class='xr-var-preview xr-preview'>&#x27;retinal_tutorial/I02/TRAJ_00001...</div><input id='attrs-def8af0a-200f-464a-a14a-8d3ac64fbaec' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-def8af0a-200f-464a-a14a-8d3ac64fbaec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8b6891a6-a9d7-4d9e-a228-45d387cabcb9' class='xr-var-data-in' type='checkbox'><label for='data-8b6891a6-a9d7-4d9e-a228-45d387cabcb9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;retinal_tutorial/I02/TRAJ_00001&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00002&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00003&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00004&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00006&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00007&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00008&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00009&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00010&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00012&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00013&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00014&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00017&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00018&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00019&#x27;,
       &#x27;retinal_tutorial/I02/TRAJ_00020&#x27;], dtype=&#x27;&lt;U31&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e1c0ede0-ec6d-43af-9a9b-27ca337e35ae' class='xr-section-summary-in' type='checkbox'  ><label for='section-e1c0ede0-ec6d-43af-9a9b-27ca337e35ae' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>energy</span></div><div class='xr-var-dims'>(state, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-248.1 -248.1 ... -247.9 -247.9</div><input id='attrs-de116d31-ab19-4b70-ae4a-af781993ab36' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-de116d31-ab19-4b70-ae4a-af781993ab36' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-397975ce-038b-488c-82d0-cdf133fbfb19' class='xr-var-data-in' type='checkbox'><label for='data-397975ce-038b-488c-82d0-cdf133fbfb19' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Absolute energy</dd><dt><span>unitdim :</span></dt><dd>energy</dd><dt><span>units :</span></dt><dd>Hartree</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[-248.10182, -248.1104 , -248.1197 , -248.12735, -248.13043,
        -248.12714],
       [-247.94844, -247.95897, -247.9692 , -247.97676, -247.9789 ,
        -247.97397],
       [-247.9127 , -247.92084, -247.92926, -247.93558, -247.93689,
        -247.93137]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>forces</span></div><div class='xr-var-dims'>(state, atom, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.09396 0.09677 ... -0.004977</div><input id='attrs-71700dc0-412f-4aa4-a80b-44c80111d566' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-71700dc0-412f-4aa4-a80b-44c80111d566' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-653ce654-37f3-4945-972f-07330096f658' class='xr-var-data-in' type='checkbox'><label for='data-653ce654-37f3-4945-972f-07330096f658' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Per-atom forces</dd><dt><span>unitdim :</span></dt><dd>force</dd><dt><span>units :</span></dt><dd>Hartree/Bohr</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 9.39617231e-02,  9.67722759e-02,  9.55040529e-02,
           8.83282200e-02,  7.35267624e-02,  5.09329401e-02],
         [ 5.38781099e-02,  6.01817109e-02,  6.42979741e-02,
           6.39029592e-02,  5.61419874e-02,  3.90348621e-02],
         [-8.96067396e-02, -8.86903629e-02, -8.18869695e-02,
          -6.87297806e-02, -5.00618741e-02, -2.87945215e-02]],

        [[ 2.06164792e-02,  1.61621757e-02,  1.09157804e-02,
           5.10897022e-03, -7.58397102e-04, -5.93712321e-03],
         [ 1.53241931e-02,  1.56921695e-03, -1.39079783e-02,
          -3.02952360e-02, -4.61326092e-02, -5.93758523e-02],
         [ 4.15927246e-02,  3.42957079e-02,  2.32261345e-02,
           8.66391789e-03, -8.03535059e-03, -2.41898969e-02]],

        [[-5.96890710e-02, -5.25083803e-02, -4.09453101e-02,
          -2.35979408e-02,  6.18200400e-04,  3.10686436e-02],
         [-4.03854884e-02, -3.21674682e-02, -1.98242962e-02,
          -1.83231244e-03,  2.31995229e-02,  5.51655926e-02],
         [ 1.61757823e-02,  1.34694660e-02,  9.42563266e-03,
           3.63487168e-03, -4.18048212e-03, -1.37021746e-02]],
...
          -7.24890223e-03, -2.38775043e-03, -3.16626276e-03],
         [-4.14156541e-02, -3.06728762e-02, -1.49675803e-02,
           2.59657041e-03,  1.86928809e-02,  3.13242897e-02],
         [-6.32684827e-02, -3.92496847e-02, -2.38328259e-02,
          -1.54235139e-02, -1.11713503e-02, -8.67309701e-03]],

        [[-5.93128800e-03, -6.74582180e-03, -6.14143116e-03,
          -5.10951271e-03, -4.49262979e-03, -4.59661707e-03],
         [ 6.12111539e-02,  6.16497919e-02,  5.14153801e-02,
           3.31429765e-02,  1.13335699e-02, -9.87155363e-03],
         [-3.21717039e-02, -3.38880233e-02, -2.83137932e-02,
          -1.76663715e-02, -5.31222206e-03,  5.90168731e-03]],

        [[-2.33332012e-02, -3.28145884e-02, -3.52733061e-02,
          -2.97220070e-02, -1.76894125e-02, -2.34737410e-03],
         [-5.09885326e-02, -5.75903170e-02, -5.80792055e-02,
          -5.21872491e-02, -4.12699692e-02, -2.76327264e-02],
         [-9.46231745e-03, -8.30208696e-03, -7.43975956e-03,
          -6.74304692e-03, -5.98619273e-03, -4.97694779e-03]]]],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>atXYZ</span></div><div class='xr-var-dims'>(atom, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-3.376 -3.377 ... 1.697 1.726</div><input id='attrs-919f620c-5958-45d3-ab44-62a4612a52ae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-919f620c-5958-45d3-ab44-62a4612a52ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b101c35-a2b9-4f83-9e62-9962240f01ce' class='xr-var-data-in' type='checkbox'><label for='data-0b101c35-a2b9-4f83-9e62-9962240f01ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Positions</dd><dt><span>unitdim :</span></dt><dd>length</dd><dt><span>units :</span></dt><dd>Bohr</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[-3.3757823e+00, -3.3766909e+00, -3.3794899e+00, -3.3841541e+00,
         -3.3905437e+00, -3.3983698e+00],
        [ 9.4977957e-01,  9.4142139e-01,  9.3188769e-01,  9.2109805e-01,
          9.0906018e-01,  8.9592570e-01],
        [ 1.3616781e+00,  1.3593034e+00,  1.3586608e+00,  1.3596179e+00,
          1.3619175e+00,  1.3651948e+00]],

       [[-2.9797394e+00, -2.9977307e+00, -3.0194812e+00, -3.0437706e+00,
         -3.0692477e+00, -3.0945489e+00],
        [ 2.4061804e+00,  2.3027015e+00,  2.1988575e+00,  2.0982482e+00,
          2.0046849e+00,  1.9218510e+00],
        [ 2.9310291e+00,  2.9506485e+00,  2.9622920e+00,  2.9685333e+00,
          2.9727595e+00,  2.9788549e+00]],

       [[-4.9874582e+00, -4.9478230e+00, -4.8959761e+00, -4.8346057e+00,
         -4.7677469e+00, -4.7010326e+00],
        [-6.0245842e-01, -5.7908511e-01, -5.4823047e-01, -5.1276511e-01,
         -4.7687367e-01, -4.4637781e-01],
        [ 2.0129817e+00,  1.9794229e+00,  1.9427316e+00,  1.9038481e+00,
          1.8641192e+00,  1.8253626e+00]],
...
       [[ 4.2061124e+00,  4.2172642e+00,  4.2287660e+00,  4.2402029e+00,
          4.2513418e+00,  4.2620974e+00],
        [ 5.7123051e+00,  5.7254872e+00,  5.7392354e+00,  5.7532835e+00,
          5.7673340e+00,  5.7811165e+00],
        [ 1.5891411e+00,  1.6023424e+00,  1.6157429e+00,  1.6290590e+00,
          1.6421299e+00,  1.6548687e+00]],

       [[ 4.5571375e+00,  4.5344238e+00,  4.5136495e+00,  4.4946842e+00,
          4.4772878e+00,  4.4613152e+00],
        [ 4.3039107e+00,  4.3049827e+00,  4.2903857e+00,  4.2624626e+00,
          4.2254577e+00,  4.1844654e+00],
        [ 2.6355381e+00,  2.6389253e+00,  2.6495168e+00,  2.6659980e+00,
          2.6858835e+00,  2.7062941e+00]],

       [[ 5.6599751e+00,  5.6690841e+00,  5.6850510e+00,  5.7084556e+00,
          5.7380118e+00,  5.7709146e+00],
        [ 6.8174248e+00,  6.8030362e+00,  6.8034544e+00,  6.8188791e+00,
          6.8479710e+00,  6.8881726e+00],
        [ 1.6032978e+00,  1.6224188e+00,  1.6444451e+00,  1.6692258e+00,
          1.6966217e+00,  1.7264556e+00]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dip_perm</span></div><div class='xr-var-dims'>(state, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>6.881 6.804 6.745 ... 1.757 1.823</div><input id='attrs-2d541c1a-3d91-4e88-b28e-4b5964f647f6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2d541c1a-3d91-4e88-b28e-4b5964f647f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e5e170d-a5ee-430c-9722-eb5616fe658c' class='xr-var-data-in' type='checkbox'><label for='data-2e5e170d-a5ee-430c-9722-eb5616fe658c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Permanent dipoles</dd><dt><span>unitdim :</span></dt><dd>dipole</dd><dt><span>units :</span></dt><dd>debye</dd><dt><span>original_units :</span></dt><dd>au</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[ 6.8807735 ,  6.8037806 ,  6.7447977 ,  6.707592  ,
          6.6904716 ,  6.688168  ],
        [11.706605  , 11.648751  , 11.6093025 , 11.591593  ,
         11.595836  , 11.620151  ],
        [ 2.6092458 ,  2.5672133 ,  2.528387  ,  2.495125  ,
          2.467406  ,  2.4436767 ]],

       [[ 1.1344402 ,  1.0542105 ,  0.95152694,  0.8334148 ,
          0.71040714,  0.5945155 ],
        [ 6.2947035 ,  6.255288  ,  6.204817  ,  6.1500316 ,
          6.1020937 ,  6.0738616 ],
        [ 1.6942936 ,  1.7035066 ,  1.7212085 ,  1.7477825 ,
          1.7833953 ,  1.8280956 ]],

       [[ 6.4344606 ,  6.1756697 ,  5.9662185 ,  5.81915   ,
          5.734137  ,  5.7019687 ],
        [10.340711  , 10.113953  ,  9.933912  ,  9.811457  ,
          9.745744  ,  9.727619  ],
        [ 1.7562113 ,  1.7179983 ,  1.7036014 ,  1.7165953 ,
          1.756664  ,  1.8227768 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dip_trans</span></div><div class='xr-var-dims'>(statecomb, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-4.033 -4.052 ... -0.04667 0.008147</div><input id='attrs-517a1293-4ada-4a8c-b95f-37fce84c70ee' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-517a1293-4ada-4a8c-b95f-37fce84c70ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-60ddb1e8-0de5-46a7-b402-056a9f314fcb' class='xr-var-data-in' type='checkbox'><label for='data-60ddb1e8-0de5-46a7-b402-056a9f314fcb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Transitional dipoles</dd><dt><span>unitdim :</span></dt><dd>dipole</dd><dt><span>units :</span></dt><dd>debye</dd><dt><span>original_units :</span></dt><dd>au</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[-4.033085  , -4.051831  , -4.065605  , -4.07475   ,
         -4.0808554 , -4.086285  ],
        [-3.0061786 , -3.0060809 , -2.9895294 , -2.9562285 ,
         -2.9081292 , -2.848668  ],
        [-0.617367  , -0.65701973, -0.68693525, -0.7072853 ,
         -0.72001153, -0.7283673 ]],

       [[ 1.3995291 ,  1.4345214 ,  1.4671462 ,  1.4986954 ,
          1.5287464 ,  1.5531693 ],
        [ 0.42187306,  0.45691794,  0.4916423 ,  0.5245874 ,
          0.55211633,  0.56781024],
        [-0.03904493,  0.06092017,  0.17197715,  0.2917202 ,
          0.41715258,  0.54529506]],

       [[ 0.7230795 ,  0.7379508 ,  0.7308652 ,  0.70457613,
          0.6546807 ,  0.5654755 ],
        [-0.19555007, -0.18729752, -0.19046189, -0.20251326,
         -0.22689468, -0.27575776],
        [-0.23239605, -0.19481586, -0.15098861, -0.10101101,
         -0.04667452,  0.0081474 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>socs</span></div><div class='xr-var-dims'>(full_statecomb, frame)</div><div class='xr-var-dtype'>complex128</div><div class='xr-var-preview xr-preview'>0j 0j 0j 0j 0j ... 0j 0j 0j 0j 0j</div><input id='attrs-4ba63ada-f4ce-452e-8cc6-f085840fa63e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4ba63ada-f4ce-452e-8cc6-f085840fa63e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eee6237a-17ec-4cdb-afb8-b0b0195939f2' class='xr-var-data-in' type='checkbox'><label for='data-eee6237a-17ec-4cdb-afb8-b0b0195939f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Spin-orbit couplings</dd><dt><span>unitdim :</span></dt><dd>socs</dd><dt><span>units :</span></dt><dd>1/cm</dd><dt><span>original_units :</span></dt><dd>Hartree</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j, 0.+0.j]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>astate</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1</div><input id='attrs-a5353949-7ebe-4a0b-a683-683841aae7fa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a5353949-7ebe-4a0b-a683-683841aae7fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aff35881-680a-42d0-8350-7bb9ead88f00' class='xr-var-data-in' type='checkbox'><label for='data-aff35881-680a-42d0-8350-7bb9ead88f00' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Active state in dynamic trajectories (MCH)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([1, 1, 1, 1, 1, 1], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sdiag</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 1 1 1 1 1</div><input id='attrs-c35f5c0c-26b1-4189-aa55-2732330d5773' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c35f5c0c-26b1-4189-aa55-2732330d5773' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-15892c4d-5615-4d6e-a832-5fbfdea4cfa2' class='xr-var-data-in' type='checkbox'><label for='data-15892c4d-5615-4d6e-a832-5fbfdea4cfa2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Active state (diag)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([1, 1, 1, 1, 1, 1], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>phases</span></div><div class='xr-var-dims'>(state, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0 1.0</div><input id='attrs-9152a3fe-8d84-4b5c-ab50-223c325c6cf0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9152a3fe-8d84-4b5c-ab50-223c325c6cf0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dc5f6443-519f-46c9-b498-0a8e6197dc7e' class='xr-var-data-in' type='checkbox'><label for='data-dc5f6443-519f-46c9-b498-0a8e6197dc7e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Phase vector</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[1., 1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1., 1.]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3e8de755-5009-4dbb-8a13-de75c7e64caa' class='xr-section-summary-in' type='checkbox'  ><label for='section-3e8de755-5009-4dbb-8a13-de75c7e64caa' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>input_format_version :</span></dt><dd>3.0</dd><dt><span>delta_t :</span></dt><dd>0.5</dd><dt><span>num_triplets :</span></dt><dd>0</dd><dt><span>input_type :</span></dt><dd>dynamic</dd><dt><span>num_singlets :</span></dt><dd>3</dd><dt><span>num_doublets :</span></dt><dd>0</dd></dl></div></li></ul></div></div></div>
</div>
</section>
<section id="3.2)-View-geometries-for-selected-frames">
<h2>3.2) View geometries for selected frames<a class="headerlink" href="#3.2)-View-geometries-for-selected-frames" title="Link to this heading">#</a></h2>
<p>If the following gives the error <code class="docutils literal notranslate"><span class="pre">ValueError:</span> <span class="pre">frame</span> <span class="pre">must</span> <span class="pre">not</span> <span class="pre">be</span> <span class="pre">empty</span></code>, please ensure you have selected some points above.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span><span class="o">.</span><span class="n">atXYZ</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">frames3Dgrid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id="3dmolviewer_17658854297618735"  style="position: relative; width: 1000px; height: 800px;">
        <p id="3dmolwarning_17658854297618735" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdn.jsdelivr.net/npm/3dmol@2.5.3/build/3Dmol-min.js');
}

var viewer_17658854297618735 = null;
var warn = document.getElementById("3dmolwarning_17658854297618735");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
var viewergrid_17658854297618735 = null;
viewergrid_17658854297618735 = $3Dmol.createViewerGrid(document.getElementById("3dmolviewer_17658854297618735"),{rows: 3, cols: 3, control_all: true},{backgroundColor:"white"});
viewer_17658854297618735 = viewergrid_17658854297618735[0][0];
viewergrid_17658854297618735[0][0].zoomTo();viewergrid_17658854297618735[0][1].zoomTo();viewergrid_17658854297618735[0][2].zoomTo();viewergrid_17658854297618735[1][0].zoomTo();viewergrid_17658854297618735[1][1].zoomTo();viewergrid_17658854297618735[1][2].zoomTo();viewergrid_17658854297618735[2][0].zoomTo();viewergrid_17658854297618735[2][1].zoomTo();viewergrid_17658854297618735[2][2].zoomTo();        viewergrid_17658854297618735[0][0].addModel("          14\n  #\nC     -1.786386966705322      0.502601683139801      0.720569014549255\nH     -1.576810121536255      1.273295760154724      1.551033735275269\nH     -2.639249086380005     -0.318807244300842      1.065223932266235\nC     -1.082045316696167      0.374143123626709     -0.415397107601166\nH     -0.760552942752838     -0.656491100788116     -0.685581207275391\nC     -0.363270968198776      1.526325345039368     -0.510986983776093\nH     -0.489207476377487      2.471517562866211     -0.041897863149643\nC      1.037857532501221      1.659195184707642     -0.483346074819565\nH      1.715076446533203      0.816539168357849     -0.414289474487305\nC      1.403114676475525      3.009838819503784     -0.069926150143147\nH      1.211091518402100      3.899689912796021     -0.609389662742615\nN      2.225778818130493      3.022821426391602      0.840937256813049\nH      2.411533117294312      2.277531385421753      1.394666671752930\nH      2.995129585266113      3.607625722885132      0.848428666591644");
    viewergrid_17658854297618735[0][0].addLabel([3, 168.0],{"useScreen": true, "screenOffset": {"x": 25, "y": -50}});
    viewergrid_17658854297618735[0][1].addModel("          14\n  #\nC     -1.786867737770081      0.498178720474243      0.719312310218811\nH     -1.586330771446228      1.218537092208862      1.561415910720825\nH     -2.618275165557861     -0.306438624858856      1.047465443611145\nC     -1.088384151458740      0.372699201107025     -0.409643262624741\nH     -0.763133883476257     -0.650150299072266     -0.698373138904572\nC     -0.361628800630569      1.539173245429993     -0.511824786663055\nH     -0.483962386846542      2.480550765991211     -0.030767083168030\nC      1.039719462394714      1.649787425994873     -0.488445043563843\nH      1.711236953735352      0.819914340972900     -0.369558185338974\nC      1.399439096450806      3.005454540252686     -0.080069109797478\nH      1.209264755249023      3.914551258087158     -0.616147398948669\nN      2.231679916381836      3.029797315597534      0.847923040390015\nH      2.399513721466064      2.278098583221436      1.396459102630615\nH      2.999949932098389      3.600011587142944      0.858546972274780");
    viewergrid_17658854297618735[0][1].addLabel([3, 168.5],{"useScreen": true, "screenOffset": {"x": 25, "y": -50}});
    viewergrid_17658854297618735[0][2].addModel("          14\n  #\nC     -1.788348913192749      0.493133693933487      0.718972325325012\nH     -1.597840547561646      1.163585305213928      1.567577362060547\nH     -2.590838909149170     -0.290111064910889      1.028049230575562\nC     -1.094858050346375      0.370878964662552     -0.403792917728424\nH     -0.767402827739716     -0.640840113162994     -0.713125646114349\nC     -0.358618736267090      1.552415609359741     -0.512786686420441\nH     -0.487897068262100      2.490633964538574     -0.020873188972473\nC      1.041039586067200      1.640556693077087     -0.493661373853683\nH      1.708773970603943      0.823437154293060     -0.325478404760361\nC      1.395975351333618      3.000456571578979     -0.090687178075314\nH      1.206381201744080      3.930165052413940     -0.623524487018585\nN      2.237766504287720      3.037072420120239      0.855014324188232\nH      2.388520240783691      2.270374298095703      1.402063846588135\nH      3.008399248123169      3.600232839584351      0.870202839374542");
    viewergrid_17658854297618735[0][2].addLabel([3, 169.0],{"useScreen": true, "screenOffset": {"x": 25, "y": -50}});
    viewergrid_17658854297618735[1][0].addModel("          14\n  #\nC     -1.790817141532898      0.487424075603485      0.719478785991669\nH     -1.610693931579590      1.110345125198364      1.570880055427551\nH     -2.558362960815430     -0.271343588829041      1.007472991943359\nC     -1.101310014724731      0.368871361017227     -0.397958397865295\nH     -0.773396134376526     -0.628850936889648     -0.729807853698730\nC     -0.354411393404007      1.565854907035828     -0.513845086097717\nH     -0.500675022602081      2.501582145690918     -0.012486088089645\nC      1.041844844818115      1.631635308265686     -0.498959660530090\nH      1.707813739776611      0.826473891735077     -0.282228767871857\nC      1.392950415611267      2.994992733001709     -0.101589471101761\nH      1.202595472335815      3.945146560668945     -0.630950689315796\nN      2.243818759918213      3.044506311416626      0.862060844898224\nH      2.378484249114990      2.255598068237305      1.410785317420959\nH      3.020784378051758      3.608395338058472      0.883316218852997");
    viewergrid_17658854297618735[1][0].addLabel([3, 169.5],{"useScreen": true, "screenOffset": {"x": 25, "y": -50}});
    viewergrid_17658854297618735[1][1].addModel("          14\n  #\nC     -1.794198393821716      0.481053918600082      0.720695674419403\nH     -1.624175906181335      1.060833573341370      1.573116540908813\nH     -2.522982835769653     -0.252350658178329      0.986449360847473\nC     -1.107594728469849      0.366870820522308     -0.392238855361938\nH     -0.781101107597351     -0.614636182785034     -0.748429715633392\nC     -0.349198698997498      1.579309225082397     -0.514963567256927\nH     -0.521730840206146      2.513100862503052     -0.005972301587462\nC      1.042190670967102      1.623128056526184     -0.504303157329559\nH      1.708227038383484      0.828663229942322     -0.240013077855110\nC      1.390561819076538      2.989212274551392     -0.112601824104786\nH      1.198057413101196      3.958208799362183     -0.637924253940582\nN      2.249713182449341      3.051941633224487      0.868977665901184\nH      2.369278669357300      2.236015796661377      1.421308279037476\nH      3.036424875259399      3.623790025711060      0.897813498973846");
    viewergrid_17658854297618735[1][1].addLabel([3, 170.0],{"useScreen": true, "screenOffset": {"x": 25, "y": -50}});
    viewergrid_17658854297618735[1][2].addModel("          14\n  #\nC     -1.798339724540710      0.474103450775146      0.722429931163788\nH     -1.637564659118652      1.016999721527100      1.576342105865479\nH     -2.487679243087769     -0.236212953925133      0.965940237045288\nC     -1.113581538200378      0.365070015192032     -0.386717349290848\nH     -0.790463566780090     -0.598770678043365     -0.769038975238800\nC     -0.343190521001816      1.592616558074951     -0.516099035739899\nH     -0.550285696983337      2.524806737899780     -0.001776960911229\nC      1.042161822319031      1.615111708641052     -0.509650349617004\nH      1.709631443023682      0.829926848411560     -0.199105098843575\nC      1.388975739479065      2.983258008956909     -0.123565569519997\nH      1.192904233932495      3.968249559402466     -0.644050061702728\nN      2.255404710769653      3.059234857559204      0.875718772411346\nH      2.360826253890991      2.214323759078979      1.432109117507935\nH      3.053836345672607      3.645063877105713      0.913600921630859");
    viewergrid_17658854297618735[1][2].addLabel([3, 170.5],{"useScreen": true, "screenOffset": {"x": 25, "y": -50}});
    viewergrid_17658854297618735[0][0].setStyle({"stick": {"showNonBonded": true}});
    viewergrid_17658854297618735[0][1].setStyle({"stick": {"showNonBonded": true}});
    viewergrid_17658854297618735[0][2].setStyle({"stick": {"showNonBonded": true}});
    viewergrid_17658854297618735[1][0].setStyle({"stick": {"showNonBonded": true}});
    viewergrid_17658854297618735[1][1].setStyle({"stick": {"showNonBonded": true}});
    viewergrid_17658854297618735[1][2].setStyle({"stick": {"showNonBonded": true}});
    viewergrid_17658854297618735[2][0].setStyle({"stick": {"showNonBonded": true}});
    viewergrid_17658854297618735[2][1].setStyle({"stick": {"showNonBonded": true}});
    viewergrid_17658854297618735[2][2].setStyle({"stick": {"showNonBonded": true}});
    viewergrid_17658854297618735[0][0].zoomTo();
    viewergrid_17658854297618735[0][1].zoomTo();
    viewergrid_17658854297618735[0][2].zoomTo();
    viewergrid_17658854297618735[1][0].zoomTo();
    viewergrid_17658854297618735[1][1].zoomTo();
    viewergrid_17658854297618735[1][2].zoomTo();
    viewergrid_17658854297618735[2][0].zoomTo();
    viewergrid_17658854297618735[2][1].zoomTo();
    viewergrid_17658854297618735[2][2].zoomTo();
viewergrid_17658854297618735[2][2].render();
viewergrid_17658854297618735[2][1].render();
viewergrid_17658854297618735[2][0].render();
viewergrid_17658854297618735[1][2].render();
viewergrid_17658854297618735[1][1].render();
viewergrid_17658854297618735[1][0].render();
viewergrid_17658854297618735[0][2].render();
viewergrid_17658854297618735[0][1].render();
viewergrid_17658854297618735[0][0].render();
});
</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;py3Dmol.view at 0x7f3a7119cb00&gt;
</pre></div></div>
</div>
</section>
</section>
<section id="4)-Trajectory-level-selection">
<h1>4) Trajectory-level selection<a class="headerlink" href="#4)-Trajectory-level-selection" title="Link to this heading">#</a></h1>
<section id="4.1)-Select-trajectories-from-PCA">
<h2>4.1) Select trajectories from PCA<a class="headerlink" href="#4.1)-Select-trajectories-from-PCA" title="Link to this heading">#</a></h2>
<p>There are two differences to the FrameSelector:</p>
<ul class="simple">
<li><p>when frames are selected, they show up as light green, but all other frames from their trajectory show up as dark green as well</p></li>
<li><p>a live-updating list of selected trajectories is displayed under the plot</p></li>
</ul>
<p>Please note that in Bokeh, additive selection is possible by holding Shift while clicking and dragging â€“ this may be particularly useful in selecting multiple trajectories.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selector</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">TrajSelector</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style>
    .bk-notebook-logo {
        display: block;
        width: 20px;
        height: 20px;
        background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNui8sowAAAOkSURBVDiNjZRtaJVlGMd/1/08zzln5zjP1LWcU9N0NkN8m2CYjpgQYQXqSs0I84OLIC0hkEKoPtiH3gmKoiJDU7QpLgoLjLIQCpEsNJ1vqUOdO7ppbuec5+V+rj4ctwzd8IIbbi6u+8f1539dt3A78eXC7QizUF7gyV1fD1Yqg4JWz84yffhm0qkFqBogB9rM8tZdtwVsPUhWhGcFJngGeWrPzHm5oaMmkfEg1usvLFyc8jLRqDOMru7AyC8saQr7GG7f5fvDeH7Ej8CM66nIF+8yngt6HWaKh7k49Soy9nXurCi1o3qUbS3zWfrYeQDTB/Qj6kX6Ybhw4B+bOYoLKCC9H3Nu/leUTZ1JdRWkkn2ldcCamzrcf47KKXdAJllSlxAOkRgyHsGC/zRday5Qld9DyoM4/q/rUoy/CXh3jzOu3bHUVZeU+DEn8FInkPBFlu3+nW3Nw0mk6vCDiWg8CeJaxEwuHS3+z5RgY+YBR6V1Z1nxSOfoaPa4LASWxxdNp+VWTk7+4vzaou8v8PN+xo+KY2xsw6une2frhw05CTYOmQvsEhjhWjn0bmXPjpE1+kplmmkP3suftwTubK9Vq22qKmrBhpY4jvd5afdRA3wGjFAgcnTK2s4hY0/GPNIb0nErGMCRxWOOX64Z8RAC4oCXdklmEvcL8o0BfkNK4lUg9HTl+oPlQxdNo3Mg4Nv175e/1LDGzZen30MEjRUtmXSfiTVu1kK8W4txyV6BMKlbgk3lMwYCiusNy9fVfvvwMxv8Ynl6vxoByANLTWplvuj/nF9m2+PDtt1eiHPBr1oIfhCChQMBw6Aw0UulqTKZdfVvfG7VcfIqLG9bcldL/+pdWTLxLUy8Qq38heUIjh4XlzZxzQm19lLFlr8vdQ97rjZVOLf8nclzckbcD4wxXMidpX30sFd37Fv/GtwwhzhxGVAprjbg0gCAEeIgwCZyTV2Z1REEW8O4py0wsjeloKoMr6iCY6dP92H6Vw/oTyICIthibxjm/DfN9lVz8IqtqKYLUXfoKVMVQVVJOElGjrnnUt9T9wbgp8AyYKaGlqingHZU/uG2NTZSVqwHQTWkx9hxjkpWDaCg6Ckj5qebgBVbT3V3NNXMSiWSDdGV3hrtzla7J+duwPOToIg42ChPQOQjspnSlp1V+Gjdged7+8UN5CRAV7a5EdFNwCjEaBR27b3W890TE7g24NAP/mMDXRWrGoFPQI9ls/MWO2dWFAar/xcOIImbbpA3zgAAAABJRU5ErkJggg==);
    }
</style>
<div>
    <a href="https://bokeh.org" target="_blank" class="bk-notebook-logo"></a>
    <span id="a45af92d-bb2a-4f2d-8ebe-4d8007cbce0c">Loading BokehJS ...</span>
</div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="output_javascript"></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;
'use strict';
(function(root) {
  function now() {
    return new Date();
  }

  const force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

const JS_MIME_TYPE = 'application/javascript';
  const HTML_MIME_TYPE = 'text/html';
  const EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  const CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    const script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    function drop(id) {
      const view = Bokeh.index.get_by_id(id)
      if (view != null) {
        view.model.document.clear()
        Bokeh.index.delete(view)
      }
    }

    const cell = handle.cell;

    const id = cell.output_area._bokeh_element_id;
    const server_id = cell.output_area._bokeh_server_id;

    // Clean up Bokeh references
    if (id != null) {
      drop(id)
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      const cmd_clean = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd_clean, {
        iopub: {
          output: function(msg) {
            const id = msg.content.text.trim()
            drop(id)
          }
        }
      });
      // Destroy server and session
      const cmd_destroy = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd_destroy);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    const output_area = handle.output_area;
    const output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!Object.prototype.hasOwnProperty.call(output.data, EXEC_MIME_TYPE))) {
      return
    }

    const toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      const bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      const script_attrs = bk_div.children[0].attributes;
      for (let i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      const toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      const props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    const events = require('base/js/events');
    const OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }
  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  const NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded(error = null) {
    const el = document.getElementById("a45af92d-bb2a-4f2d-8ebe-4d8007cbce0c");
    if (el != null) {
      const html = (() => {
        if (typeof root.Bokeh === "undefined") {
          if (error == null) {
            return "BokehJS is loading ...";
          } else {
            return "BokehJS failed to load.";
          }
        } else {
          const prefix = `BokehJS ${root.Bokeh.version}`;
          if (error == null) {
            return `${prefix} successfully loaded.`;
          } else {
            return `${prefix} <b>encountered errors</b> while loading and may not function as expected.`;
          }
        }
      })();
      el.innerHTML = html;

      if (error != null) {
        const wrapper = document.createElement("div");
        wrapper.style.overflow = "auto";
        wrapper.style.height = "5em";
        wrapper.style.resize = "vertical";
        const content = document.createElement("div");
        content.style.fontFamily = "monospace";
        content.style.whiteSpace = "pre-wrap";
        content.style.backgroundColor = "rgb(255, 221, 221)";
        content.textContent = error.stack ?? error.toString();
        wrapper.append(content);
        el.append(wrapper);
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(() => display_loaded(error), 100);
    }
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error(url) {
      console.error("failed to load " + url);
    }

    for (let i = 0; i < css_urls.length; i++) {
      const url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    for (let i = 0; i < js_urls.length; i++) {
      const url = js_urls[i];
      const element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error.bind(null, url);
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  const js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-3.8.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.8.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.8.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.8.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-3.8.1.min.js"];
  const css_urls = [];

  const inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {
    }
  ];

  function run_inline_js() {
    if (root.Bokeh !== undefined || force === true) {
      try {
            for (let i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }

      } catch (error) {display_loaded(error);throw error;
      }if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      const cell = $(document.getElementById("a45af92d-bb2a-4f2d-8ebe-4d8007cbce0c")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING: We appear to be running in VS Code and allowed_ws_origin was not provided, so setting allowed_ws_origin=&#39;*&#39;
INFO: Starting Bokeh server version 3.8.1 (running on Tornado 6.5.2)
INFO: User authentication hooks NOT provided (default user enabled)
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<script id="c22be7c5-ded9-40f8-a9cd-c19874ca09b6">
  (function() {
    const xhr = new XMLHttpRequest()
    xhr.responseType = 'blob';
    xhr.open('GET', "http://localhost:33329/autoload.js?bokeh-autoload-element=c22be7c5-ded9-40f8-a9cd-c19874ca09b6&bokeh-absolute-url=http://localhost:33329&resources=none", true);
    xhr.withCredentials = false;
    xhr.onload = function (event) {
      const script = document.createElement('script');
      const src = URL.createObjectURL(event.target.response);
      script.src = src;
      document.body.appendChild(script);
    };
    xhr.send();
  })();
</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO: 200 GET /autoload.js?bokeh-autoload-element=c22be7c5-ded9-40f8-a9cd-c19874ca09b6&amp;bokeh-absolute-url=http://localhost:33329&amp;resources=none (::1) 25.40ms
INFO:tornado.access:200 GET /autoload.js?bokeh-autoload-element=c22be7c5-ded9-40f8-a9cd-c19874ca09b6&amp;bokeh-absolute-url=http://localhost:33329&amp;resources=none (::1) 25.40ms
INFO: 101 GET /ws?id=7c11834a-bba9-4580-b7ce-1f1305a8a8a3&amp;origin=fde0f466-d350-4c7f-995b-8eef6d0b38d6&amp;swVersion=4&amp;extensionId=&amp;platform=electron&amp;vscode-resource-base-authority=vscode-resource.vscode-cdn.net&amp;parentOrigin=vscode-file%3A%2F%2Fvscode-app&amp;purpose=notebookRenderer (::1) 0.31ms
INFO:tornado.access:101 GET /ws?id=7c11834a-bba9-4580-b7ce-1f1305a8a8a3&amp;origin=fde0f466-d350-4c7f-995b-8eef6d0b38d6&amp;swVersion=4&amp;extensionId=&amp;platform=electron&amp;vscode-resource-base-authority=vscode-resource.vscode-cdn.net&amp;parentOrigin=vscode-file%3A%2F%2Fvscode-app&amp;purpose=notebookRenderer (::1) 0.31ms
INFO: WebSocket connection opened
INFO: ServerConnection created
</pre></div></div>
</div>
<p>The selection info exposed by the selector is actually the same. In either case, it is easy to find which trajids have been selected:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">selector</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">trajid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([3])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span> <span class="o">=</span> <span class="n">frames</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">sel_trajs</span><span class="p">(</span><span class="n">selector</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">trajid</span><span class="p">)</span>
<span class="n">subset</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in notebooks */

:root {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base rgba(0, 0, 0, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, white)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))
  );
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: var(
    --jp-content-font-color0,
    var(--pst-color-text-base, rgba(255, 255, 255, 1))
  );
  --xr-font-color2: var(
    --jp-content-font-color2,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))
  );
  --xr-font-color3: var(
    --jp-content-font-color3,
    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))
  );
  --xr-border-color: var(
    --jp-border-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))
  );
  --xr-disabled-color: var(
    --jp-layout-color3,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))
  );
  --xr-background-color: var(
    --jp-layout-color0,
    var(--pst-color-on-background, #111111)
  );
  --xr-background-color-row-even: var(
    --jp-layout-color1,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))
  );
  --xr-background-color-row-odd: var(
    --jp-layout-color2,
    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))
  );
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
  line-height: 1.6;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-obj-name,
.xr-group-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-group-name::before {
  content: "ðŸ“";
  padding-right: 0.3em;
}

.xr-group-name,
.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
  margin-block-start: 0;
  margin-block-end: 0;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
  margin: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
  border: 2px solid transparent !important;
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0) !important;
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "â–º";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "â–¼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-top: 4px;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-group-box {
  display: inline-grid;
  grid-template-columns: 0px 20px auto;
  width: 100%;
}

.xr-group-box-vline {
  grid-column-start: 1;
  border-right: 0.2em solid;
  border-color: var(--xr-border-color);
  width: 0px;
}

.xr-group-box-hline {
  grid-column-start: 2;
  grid-row-start: 1;
  height: 1em;
  width: 20px;
  border-bottom: 0.2em solid;
  border-color: var(--xr-border-color);
}

.xr-group-box-contents {
  grid-column-start: 3;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  border-color: var(--xr-background-color-row-odd);
  margin-bottom: 0;
  padding-top: 2px;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
  border-color: var(--xr-background-color-row-even);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  border-top: 2px dotted var(--xr-background-color);
  padding-bottom: 20px !important;
  padding-top: 10px !important;
}

.xr-var-attrs-in + label,
.xr-var-data-in + label,
.xr-index-data-in + label {
  padding: 0 1px;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-data > pre,
.xr-index-data > pre,
.xr-var-data > table > tbody > tr {
  background-color: transparent !important;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}

.xr-var-attrs-in:checked + label > .xr-icon-file-text2,
.xr-var-data-in:checked + label > .xr-icon-database,
.xr-index-data-in:checked + label > .xr-icon-database {
  color: var(--xr-font-color0);
  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));
  stroke-width: 0.8px;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 399kB
Dimensions:                (state: 3, frame: 444, atom: 14, direction: 3,
                            statecomb: 3, full_statecomb: 6, trajid_: 1)
Coordinates: (24)
Data variables: (9)
Attributes: (6)</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-ada1ead3-e28e-4855-b4b4-36610cda7ee0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ada1ead3-e28e-4855-b4b4-36610cda7ee0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>state</span>: 3</li><li><span class='xr-has-index'>frame</span>: 444</li><li><span class='xr-has-index'>atom</span>: 14</li><li><span class='xr-has-index'>direction</span>: 3</li><li><span class='xr-has-index'>statecomb</span>: 3</li><li><span class='xr-has-index'>full_statecomb</span>: 6</li><li><span class='xr-has-index'>trajid_</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-50575662-0d9e-40f5-bc6b-e94c92847c07' class='xr-section-summary-in' type='checkbox'  ><label for='section-50575662-0d9e-40f5-bc6b-e94c92847c07' class='xr-section-summary' >Coordinates: <span>(24)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>state</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 2 3</div><input id='attrs-e7b5b4c3-2aa2-4d16-9da6-02a20b619cef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e7b5b4c3-2aa2-4d16-9da6-02a20b619cef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57b141df-2a1b-45f7-b08b-f9b5d8be0e4e' class='xr-var-data-in' type='checkbox'><label for='data-57b141df-2a1b-45f7-b08b-f9b5d8be0e4e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Index of relevant states for indexing</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([1, 2, 3])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frame</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-9c4f1616-3aa5-4241-ad7e-3205ec90b12e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9c4f1616-3aa5-4241-ad7e-3205ec90b12e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80029ed1-02bb-492f-84b4-0987720e18dd' class='xr-var-data-in' type='checkbox'><label for='data-80029ed1-02bb-492f-84b4-0987720e18dd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[444 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>atom</span></div><div class='xr-var-dims'>(atom)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 7 8 9 10 11 12 13</div><input id='attrs-732ed2fb-b43f-4631-9d1b-738d811e6662' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-732ed2fb-b43f-4631-9d1b-738d811e6662' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aaa48f5a-10d3-4743-87c2-617a12b2dded' class='xr-var-data-in' type='checkbox'><label for='data-aaa48f5a-10d3-4743-87c2-617a12b2dded' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>direction</span></div><div class='xr-var-dims'>(direction)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;x&#x27; &#x27;y&#x27; &#x27;z&#x27;</div><input id='attrs-a08d8203-86cb-441b-a911-2b749dfe52fa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a08d8203-86cb-441b-a911-2b749dfe52fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a885fc6c-9c6c-4cb7-9a3e-dfb332b25a4e' class='xr-var-data-in' type='checkbox'><label for='data-a885fc6c-9c6c-4cb7-9a3e-dfb332b25a4e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>statecomb</span></div><div class='xr-var-dims'>(statecomb)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-df891387-c169-41a4-ab31-7d0c225822f0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-df891387-c169-41a4-ab31-7d0c225822f0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-600795d0-dfdd-4ce7-bd30-9b33909c2545' class='xr-var-data-in' type='checkbox'><label for='data-600795d0-dfdd-4ce7-bd30-9b33909c2545' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[3 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>full_statecomb</span></div><div class='xr-var-dims'>(full_statecomb)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-57d5a13e-5c96-424d-b48e-b52b928258fe' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-57d5a13e-5c96-424d-b48e-b52b928258fe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-151d30ab-3d62-4251-97f9-b61d2c0a5720' class='xr-var-data-in' type='checkbox'><label for='data-151d30ab-3d62-4251-97f9-b61d2c0a5720' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=object]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>trajid_</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>3</div><input id='attrs-cf721f3a-10ca-423b-baf7-8736f9e061ea' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cf721f3a-10ca-423b-baf7-8736f9e061ea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11d361ed-1e5b-4891-b64f-e0b68208515c' class='xr-var-data-in' type='checkbox'><label for='data-11d361ed-1e5b-4891-b64f-e0b68208515c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([3])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>state_names</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>&lt;U2</div><div class='xr-var-preview xr-preview'>&#x27;S0&#x27; &#x27;S1&#x27; &#x27;S2&#x27;</div><input id='attrs-7e0acd48-bd30-4253-bd55-e6688389be54' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7e0acd48-bd30-4253-bd55-e6688389be54' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-083fa2f2-d5e3-4b02-901a-ae5bd6bf5111' class='xr-var-data-in' type='checkbox'><label for='data-083fa2f2-d5e3-4b02-901a-ae5bd6bf5111' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>String representations of the states.</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;S0&#x27;, &#x27;S1&#x27;, &#x27;S2&#x27;], dtype=&#x27;&lt;U2&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>state_types</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>1 1 1</div><input id='attrs-7b75d6c7-a61b-46a5-bb7b-c332c2a61e7c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7b75d6c7-a61b-46a5-bb7b-c332c2a61e7c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b91ebc1e-3648-473b-8bf9-bbaff66322d2' class='xr-var-data-in' type='checkbox'><label for='data-b91ebc1e-3648-473b-8bf9-bbaff66322d2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Multiplicity to indicate whether the respective state is singlet (1), doublet (2), or triplet(3)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([1, 1, 1], dtype=int8)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>state_charges</span></div><div class='xr-var-dims'>(state)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0</div><input id='attrs-25574822-9858-4151-86da-d38ffb363a26' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-25574822-9858-4151-86da-d38ffb363a26' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6b22bc45-ddab-4f81-a84e-263332a1c0ff' class='xr-var-data-in' type='checkbox'><label for='data-6b22bc45-ddab-4f81-a84e-263332a1c0ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Charge of the various states.</dd><dt><span>unitdim :</span></dt><dd>charge</dd><dt><span>units :</span></dt><dd>e</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([0., 0., 0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>atNames</span></div><div class='xr-var-dims'>(atom)</div><div class='xr-var-dtype'>&lt;U1</div><div class='xr-var-preview xr-preview'>&#x27;C&#x27; &#x27;H&#x27; &#x27;H&#x27; &#x27;C&#x27; ... &#x27;H&#x27; &#x27;N&#x27; &#x27;H&#x27; &#x27;H&#x27;</div><input id='attrs-5ffc4e38-c9e1-480a-9694-92faf0a9cfd1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5ffc4e38-c9e1-480a-9694-92faf0a9cfd1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-194c9076-7346-46c6-bfaa-baf3247d6737' class='xr-var-data-in' type='checkbox'><label for='data-194c9076-7346-46c6-bfaa-baf3247d6737' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Names of atomic elements (short form)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;C&#x27;, &#x27;H&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;C&#x27;, &#x27;H&#x27;, &#x27;N&#x27;, &#x27;H&#x27;,
       &#x27;H&#x27;], dtype=&#x27;&lt;U1&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>atNums</span></div><div class='xr-var-dims'>(atom)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>6 1 1 6 1 6 1 6 1 6 1 7 1 1</div><input id='attrs-29b70980-ba53-445d-81bd-ed9ddabe11dd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-29b70980-ba53-445d-81bd-ed9ddabe11dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c127ba44-e0e2-4f1e-9f57-2666a9743907' class='xr-var-data-in' type='checkbox'><label for='data-c127ba44-e0e2-4f1e-9f57-2666a9743907' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Periodic number of atomic elements</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([6, 1, 1, 6, 1, 6, 1, 6, 1, 6, 1, 7, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>from</span></div><div class='xr-var-dims'>(statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 2</div><input id='attrs-f9792e7d-fcaf-4271-9ff6-056555265b67' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f9792e7d-fcaf-4271-9ff6-056555265b67' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3c4de8a-6dd7-433d-b5b4-44a9c2323d6c' class='xr-var-data-in' type='checkbox'><label for='data-e3c4de8a-6dd7-433d-b5b4-44a9c2323d6c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the first state of a statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[3 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>to</span></div><div class='xr-var-dims'>(statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 3 3</div><input id='attrs-61a27110-bf6c-4af7-96dd-a2b28b722d60' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-61a27110-bf6c-4af7-96dd-a2b28b722d60' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb5bc641-a137-4194-bba5-ba94d32901c0' class='xr-var-data-in' type='checkbox'><label for='data-eb5bc641-a137-4194-bba5-ba94d32901c0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the second state of a statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[3 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>full_statecomb_from</span></div><div class='xr-var-dims'>(full_statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 1 2 2 3 3</div><input id='attrs-9e13de14-bdc4-41da-ad91-225404914514' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9e13de14-bdc4-41da-ad91-225404914514' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2c2653c-54c7-4e3f-804c-e0122efe1333' class='xr-var-data-in' type='checkbox'><label for='data-f2c2653c-54c7-4e3f-804c-e0122efe1333' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the first state of a full_statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>full_statecomb_to</span></div><div class='xr-var-dims'>(full_statecomb)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 3 1 3 1 2</div><input id='attrs-8e9be545-a507-40bc-87fd-369e38679b86' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8e9be545-a507-40bc-87fd-369e38679b86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a14759f-0fd8-413a-8694-c942bf76dfea' class='xr-var-data-in' type='checkbox'><label for='data-6a14759f-0fd8-413a-8694-c942bf76dfea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>An alias for the second state of a full_statecomb combination</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[6 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>trajid</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>3 3 3 3 3 3 3 3 ... 3 3 3 3 3 3 3 3</div><input id='attrs-2acff216-e09a-438f-a66b-0e9e5eee3ecd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2acff216-e09a-438f-a66b-0e9e5eee3ecd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f4007d79-05a9-42de-a1a0-c0fc9a1c1642' class='xr-var-data-in' type='checkbox'><label for='data-f4007d79-05a9-42de-a1a0-c0fc9a1c1642' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[444 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.5 1.0 ... 220.5 221.0 221.5</div><input id='attrs-26dfeb88-5548-47ab-b6ea-9097b38fa9dd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-26dfeb88-5548-47ab-b6ea-9097b38fa9dd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c0c62db-4001-42f7-b83f-a92207ef108b' class='xr-var-data-in' type='checkbox'><label for='data-5c0c62db-4001-42f7-b83f-a92207ef108b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Time in trajectory or timestep</dd><dt><span>unitdim :</span></dt><dd>time</dd><dt><span>units :</span></dt><dd>fs</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>[444 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>input_format</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>&lt;U5</div><div class='xr-var-preview xr-preview'>&#x27;sharc&#x27;</div><input id='attrs-1a97a866-ab36-4568-ab25-99d707284288' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1a97a866-ab36-4568-ab25-99d707284288' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6aea7222-68e4-4806-81de-fe53e943d7f7' class='xr-var-data-in' type='checkbox'><label for='data-6aea7222-68e4-4806-81de-fe53e943d7f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;sharc&#x27;], dtype=&#x27;&lt;U5&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t_max</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1e+03</div><input id='attrs-75dffa89-3645-4afc-8a96-fc2c5115f6aa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-75dffa89-3645-4afc-8a96-fc2c5115f6aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a1dae7b-f70e-4e84-887c-e6a6ccf5ba7f' class='xr-var-data-in' type='checkbox'><label for='data-1a1dae7b-f70e-4e84-887c-e6a6ccf5ba7f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1000.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>max_ts</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>444</div><input id='attrs-1f323ba6-eec9-49c8-a211-7761ea2a74f7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1f323ba6-eec9-49c8-a211-7761ea2a74f7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f4470d9a-54cc-4b2a-8fe4-c4e746052f23' class='xr-var-data-in' type='checkbox'><label for='data-f4470d9a-54cc-4b2a-8fe4-c4e746052f23' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([444])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>completed</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>False</div><input id='attrs-c8721642-17c3-4428-8d70-d8f32dde8801' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c8721642-17c3-4428-8d70-d8f32dde8801' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ec2b847-5675-4587-b309-fdf521e3502d' class='xr-var-data-in' type='checkbox'><label for='data-9ec2b847-5675-4587-b309-fdf521e3502d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([False])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>has_forces</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>True</div><input id='attrs-f15bd53a-f1c2-4574-848a-fb354487ebaf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f15bd53a-f1c2-4574-848a-fb354487ebaf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-938f5451-7602-442e-ae33-c8908d922994' class='xr-var-data-in' type='checkbox'><label for='data-938f5451-7602-442e-ae33-c8908d922994' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ True])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>trajectory_input_path</span></div><div class='xr-var-dims'>(trajid_)</div><div class='xr-var-dtype'>&lt;U31</div><div class='xr-var-preview xr-preview'>&#x27;retinal_tutorial/I02/TRAJ_00003&#x27;</div><input id='attrs-9b26f923-e449-493a-9b39-62c52d00c223' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9b26f923-e449-493a-9b39-62c52d00c223' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-84b86a23-5be2-422a-a8b1-44d5856bc093' class='xr-var-data-in' type='checkbox'><label for='data-84b86a23-5be2-422a-a8b1-44d5856bc093' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;retinal_tutorial/I02/TRAJ_00003&#x27;], dtype=&#x27;&lt;U31&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-43e7aa9d-8d4c-4806-8071-2d4c03207a5f' class='xr-section-summary-in' type='checkbox'  ><label for='section-43e7aa9d-8d4c-4806-8071-2d4c03207a5f' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>energy</span></div><div class='xr-var-dims'>(state, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-248.2 -248.2 ... -247.9 -247.9</div><input id='attrs-4624c9e5-bbb2-4945-be62-f3cf0b2f4b65' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4624c9e5-bbb2-4945-be62-f3cf0b2f4b65' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-48c58dad-79bd-4ae5-8620-70215356de5d' class='xr-var-data-in' type='checkbox'><label for='data-48c58dad-79bd-4ae5-8620-70215356de5d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Absolute energy</dd><dt><span>unitdim :</span></dt><dd>energy</dd><dt><span>units :</span></dt><dd>Hartree</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[-248.21573, -248.21896, -248.2248 , ..., -248.14104, -248.14253,
        -248.14203],
       [-248.0337 , -248.0376 , -248.04446, ..., -247.97777, -247.97926,
        -247.97981],
       [-248.02414, -248.02603, -248.03091, ..., -247.92831, -247.93785,
        -247.9468 ]], shape=(3, 444), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>forces</span></div><div class='xr-var-dims'>(state, atom, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.03727 0.03115 ... -0.00777</div><input id='attrs-2ca51a3e-63b0-45d5-a880-39b635d478a2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2ca51a3e-63b0-45d5-a880-39b635d478a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d67aa5a-257b-4db5-9936-9c76b6aa7e11' class='xr-var-data-in' type='checkbox'><label for='data-0d67aa5a-257b-4db5-9936-9c76b6aa7e11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Per-atom forces</dd><dt><span>unitdim :</span></dt><dd>force</dd><dt><span>units :</span></dt><dd>Hartree/Bohr</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 3.72700579e-02,  3.11490018e-02,  2.14518309e-02, ...,
           6.06883615e-02,  4.86394279e-02,  3.48243937e-02],
         [ 8.59054178e-03,  1.61939953e-02,  2.08876990e-02, ...,
           3.95462029e-02,  2.69095059e-02,  1.49424793e-02],
         [-2.33383942e-03,  2.75017926e-04,  2.97357771e-03, ...,
          -9.62506682e-02, -6.23331591e-02, -3.06240283e-02]],

        [[ 1.25153186e-02,  1.43127143e-02,  1.50604825e-02, ...,
           9.00325365e-03,  8.50841496e-03,  7.70979421e-03],
         [-5.54382838e-02, -6.04311600e-02, -6.22176863e-02, ...,
           4.23862971e-02,  4.04113159e-02,  3.74523140e-02],
         [-1.52837122e-02, -1.64303519e-02, -1.70830227e-02, ...,
          -5.20482194e-03, -1.16887074e-02, -1.84246674e-02]],

        [[-5.57925403e-02, -4.82564345e-02, -3.64445373e-02, ...,
          -6.29730076e-02, -5.88328205e-02, -5.04705533e-02],
         [ 1.54960379e-02,  1.37948561e-02,  1.17091723e-02, ...,
          -5.33952191e-02, -4.73683551e-02, -3.83120626e-02],
         [ 1.37176095e-02,  1.27981063e-02,  1.12447953e-02, ...,
           2.67490000e-02,  2.19117925e-02,  1.61614977e-02]],
...
          -5.60051389e-02, -3.40533741e-02, -9.39058233e-03],
         [-9.99073312e-02, -7.78241530e-02, -5.51840328e-02, ...,
          -3.59106548e-02, -3.48627754e-02, -3.18505540e-02],
         [-4.15713247e-03, -3.93558620e-03, -3.63043346e-03, ...,
           5.45979179e-02,  7.23206326e-02,  8.55918378e-02]],

        [[ 2.62986459e-02,  2.64402535e-02,  2.52706930e-02, ...,
           3.12164389e-02,  2.40049791e-02,  1.65761672e-02],
         [-2.32406203e-02, -3.49661484e-02, -4.26097326e-02, ...,
           1.47973876e-02,  2.22202502e-02,  2.90257968e-02],
         [ 3.81672289e-03,  5.69832092e-03,  6.91911438e-03, ...,
           9.43200383e-03, -6.60775835e-03, -2.19350886e-02]],

        [[-3.43500078e-02, -4.34854738e-02, -4.79140058e-02, ...,
           2.93402541e-02,  1.84422433e-02,  5.27177658e-03],
         [ 8.00394919e-03,  6.49118517e-03,  4.26632492e-03, ...,
           1.15473066e-02,  1.96331344e-03, -9.46609490e-03],
         [-4.62220237e-03, -5.96969156e-03, -6.47362182e-03, ...,
          -2.28664223e-02, -1.62044764e-02, -7.76953669e-03]]]],
      shape=(3, 14, 3, 444), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>atXYZ</span></div><div class='xr-var-dims'>(atom, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-4.284 -4.286 ... 0.423 0.434</div><input id='attrs-524c6e63-d866-4ecc-924c-b519313b7138' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-524c6e63-d866-4ecc-924c-b519313b7138' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ab3d35ce-ea38-41aa-abc4-a16693dcf1a2' class='xr-var-data-in' type='checkbox'><label for='data-ab3d35ce-ea38-41aa-abc4-a16693dcf1a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Positions</dd><dt><span>unitdim :</span></dt><dd>length</dd><dt><span>units :</span></dt><dd>Bohr</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[-4.2841487 , -4.2859535 , -4.2887945 , ..., -3.4824593 ,
         -3.4788332 , -3.4761572 ],
        [-0.13960198, -0.14068389, -0.1425612 , ...,  0.02210672,
          0.01933544,  0.01603853],
        [-0.05390457, -0.04946472, -0.0449808 , ...,  1.1307735 ,
          1.139177  ,  1.148798  ]],

       [[-3.5554488 , -3.535947  , -3.5197334 , ..., -2.7167342 ,
         -2.6774077 , -2.6400602 ],
        [-2.2273717 , -2.2450027 , -2.2483425 , ...,  1.2101965 ,
          1.2146697 ,  1.2097443 ],
        [-0.35741895, -0.3691519 , -0.37769863, ...,  2.706642  ,
          2.667826  ,  2.6317284 ]],

       [[-6.4853263 , -6.456533  , -6.4165025 , ..., -5.305297  ,
         -5.2917333 , -5.264487  ],
        [ 0.1457245 ,  0.11695185,  0.08495308, ..., -1.4214896 ,
         -1.3655951 , -1.298684  ],
        [ 0.24708965,  0.24956653,  0.24953619, ...,  1.6170421 ,
          1.5832615 ,  1.5443847 ]],
...
       [[ 5.1764154 ,  5.182015  ,  5.1890345 , ...,  4.85219   ,
          4.8622546 ,  4.872235  ],
        [ 6.304517  ,  6.3117714 ,  6.320982  , ...,  6.1350074 ,
          6.125765  ,  6.116985  ],
        [ 0.37849072,  0.38098606,  0.38364995, ...,  1.3356056 ,
          1.3254176 ,  1.3134257 ]],

       [[ 4.755326  ,  4.730316  ,  4.6999416 , ...,  5.6921725 ,
          5.6874924 ,  5.6775947 ],
        [ 8.074831  ,  8.050502  ,  8.032935  , ...,  5.5275254 ,
          5.557882  ,  5.58181   ],
        [ 0.04646442,  0.0327675 ,  0.01741774, ...,  2.9718013 ,
          2.9413135 ,  2.9123437 ]],

       [[ 6.9864993 ,  6.974676  ,  6.9716115 , ...,  6.2467036 ,
          6.2044635 ,  6.1573534 ],
        [ 6.159329  ,  6.1500263 ,  6.139491  , ...,  7.2276163 ,
          7.2299457 ,  7.233013  ],
        [ 0.67482686,  0.68008584,  0.68655986, ...,  0.41591874,
          0.4230259 ,  0.43402135]]], shape=(14, 3, 444), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dip_perm</span></div><div class='xr-var-dims'>(state, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>7.393 7.298 7.196 ... 0.8102 0.836</div><input id='attrs-e715d08d-9ea9-4e27-bfb9-fe235d2dd7fd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e715d08d-9ea9-4e27-bfb9-fe235d2dd7fd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c12edcaf-2b45-4d71-a046-f2640fac45b6' class='xr-var-data-in' type='checkbox'><label for='data-c12edcaf-2b45-4d71-a046-f2640fac45b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Permanent dipoles</dd><dt><span>unitdim :</span></dt><dd>dipole</dd><dt><span>units :</span></dt><dd>debye</dd><dt><span>original_units :</span></dt><dd>au</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[ 7.3931975 ,  7.2984176 ,  7.1955643 , ...,  6.4000735 ,
          6.356218  ,  6.282789  ],
        [11.2150955 , 11.120545  , 11.020755  , ..., 12.514793  ,
         12.510117  , 12.486558  ],
        [ 0.19352683,  0.16147913,  0.13363223, ...,  0.7810982 ,
          0.7499949 ,  0.7237713 ]],

       [[ 0.5905544 ,  0.52093446,  0.43100047, ..., -0.01370756,
          0.04769229,  0.06246604],
        [ 8.114364  ,  8.0626955 ,  7.9901733 , ...,  6.3983855 ,
          6.544882  ,  6.666292  ],
        [ 0.15533711,  0.13349867,  0.11077021, ...,  0.56505483,
          0.5679906 ,  0.58637744]],

       [[ 6.4831724 ,  6.3347683 ,  6.1980743 , ...,  4.8672028 ,
          5.852159  ,  6.435859  ],
        [11.580374  , 11.478747  , 11.399642  , ..., 10.390903  ,
         11.239351  , 11.786199  ],
        [ 0.33142233,  0.30909818,  0.29443085, ...,  0.72217965,
          0.810238  ,  0.83596647]]], shape=(3, 3, 444), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dip_trans</span></div><div class='xr-var-dims'>(statecomb, direction, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-6.172 -6.18 ... 0.1399 0.1372</div><input id='attrs-f0492d6c-30a6-41d8-98b9-c300eef694dc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f0492d6c-30a6-41d8-98b9-c300eef694dc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27ff9c32-0eff-434b-9e77-069926f66d6d' class='xr-var-data-in' type='checkbox'><label for='data-27ff9c32-0eff-434b-9e77-069926f66d6d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Transitional dipoles</dd><dt><span>unitdim :</span></dt><dd>dipole</dd><dt><span>units :</span></dt><dd>debye</dd><dt><span>original_units :</span></dt><dd>au</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[[-6.17199   , -6.180399  , -6.205762  , ..., -5.0328193 ,
         -5.1140666 , -5.2010865 ],
        [-3.8617733 , -3.8633723 , -3.8808086 , ..., -3.8175092 ,
         -3.831415  , -3.8568296 ],
        [-0.27895197, -0.2769847 , -0.27761206, ..., -0.4346968 ,
         -0.41953856, -0.4000026 ]],

       [[-1.7135087 , -1.7667863 , -1.7849718 , ..., -2.3026333 ,
         -2.1873276 , -2.0755913 ],
        [-1.8553084 , -1.8883618 , -1.9039514 , ..., -0.9556555 ,
         -0.901972  , -0.8612553 ],
        [-0.28345948, -0.28884253, -0.29318398, ..., -0.61711425,
         -0.43198594, -0.27656445]],

       [[-1.3697146 , -1.3241937 , -1.2403268 , ...,  0.28162488,
         -0.46909288, -0.9699423 ],
        [-1.5848901 , -1.5513757 , -1.497275  , ...,  0.80093825,
          0.19159512, -0.22906008],
        [-0.23074517, -0.22708693, -0.2219046 , ...,  0.15905884,
          0.13991539,  0.13724816]]], shape=(3, 3, 444), dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>socs</span></div><div class='xr-var-dims'>(full_statecomb, frame)</div><div class='xr-var-dtype'>complex128</div><div class='xr-var-preview xr-preview'>0j 0j 0j 0j 0j ... 0j 0j 0j 0j 0j</div><input id='attrs-02039439-3315-4b70-817e-ff9da457370e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-02039439-3315-4b70-817e-ff9da457370e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aca52371-5c31-483d-a8d3-7fb8608e6df0' class='xr-var-data-in' type='checkbox'><label for='data-aca52371-5c31-483d-a8d3-7fb8608e6df0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Spin-orbit couplings</dd><dt><span>unitdim :</span></dt><dd>socs</dd><dt><span>units :</span></dt><dd>1/cm</dd><dt><span>original_units :</span></dt><dd>Hartree</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j],
       [0.+0.j, 0.+0.j, 0.+0.j, ..., 0.+0.j, 0.+0.j, 0.+0.j]],
      shape=(6, 444))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>astate</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>2 2 2 2 2 2 2 2 ... 1 1 1 1 1 1 1 1</div><input id='attrs-4a525b6a-a65c-4ed2-beaa-e5440b1be645' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4a525b6a-a65c-4ed2-beaa-e5440b1be645' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4b4dc258-31c9-4588-b4ea-a908921837aa' class='xr-var-data-in' type='checkbox'><label for='data-4b4dc258-31c9-4588-b4ea-a908921837aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Active state in dynamic trajectories (MCH)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sdiag</span></div><div class='xr-var-dims'>(frame)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>2 2 2 2 2 2 2 2 ... 1 1 1 1 1 1 1 1</div><input id='attrs-8564499b-34da-4bde-8cad-d963d069aab5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8564499b-34da-4bde-8cad-d963d069aab5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae2d9f09-2f40-401e-8bee-7969961a0391' class='xr-var-data-in' type='checkbox'><label for='data-ae2d9f09-2f40-401e-8bee-7969961a0391' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Active state (diag)</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1], dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>phases</span></div><div class='xr-var-dims'>(state, frame)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-1.0 1.0 1.0 1.0 ... 1.0 1.0 1.0</div><input id='attrs-52b2b2c2-505f-4a69-b417-8cb7fad6ea35' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-52b2b2c2-505f-4a69-b417-8cb7fad6ea35' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5feab3e0-4deb-41ca-8f6c-f814061d9511' class='xr-var-data-in' type='checkbox'><label for='data-5feab3e0-4deb-41ca-8f6c-f814061d9511' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Phase vector</dd><dt><span>__assigned :</span></dt><dd>True</dd></dl></div><div class='xr-var-data'><pre>array([[-1.,  1.,  1., ...,  1.,  1.,  1.],
       [-1.,  1.,  1., ...,  1.,  1.,  1.],
       [-1.,  1.,  1., ...,  1.,  1.,  1.]], shape=(3, 444), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b6861344-c9a5-44c7-b169-c4419e8d0c9f' class='xr-section-summary-in' type='checkbox'  ><label for='section-b6861344-c9a5-44c7-b169-c4419e8d0c9f' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>input_format_version :</span></dt><dd>3.0</dd><dt><span>delta_t :</span></dt><dd>0.5</dd><dt><span>num_triplets :</span></dt><dd>0</dd><dt><span>input_type :</span></dt><dd>dynamic</dd><dt><span>num_singlets :</span></dt><dd>3</dd><dt><span>num_doublets :</span></dt><dd>0</dd></dl></div></li></ul></div></div></div>
</div>
</section>
<section id="3.2)-View-geometries-for-selected-trajectories">
<h2>3.2) View geometries for selected trajectories<a class="headerlink" href="#3.2)-View-geometries-for-selected-trajectories" title="Link to this heading">#</a></h2>
<section id="3.2.1)-Using-py3Dmol">
<h3>3.2.1) Using py3Dmol<a class="headerlink" href="#3.2.1)-Using-py3Dmol" title="Link to this heading">#</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span><span class="o">.</span><span class="n">atXYZ</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">trajs3Dgrid</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
INFO:tornado.access:200 GET /autoload.js?bokeh-autoload-element=fbd57c64-08fe-4269-8743-da121a173ab4&amp;bokeh-absolute-url=http://localhost:45131&amp;resources=none (::1) 34.05ms
INFO:tornado.access:101 GET /ws?id=7c11834a-bba9-4580-b7ce-1f1305a8a8a3&amp;origin=fde0f466-d350-4c7f-995b-8eef6d0b38d6&amp;swVersion=4&amp;extensionId=&amp;platform=electron&amp;vscode-resource-base-authority=vscode-resource.vscode-cdn.net&amp;parentOrigin=vscode-file%3A%2F%2Fvscode-app&amp;purpose=notebookRenderer (::1) 0.33ms
INFO:tornado.access:200 GET /autoload.js?bokeh-autoload-element=d8f15268-5a43-4bfc-aa07-b861f3744ba8&amp;bokeh-absolute-url=http://localhost:44865&amp;resources=none (::1) 24.98ms
INFO:tornado.access:101 GET /ws?id=7c11834a-bba9-4580-b7ce-1f1305a8a8a3&amp;origin=fde0f466-d350-4c7f-995b-8eef6d0b38d6&amp;swVersion=4&amp;extensionId=&amp;platform=electron&amp;vscode-resource-base-authority=vscode-resource.vscode-cdn.net&amp;parentOrigin=vscode-file%3A%2F%2Fvscode-app&amp;purpose=notebookRenderer (::1) 0.33ms
</pre></div></div>
</div>
</section>
<section id="3.2.2)-Using-VMD">
<h3>3.2.2) Using VMD<a class="headerlink" href="#3.2.2)-Using-VMD" title="Link to this heading">#</a></h3>
<p>If you have the popular visualization program VMD installed, it is possible to open trajectories in it. Initially, conformations from different trajectories will be overlapped. Using the small extension window titled â€˜spreadâ€™, it is possible to move them apart. The ideal â€˜Separationâ€™ will depend on the desired zoom level and window size, but 1.5 is probably a reasonable value to start with.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">subset</span><span class="o">.</span><span class="n">atXYZ</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">traj_vmd</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="3.3)-PCA-of-a-single-trajectory">
<h2>3.3) PCA of a single trajectory<a class="headerlink" href="#3.3)-PCA-of-a-single-trajectory" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">shnitsel.vis.plot</span><span class="w"> </span><span class="kn">import</span> <span class="n">polychrom</span>
<span class="n">polychrom</span><span class="o">.</span><span class="n">pca_line_plot</span><span class="p">(</span>
    <span class="n">pca</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">sel_trajs</span><span class="p">(</span><span class="n">selector</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">trajid</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="n">hue</span><span class="o">=</span><span class="n">pca</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">sel_trajs</span><span class="p">(</span><span class="n">selector</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">trajid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
    <span class="n">shadow</span><span class="o">=</span><span class="n">frames</span><span class="o">.</span><span class="n">st</span><span class="o">.</span><span class="n">sel_trajs</span><span class="p">(</span><span class="n">selector</span><span class="o">.</span><span class="n">selection</span><span class="o">.</span><span class="n">trajid</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">astate</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(&lt;Figure size 640x480 with 2 Axes&gt;,
 &lt;Axes: xlabel=&#39;First principal component&#39;, ylabel=&#39;Second principal component&#39;&gt;,
 &lt;matplotlib.legend.Legend at 0x7f3a6af30410&gt;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_build/.doctrees/nbsphinx/tutorials__wip_2_6a_vis_overview_29_1.png" src="../_build/.doctrees/nbsphinx/tutorials__wip_2_6a_vis_overview_29_1.png" />
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">1) Loading data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#2)-Derive-representation-for-selection">2) Derive representation for selection</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#3)-Frame-level-selection">3) Frame-level selection</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3.1)-Select-frames-from-PCA">3.1) Select frames from PCA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3.2)-View-geometries-for-selected-frames">3.2) View geometries for selected frames</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#4)-Trajectory-level-selection">4) Trajectory-level selection</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#4.1)-Select-trajectories-from-PCA">4.1) Select trajectories from PCA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3.2)-View-geometries-for-selected-trajectories">3.2) View geometries for selected trajectories</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#3.2.1)-Using-py3Dmol">3.2.1) Using py3Dmol</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#3.2.2)-Using-VMD">3.2.2) Using VMD</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#3.3)-PCA-of-a-single-trajectory">3.3) PCA of a single trajectory</a></li>
</ul>
</li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/tutorials/_wip/2_6a_vis_overview.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      Â© Copyright 2025, Theodor Everley RÃ¶hrkasten, Carolin MÃ¼ller.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>